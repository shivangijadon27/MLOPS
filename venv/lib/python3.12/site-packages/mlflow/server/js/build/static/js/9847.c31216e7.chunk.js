"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[3664,9847],{5857:function(e,t,n){n.d(t,{O:function(){return o},n:function(){return i}});var r=n(46709),a=n(91105);const o="selectedDatasetId",i=()=>{var e;const[t,n]=(0,a.ok)();return[null!==(e=t.get(o))&&void 0!==e?e:void 0,(0,r.useCallback)(e=>{n(t=>e?(t.set(o,e),t):(t.delete(o),t),{replace:!0})},[n]),(0,r.useCallback)(()=>{n(e=>(e.delete(o),e),{replace:!0})},[n])]}},29774:function(e,t,n){n.d(t,{Au:function(){return s},tF:function(){return l}});var r=n(46709),a=n(36476),o=n(73408);const i=(0,r.createContext)({currentUserActionError:null,handleError:()=>{},handlePromise:()=>{},clearUserActionError:()=>{}}),s=({children:e,errorFilter:t})=>{const[n,s]=(0,r.useState)(null),l=(0,r.useCallback)((e,n)=>{if(null===t||void 0===t||!t(e)){const t=(0,a.a$)(e);s(t),n&&n(t)}},[s,t]),d=(0,r.useCallback)(e=>{e.catch(e=>{l(e)})},[l]),c=(0,r.useCallback)(()=>{s(null)},[s]);return(0,o.Y)(i.Provider,{value:(0,r.useMemo)(()=>({currentUserActionError:n,handleError:l,handlePromise:d,clearUserActionError:c}),[c,n,l,d]),children:e})},l=()=>{const{currentUserActionError:e,handleError:t,handlePromise:n,clearUserActionError:a}=(0,r.useContext)(i),o=(0,r.useCallback)((e,n,r)=>{t(n,r)},[t]);return(0,r.useMemo)(()=>({currentUserActionError:e,handleError:t,handleErrorWithEvent:o,handlePromise:n,clearUserActionError:a}),[a,t,n,e,o])}},29847:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ye}});var r=n(68248),a=n(27757),o=n(25637),i=n(42595),s=n(46709),l=n(91105),d=n(59930),c=n.n(d),u=n(82716),m=n(66916),h=n(42747),p=n(43617),g=n(90061),f=n(76256),v=n(73408);var x={name:"y1ecum",styles:"text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex-shrink:1"};var w=n(79081),b=n(11522);var y=n(40724),C=n(34599),S=n(61077),Y=n(39595),D=n(61060);var M={name:"1hcx8jb",styles:"padding:0"},I={name:"1r962iv",styles:"padding:4px"};var E=n(12998);var R={name:"1tzoh5y",styles:"width:fit-content;max-width:100%;cursor:pointer"},k={name:"hdknak",styles:"display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap"};var T=n(76118),F=n(52849),z=n(32874);const A="dataset_id",_="name",L="last_update_time",H="actions",P=[A,_,L,H],N=[H],B=[{id:A,accessorKey:"dataset_id",header:"Dataset ID",enableSorting:!1,cell:({row:e})=>{const t=e.original.dataset_id,{copy:n,tooltipOpen:r,tooltipMessage:a,handleTooltipOpenChange:o}=(0,E.Ld)(t,"Click to copy");return(0,v.Y)(w.T,{content:a,open:r,onOpenChange:o,componentId:"mlflow.eval-datasets.dataset-id-tooltip",children:(0,v.Y)(u.Tag,{css:R,componentId:"mlflow.eval-datasets.dataset-id",color:"indigo",onClick:n,children:(0,v.Y)("span",{css:k,children:t})})})}},{id:_,accessorKey:"name",header:"Name",enableSorting:!0,cell:({row:e})=>{const{theme:t}=(0,a.u)();return(0,v.Y)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:t.spacing.xs},""),children:(0,v.Y)(a.T.Link,{css:x,componentId:"mlflow.eval-datasets.dataset-name-cell",children:e.original.name})})}},{id:L,accessorKey:"last_update_time",accessorFn:e=>e.last_update_time?new Date(e.last_update_time).getTime():0,header:"Updated At",enableSorting:!0,size:150,maxSize:150,cell:({row:e})=>e.original.last_update_time?(0,v.Y)(w.T,{content:new Date(e.original.last_update_time).toLocaleString(),componentId:"mlflow.eval-datasets.last-updated-cell-tooltip",children:(0,v.Y)("span",{children:b.A.timeSinceStr(e.original.last_update_time)})}):(0,v.Y)("span",{children:"-"})},{id:"created_time",accessorKey:"created_time",accessorFn:e=>e.created_time?new Date(e.created_time).getTime():0,header:"Created At",enableSorting:!0,cell:({row:e})=>new Date(e.original.created_time).toLocaleString()},{id:"created_by",accessorKey:"created_by",header:"Created By",enableSorting:!0},{id:"source_type",accessorKey:"source_type",header:"Source Type",enableSorting:!0},{id:"actions",header:"",enableSorting:!1,size:36,maxSize:36,cell:({row:e})=>{const t=(0,Y.jE)(),{deleteEvaluationDatasetMutation:n,isLoading:r}=(({onSuccess:e,onError:t})=>{const n=(0,Y.jE)(),{mutate:r,isLoading:a}=(0,D.n)({mutationFn:async({datasetId:e})=>{await(0,S.ff)((0,S.we)(`ajax-api/3.0/mlflow/datasets/${e}`),{method:"DELETE"})},onSuccess:()=>{n.invalidateQueries({queryKey:[C.P4]}),null===e||void 0===e||e()},onError:e=>{null===t||void 0===t||t(e)}});return{deleteEvaluationDatasetMutation:r,isLoading:a}})({onSuccess:()=>{t.invalidateQueries({queryKey:[C.P4]})}}),o=(0,s.useCallback)(()=>{n({datasetId:e.original.dataset_id})},[n,e]);return(0,v.Y)(u.TableRowAction,{css:M,children:(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(a.B,{componentId:"mlflow.eval-datasets.dataset-actions-menu",size:"small",icon:(0,v.Y)(u.OverflowIcon,{}),"aria-label":"Dataset actions",css:I})}),(0,v.Y)(u.DropdownMenu.Content,{align:"end",children:(0,v.FD)(u.DropdownMenu.Item,{componentId:"mlflow.eval-datasets.delete-dataset-menu-option",disabled:r,onClick:e=>{e.stopPropagation(),e.preventDefault(),o()},children:[(0,v.Y)(u.DropdownMenu.IconWrapper,{children:(0,v.Y)(u.TrashIcon,{})}),(0,v.Y)(y.A,{id:"cMRvTA",defaultMessage:"Delete dataset"}),r&&(0,v.Y)(u.DropdownMenu.HintColumn,{children:(0,v.Y)(a.S,{})})]})})]})})}}],O=s.memo(({row:e,isActive:t,onSelectDataset:n})=>{const{theme:o}=(0,a.u)();return(0,v.Y)(u.TableRow,{className:"eval-datasets-table-row",onClick:()=>n(e.original),children:e.getVisibleCells().map(e=>(0,v.Y)(u.TableCell,{css:(0,r.AH)({backgroundColor:t?o.colors.actionDefaultBackgroundHover:"transparent",width:e.column.columnDef.size?`${e.column.columnDef.size}px`:"auto",maxWidth:e.column.columnDef.maxSize?`${e.column.columnDef.maxSize}px`:"auto",minWidth:e.column.columnDef.minSize?`${e.column.columnDef.minSize}px`:"auto",..."actions"===e.column.id&&{paddingLeft:0,paddingRight:0}},""),children:(0,p.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)},(e,t)=>e.isActive===t.isActive&&(0,T.isEqual)(e.columnVisibility,t.columnVisibility));var K={name:"10jtkcq",styles:"display:flex;flex-direction:column;width:100%;height:100%"},j={name:"82a6rk",styles:"flex:1"},U={name:"1jrb16",styles:"flex:1;min-height:0;position:relative"},$={name:"13udsys",styles:"height:100%"};const V=({experimentId:e,datasets:t,isLoading:n,isFetching:o,error:i,refetch:l,fetchNextPage:d,hasNextPage:c,selectedDatasetId:x,setSelectedDatasetId:w,searchFilter:b,setSearchFilter:y})=>{const C=(0,h.tz)(),{theme:S}=(0,a.u)(),[Y,D]=(0,s.useState)([{id:"created_time",desc:!0}]),[M,I]=(0,s.useState)(B.reduce((e,t)=>{var n,r;return e[null!==(n=t.id)&&void 0!==n?n:""]=P.includes(null!==(r=t.id)&&void 0!==r?r:""),e},{})),[E,R]=(0,s.useState)(b),k=(0,f.L)("mlflow/server/js/src/experiment-tracking/pages/experiment-evaluation-datasets/components/ExperimentEvaluationDatasetsListTable.tsx",{columns:B,data:null!==t&&void 0!==t?t:[],getCoreRowModel:(0,g.HT)(),getRowId:e=>e.dataset_id,enableSorting:!0,onSortingChange:D,getSortedRowModel:(0,g.h5)(),enableColumnResizing:!1,state:{sorting:Y,columnVisibility:M}}),T=(0,F.v)({isFetching:o,hasNextPage:null!==c&&void 0!==c&&c,fetchNextPage:d});return i?(0,v.Y)("div",{children:"Error loading datasets"}):(0,v.FD)("div",{css:K,children:[(0,v.FD)("div",{css:(0,r.AH)({display:"flex",gap:S.spacing.sm,alignItems:"center",marginBottom:S.spacing.sm},""),children:[(0,v.Y)(m.I,{allowClear:!0,placeholder:"Search by dataset name",value:E,onChange:e=>{R(e.target.value),e.target.value||y(e.target.value)},onClear:()=>{R(""),y("")},onPressEnter:()=>y(E),componentId:"mlflow.eval-datasets.search-input",css:j,prefix:(0,v.Y)(m.S,{})}),(0,v.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",marginRight:S.spacing.sm},""),children:[(0,v.Y)(a.B,{icon:(0,v.Y)(u.RefreshIcon,{}),disabled:o,onClick:()=>l(),componentId:"mlflow.eval-datasets.table-refresh-button"}),(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(a.B,{icon:(0,v.Y)(u.ColumnsIcon,{}),componentId:"mlflow.eval-datasets.table-column-selector-button"})}),(0,v.Y)(u.DropdownMenu.Content,{children:B.map(e=>{var t,n,r,o;return!N.includes(null!==(t=e.id)&&void 0!==t?t:"")&&(0,v.FD)(u.DropdownMenu.CheckboxItem,{componentId:"mlflow.eval-datasets.table-column-selector-checkbox",checked:null!==(r=M[null!==(o=e.id)&&void 0!==o?o:""])&&void 0!==r&&r,onCheckedChange:t=>{var n;return I({...M,[null!==(n=e.id)&&void 0!==n?n:""]:t})},children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(a.T.Text,{children:e.header})]},null!==(n=e.id)&&void 0!==n?n:"")})})]})]})]}),(0,v.Y)(z.Z,{experimentId:e}),(0,v.Y)("div",{css:U,children:(0,v.FD)(u.Table,{css:$,empty:n||o||0!==t.length?void 0:(0,v.Y)(u.Empty,{description:C.formatMessage({id:"F4K195",defaultMessage:"No evaluation datasets found"})}),onScroll:e=>T(e.currentTarget),scrollable:!0,children:[(0,v.Y)(u.TableRow,{isHeader:!0,children:k.getLeafHeaders().map(e=>(0,v.Y)(u.TableHeader,{sortable:e.column.getCanSort(),sortDirection:e.column.getIsSorted(),onToggleSort:e.column.getToggleSortingHandler(),componentId:"mlflow.eval-datasets.column-header",header:e,column:e.column,css:(0,r.AH)({width:e.column.columnDef.size?`${e.column.columnDef.size}px`:"auto",maxWidth:e.column.columnDef.maxSize?`${e.column.columnDef.maxSize}px`:"auto",minWidth:e.column.columnDef.minSize?`${e.column.columnDef.minSize}px`:"auto",cursor:e.column.getCanSort()?"pointer":"default"},""),children:(0,p.Kv)(e.column.columnDef.header,e.getContext())},e.id))}),!n&&k.getRowModel().rows.map(e=>(0,v.Y)(O,{row:e,columnVisibility:M,isActive:e.original.dataset_id===x,onSelectDataset:e=>w(e.dataset_id)},e.id)),(n||o)&&(0,v.Y)(u.TableSkeletonRows,{table:k})]})})]})};var q=n(96584),W=n(181);var J=n(7655);const Q=({text:e,searchFilter:t,theme:n})=>{const a=(0,s.useMemo)(()=>{if(!t.trim())return[e];const a=new RegExp(`(${(0,T.escapeRegExp)(t)})`,"gi"),o=e.split(a),i=n.isDarkMode?n.colors.blue800:n.colors.blue100;return o.map((e,n)=>e.toLowerCase()===t.toLowerCase()?(0,v.Y)("span",{css:(0,r.AH)({backgroundColor:i},""),children:e},n):e)},[e,t,n]);return(0,v.Y)(v.FK,{children:a})},G=({cell:e,table:{options:t}})=>{var n,o;const{theme:i}=(0,a.u)(),l=e.getValue(),d=void 0!==l?JSON.stringify(l,null,2):"",c=null===t||void 0===t||null===(n=t.meta)||void 0===n?void 0:n.rowSize,u=(null===t||void 0===t||null===(o=t.meta)||void 0===o?void 0:o.searchFilter)||"",m=(0,s.useMemo)(()=>d?d.split("\n").length:1,[d]);(0,s.useMemo)(()=>Math.min(Math.max(m+1,3),20),[m]);return(0,v.Y)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:i.spacing.xs,flex:1},""),children:"sm"===c?(0,v.Y)("code",{css:(0,r.AH)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:`${i.typography.fontSizeSm}px !important`,margin:"0 !important"},""),children:d}):(0,v.Y)("div",{css:(0,r.AH)({overflow:"auto",fontFamily:"monospace",whiteSpace:"pre-wrap",wordBreak:"break-word",resize:"vertical",width:"100%",border:`1px solid ${i.colors.border}`,padding:i.spacing.xs,backgroundColor:i.colors.backgroundSecondary,fontSize:`${i.typography.fontSizeSm}px`,maxHeight:i.typography.fontSizeLg*("md"===c?10:20)},""),children:(0,v.Y)(Q,{text:d,searchFilter:u,theme:i})})})};var Z={name:"1cl2a0e",styles:"display:flex;align-items:flex-start;justify-content:space-between"},X={name:"1ap1kl4",styles:"max-width:540px;flex:1"};const ee=({dataset:e,datasetRecords:t,columns:n,columnVisibility:o,setColumnVisibility:i,rowSize:s,setRowSize:l,searchFilter:d,setSearchFilter:c})=>{const{theme:h}=(0,a.u)(),p=null===e||void 0===e?void 0:e.name,g=(e=>{var t;if(!e)return;const n=(0,W.pt)(e);return null!==(t=null===n||void 0===n?void 0:n.num_records)&&void 0!==t?t:void 0})(null===e||void 0===e?void 0:e.profile),f=t.length;return(0,v.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:h.spacing.sm,marginBottom:h.spacing.sm},""),children:[(0,v.FD)("div",{css:Z,children:[(0,v.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",paddingLeft:h.spacing.sm,paddingRight:h.spacing.sm},""),children:[(0,v.Y)(a.T.Title,{level:3,withoutMargins:!0,children:p}),(0,v.Y)(a.T.Text,{color:"secondary",size:"sm",children:(0,v.Y)(y.A,{id:"crmbMK",defaultMessage:"Displaying {loadedRecordsCount} of {totalRecordsCount, plural, =1 {1 record} other {# records}}",values:{loadedRecordsCount:null!==f&&void 0!==f?f:0,totalRecordsCount:null!==g&&void 0!==g?g:0}})})]}),(0,v.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"flex-start",gap:h.spacing.xs},""),children:[(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(a.B,{componentId:"mlflow.eval-datasets.records-toolbar.row-size-toggle",icon:(0,v.Y)(u.RowsIcon,{})})}),(0,v.Y)(u.DropdownMenu.Content,{align:"end",children:(0,v.FD)(u.DropdownMenu.RadioGroup,{componentId:"mlflow.eval-datasets.records-toolbar.row-size-radio",value:s,onValueChange:e=>l(e),children:[(0,v.Y)(u.DropdownMenu.Label,{children:(0,v.Y)(a.T.Text,{color:"secondary",children:(0,v.Y)(y.A,{id:"DcGPfO",defaultMessage:"Row height"})})}),(0,v.FD)(u.DropdownMenu.RadioItem,{value:"sm",children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(a.T.Text,{children:(0,v.Y)(y.A,{id:"ZNyTjg",defaultMessage:"Small"})})]},"sm"),(0,v.FD)(u.DropdownMenu.RadioItem,{value:"md",children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(a.T.Text,{children:(0,v.Y)(y.A,{id:"fcIHyN",defaultMessage:"Medium"})})]},"md"),(0,v.FD)(u.DropdownMenu.RadioItem,{value:"lg",children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(a.T.Text,{children:(0,v.Y)(y.A,{id:"xgbeVS",defaultMessage:"Large"})})]},"lg")]})})]}),(0,v.FD)(u.DropdownMenu.Root,{children:[(0,v.Y)(u.DropdownMenu.Trigger,{asChild:!0,children:(0,v.Y)(a.B,{componentId:"mlflow.eval-datasets.records-toolbar.columns-toggle",icon:(0,v.Y)(u.ColumnsIcon,{})})}),(0,v.Y)(u.DropdownMenu.Content,{children:n.map(e=>{var t,n;return(0,v.FD)(u.DropdownMenu.CheckboxItem,{componentId:"mlflow.eval-datasets.records-toolbar.column-checkbox",checked:null!==(t=o[null!==(n=e.id)&&void 0!==n?n:""])&&void 0!==t&&t,onCheckedChange:t=>{var n;return i({...o,[null!==(n=e.id)&&void 0!==n?n:""]:t})},children:[(0,v.Y)(u.DropdownMenu.ItemIndicator,{}),(0,v.Y)(a.T.Text,{children:e.header})]},e.id)})})]})]})]}),(0,v.Y)("div",{css:(0,r.AH)({paddingLeft:h.spacing.sm,paddingRight:h.spacing.sm},""),children:(0,v.Y)(m.I,{componentId:"mlflow.eval-datasets.records-toolbar.search-input",prefix:(0,v.Y)(m.S,{}),placeholder:"Search inputs and expectations",value:d,onChange:e=>c(e.target.value),css:X})})]})};const te="inputs",ne="outputs",re="expectations",ae=[{id:te,accessorKey:"inputs",header:"Inputs",enableResizing:!1,cell:G},{id:ne,accessorKey:"outputs",header:"Outputs",enableResizing:!1,cell:G},{id:re,accessorKey:"expectations",header:"Expectations",enableResizing:!1,cell:G}];var oe={name:"1w4ngjc",styles:"flex:1;min-height:0;position:relative;overflow:hidden;display:flex;flex-direction:column"},ie={name:"82a6rk",styles:"flex:1"},se={name:"1w2a2xb",styles:"position:sticky;top:0;z-index:1"};const le=({dataset:e})=>{const t=(0,J.A)(),n=e.dataset_id,[r,a]=(0,s.useState)("md"),[o,i]=(0,s.useState)(""),[l,d]=(0,s.useState)({[te]:!0,[ne]:!1,[re]:!0}),{data:c,isLoading:m,isFetching:h,error:x,fetchNextPage:w,hasNextPage:b}=(({datasetId:e,enabled:t=!0})=>{const{data:n,fetchNextPage:r,hasNextPage:a,isLoading:o,isFetching:i,refetch:l,error:d}=(0,q.q)({queryKey:[C.uz,e],queryFn:async({queryKey:[,e],pageParam:t})=>{const n=new URLSearchParams;return n.set("dataset_id",e),n.set("max_results",50..toString()),t&&n.set("page_token",null!==t&&void 0!==t?t:""),await(0,S.ff)((0,S.we)(`ajax-api/3.0/mlflow/datasets/${e}/records?${n.toString()}`))},cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:t,getNextPageParam:e=>e.next_page_token});return{data:(0,s.useMemo)(()=>{var e;return null!==(e=null===n||void 0===n?void 0:n.pages.flatMap(e=>(0,W.pt)(e.records)))&&void 0!==e?e:[]},[n]),fetchNextPage:r,hasNextPage:a,isLoading:o,isFetching:i,refetch:l,error:d}})({datasetId:null!==n&&void 0!==n?n:"",enabled:!!n}),y=(0,F.v)({isFetching:h,hasNextPage:null!==b&&void 0!==b&&b,fetchNextPage:w}),Y=(0,s.useMemo)(()=>{if(!o.trim())return null!==c&&void 0!==c?c:[];const e=o.toLowerCase();return(null!==c&&void 0!==c?c:[]).filter(t=>{if(JSON.stringify(t.inputs||{}).toLowerCase().includes(e))return!0;return!!JSON.stringify(t.expectations||{}).toLowerCase().includes(e)})},[c,o]);(0,s.useEffect)(()=>{if(!o.trim()||h||!b)return;const e="sm"===r?20:"md"===r?10:5;Y.length<e&&w()},[Y.length,o,h,b,w,r]);const D=(0,f.L)("mlflow/server/js/src/experiment-tracking/pages/experiment-evaluation-datasets/components/ExperimentEvaluationDatasetRecordsTable.tsx",{columns:ae,data:Y,getCoreRowModel:(0,g.HT)(),getRowId:e=>e.dataset_record_id,enableColumnResizing:!1,meta:{rowSize:r,searchFilter:o},state:{columnVisibility:l}});return(0,v.FD)("div",{css:oe,children:[(0,v.Y)(ee,{dataset:e,datasetRecords:null!==c&&void 0!==c?c:[],columns:ae,columnVisibility:l,setColumnVisibility:d,rowSize:r,setRowSize:a,searchFilter:o,setSearchFilter:i}),(0,v.FD)(u.Table,{css:ie,empty:m||0!==D.getRowModel().rows.length?void 0:(0,v.Y)(u.Empty,{description:t.formatMessage({id:"TnD/vL",defaultMessage:"No records found"})}),scrollable:!0,onScroll:e=>y(e.currentTarget),children:[(0,v.Y)(u.TableRow,{isHeader:!0,children:D.getLeafHeaders().map(e=>e.column.getIsVisible()&&(0,v.Y)(u.TableHeader,{componentId:"mlflow.eval-dataset-records.column-header",header:e,column:e.column,css:se,children:(0,p.Kv)(e.column.columnDef.header,e.getContext())},e.id))}),D.getRowModel().rows.map(e=>(0,v.Y)(u.TableRow,{children:e.getVisibleCells().map(e=>(0,v.Y)(u.TableCell,{children:(0,p.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)),(m||h)&&(0,v.Y)(u.TableSkeletonRows,{table:D})]})]})};var de=n(29774),ce=n(89949);var ue={name:"1vfb318",styles:"flex:1;display:flex;align-items:center;justify-content:center"};const me=({error:e})=>{var t;return(0,v.Y)(u.PageWrapper,{css:ue,children:(0,v.Y)(u.Empty,{"data-testid":"fallback",title:(0,v.Y)(y.A,{id:"WtUqxc",defaultMessage:"Error"}),description:null!==(t=null===e||void 0===e?void 0:e.message)&&void 0!==t?t:(0,v.Y)(y.A,{id:"9J8zoa",defaultMessage:"An error occurred while rendering this component."}),image:(0,v.Y)(a.k,{})})})},he=({children:e,resetKey:t})=>(0,v.Y)(ce.tH,{FallbackComponent:me,resetKeys:[t],children:(0,v.Y)(de.Au,{children:e})});var pe=n.p+"static/media/eval-datasets-empty.16c4b3426c8a8c4a9defc41bfb653504.svg";var ge={name:"xvginl",styles:"max-width:600px"};const fe=({experimentId:e})=>{const{theme:t}=(0,a.u)();return(0,v.FD)("div",{css:(0,r.AH)({display:"flex",flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center",padding:t.spacing.md},""),children:[(0,v.Y)(a.T.Title,{level:3,color:"secondary",children:(0,v.Y)(y.A,{id:"c1jD8u",defaultMessage:"Create an evaluation dataset"})}),(0,v.Y)(a.T.Paragraph,{color:"secondary",css:ge,children:(0,v.Y)(y.A,{id:"BMUd0e",defaultMessage:"Create evaluation datasets in order to iteratively evaluate and improve your app. For example, build a dataset from production traces with negative feedback. {learnMoreLink}",values:{learnMoreLink:(0,v.Y)(a.T.Link,{componentId:"mlflow.eval-datasets.learn-more-link",href:"https://mlflow.org/docs/latest/genai/datasets/",openInNewTab:!0,children:(0,v.Y)(y.A,{id:"izS5yQ",defaultMessage:"Learn more"})})}})}),(0,v.Y)("img",{css:(0,r.AH)({marginBottom:t.spacing.md,maxWidth:"min(100%, 600px)"},""),src:pe,alt:"No datasets found"}),(0,v.Y)(z.Z,{experimentId:e})]})};var ve=n(5857),xe=n(72607),we=n(54871);var be={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},ye={name:"n56zw6",styles:"display:flex;flex-direction:row;flex:1;min-height:0px"},Ce={name:"5ob2ly",styles:"display:flex;position:relative"};const Se=()=>{const{experimentId:e}=(0,l.g)(),{theme:t}=(0,a.u)(),[n,d]=(0,s.useState)(400),[u,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[g,f]=(0,ve.n)();(0,we.qd)("selectedDatasetId",g);const[x,w]=(0,s.useState)("");c()(e,"Experiment ID must be defined");const{data:b,isLoading:y,isFetching:C,error:S,refetch:Y,fetchNextPage:D,hasNextPage:M}=(0,xe.J)({experimentId:e,nameFilter:x}),I=(0,s.useMemo)(()=>{var e;return null!==(e=null===b||void 0===b?void 0:b.map(e=>e.dataset_id))&&void 0!==e?e:[]},[b]);(0,s.useEffect)(()=>{null===b||void 0===b||!b.length||g&&I.includes(g)||f(b[0].dataset_id)},[b,g,I,f]);const E=(0,s.useMemo)(()=>{if(null!==b&&void 0!==b&&b.length&&g)return b.find(e=>e.dataset_id===g)},[b,g]);return(0,v.FD)("div",{css:ye,children:[(0,v.Y)(o.ResizableBox,{css:Ce,style:{flex:`0 0 ${h?0:n}px`},width:n,axis:"x",resizeHandles:["e"],minConstraints:[250,0],handle:(0,v.Y)(i.z,{runListHidden:h,updateRunListHidden:()=>{p(!h)}}),onResize:(e,{size:t})=>{h||d(t.width)},onResizeStart:()=>!h&&m(!0),onResizeStop:()=>m(!1),children:(0,v.Y)("div",{css:(0,r.AH)({display:h?"none":"flex",flex:1,minWidth:0},""),children:(0,v.Y)(V,{experimentId:e,datasets:b,isLoading:y,isFetching:C,error:S,refetch:Y,fetchNextPage:D,hasNextPage:M,selectedDatasetId:g,setSelectedDatasetId:f,searchFilter:x,setSearchFilter:w})})}),(0,v.FD)("div",{css:(0,r.AH)({flex:1,display:"flex",borderLeft:`1px solid ${t.colors.border}`,minHeight:"0px",overflow:"hidden"},""),children:[!y&&!E&&(0,v.Y)(fe,{experimentId:e}),E&&(0,v.Y)(le,{dataset:E})]}),u&&(0,v.Y)(r.mL,{styles:be})]})};var Ye=()=>(0,v.Y)(he,{children:(0,v.Y)(Se,{})})},32874:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(27757),a=n(82716),o=n(46709),i=n(40724),s=n(79081),l=n(66916),d=n(42747),c=n(61077),u=n(39595),m=n(61060),h=n(34599);var p=n(73408);const g=({visible:e,experimentId:t,onCancel:n})=>{const{theme:i}=(0,r.u)(),g=(0,d.tz)(),[f,v]=(0,o.useState)(""),[x,w]=(0,o.useState)(""),{createEvaluationDatasetMutation:b,isLoading:y}=(({onSuccess:e,onError:t})=>{const n=(0,u.jE)(),{mutate:r,isLoading:a}=(0,m.n)({mutationFn:async({datasetName:e,experimentIds:t})=>{const n={name:e,experiment_ids:t};return(await(0,c.ff)((0,c.we)("ajax-api/3.0/mlflow/datasets/create"),{method:"POST",body:n})).dataset},onSuccess:()=>{n.invalidateQueries({queryKey:[h.P4]}),null===e||void 0===e||e()},onError:e=>{null===t||void 0===t||t(e)}});return{createEvaluationDatasetMutation:r,isLoading:a}})({onSuccess:()=>{n()}}),C=(0,o.useCallback)(()=>{f?b({datasetName:f,experimentIds:[t]}):w(g.formatMessage({id:"sbHChH",defaultMessage:"Dataset name is required"}))},[b,t,f,g]);return(0,p.FD)(s.d,{componentId:"mlflow.create-evaluation-dataset-modal",visible:e,onCancel:n,okText:g.formatMessage({id:"creoEe",defaultMessage:"Create"}),cancelText:g.formatMessage({id:"nEnDEu",defaultMessage:"Cancel"}),onOk:C,okButtonProps:{loading:y,disabled:!f},title:(0,p.Y)(d.sA,{id:"287Ack",defaultMessage:"Create evaluation dataset"}),zIndex:i.options.zIndexBase+20,children:[(0,p.Y)(a.FormUI.Label,{htmlFor:"dataset-name-input",children:(0,p.Y)(d.sA,{id:"xdFMIN",defaultMessage:"Dataset name"})}),(0,p.Y)(l.I,{componentId:"mlflow.create-evaluation-dataset-modal.dataset-name",id:"dataset-name-input",name:"name",type:"text",placeholder:g.formatMessage({id:"ZQpc2w",defaultMessage:"Enter dataset name"}),value:f,onChange:e=>{v(e.target.value),w("")}}),x&&(0,p.Y)(a.FormUI.Message,{type:"error",message:x})]})};var f={name:"b9l38d",styles:"width:min-content"};const v=({experimentId:e})=>{const[t,n]=(0,o.useState)(!1);return(0,p.FD)(p.FK,{children:[(0,p.Y)(r.B,{componentId:"mlflow.eval-datasets.create-dataset-button",css:f,icon:(0,p.Y)(a.DatabaseIcon,{}),onClick:()=>n(!0),children:(0,p.Y)(i.A,{id:"N7BCue",defaultMessage:"Create dataset"})}),(0,p.Y)(g,{experimentId:e,visible:t,onCancel:()=>n(!1)})]})}},34599:function(e,t,n){n.d(t,{Hb:function(){return i},P4:function(){return a},lA:function(){return o},uz:function(){return r}});const r="GET_DATASET_RECORDS",a="SEARCH_EVALUATION_DATASETS",o="FETCH_TRACES",i="CHECK_MULTITURN_DATASETS"},42595:function(e,t,n){n.d(t,{t:function(){return u},z:function(){return m}});var r=n(68248),a=n(27757),o=n(46709),i=n(25637),s=n(52572),l=n(73408);var d={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},c={name:"5ob2ly",styles:"display:flex;position:relative"};const u=({runListHidden:e,width:t,onResize:n,children:a,onHiddenChange:u,maxWidth:h})=>{const p=(0,s.e)(),[g,f]=(0,o.useState)(!1);return(0,l.FD)(l.FK,{children:[(0,l.Y)(i.ResizableBox,{css:c,style:{flex:`0 0 ${e?0:t}px`},width:t,axis:"x",resizeHandles:["e"],minConstraints:[250,0],maxConstraints:void 0===h?void 0:[h,0],handle:(0,l.Y)(m,{runListHidden:e,updateRunListHidden:e=>{u?u(e):p(t=>({...t,runListHidden:e}))}}),onResize:(t,{size:r})=>{e||n(r.width)},onResizeStart:()=>!e&&f(!0),onResizeStop:()=>f(!1),children:a}),g&&(0,l.Y)(r.mL,{styles:d})]})},m=o.forwardRef(({updateRunListHidden:e,runListHidden:t,...n},o)=>{const{theme:i}=(0,a.u)();return(0,l.FD)("div",{ref:o,...n,css:(0,r.AH)({transition:"opacity 0.2s",width:0,overflow:"visible",height:"100%",position:"relative",zIndex:10,display:"flex",opacity:t?1:0,"&:hover":{opacity:1,".bar":{opacity:1},".button":{border:`2px solid ${i.colors.actionDefaultBorderHover}`}}},""),children:[(0,l.Y)("div",{css:(0,r.AH)({position:"absolute",left:-i.general.iconSize/2,width:i.general.iconSize,cursor:t?void 0:"ew-resize",height:"100%",top:0,bottom:0},""),children:(0,l.Y)("div",{className:"button",css:(0,r.AH)({top:"50%",transition:"border-color 0.2s",position:"absolute",width:i.general.iconSize,height:i.general.iconSize,backgroundColor:i.colors.backgroundPrimary,borderRadius:i.general.iconSize,overflow:"hidden",border:`1px solid ${i.colors.border}`,display:"flex",alignItems:"center",justifyContent:"center",zIndex:11},""),children:(0,l.Y)(a.B,{componentId:"mlflow.experiment_page.table_resizer.collapse",onClick:()=>e(!t),icon:t?(0,l.Y)(a.o,{}):(0,l.Y)(a.n,{}),size:"small"})})}),(0,l.Y)("div",{className:"bar",css:(0,r.AH)({position:"absolute",opacity:0,left:-1.5,width:3,height:"100%",top:0,bottom:0,backgroundColor:i.colors.actionPrimaryBackgroundDefault},"")})]})})},52572:function(e,t,n){n.d(t,{e:function(){return s},i:function(){return i}});var r=n(46709),a=n(73408);const o=r.createContext(e=>e),i=({children:e,setUIState:t})=>(0,a.Y)(o.Provider,{value:t,children:e}),s=()=>r.useContext(o)},52849:function(e,t,n){n.d(t,{v:function(){return a}});var r=n(46709);const a=({isFetching:e,hasNextPage:t,fetchNextPage:n})=>(0,r.useCallback)(r=>{if(r){const{scrollHeight:a,scrollTop:o,clientHeight:i}=r;a-o-i<200&&!e&&t&&n()}},[n,e,t])},59930:function(e){e.exports=function(e,t,n,r,a,o,i,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,r,a,o,i,s],c=0;(l=new Error(t.replace(/%s/g,function(){return d[c++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},61060:function(e,t,n){n.d(t,{n:function(){return m}});var r=n(46709),a=n(48667),o=n(56606),i=n(78922),s=n(27949),l=n(4200);class d extends l.Q{constructor(e,t){super(),this.client=e,this.setOptions(t),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var t;const n=this.options;this.options=this.client.defaultMutationOptions(e),(0,o.f8)(n,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(t=this.currentMutation)||t.setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(null==(e=this.currentMutation)||e.removeObserver(this))}onMutationUpdate(e){this.updateResult();const t={listeners:!0};"success"===e.type?t.onSuccess=!0:"error"===e.type&&(t.onError=!0),this.notify(t)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:"undefined"!==typeof e?e:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const e=this.currentMutation?this.currentMutation.state:(0,i.$)(),t={...e,isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset};this.currentResult=t}notify(e){s.j.batch(()=>{var t,n,r,a;if(this.mutateOptions&&this.hasListeners())if(e.onSuccess)null==(t=(n=this.mutateOptions).onSuccess)||t.call(n,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(r=(a=this.mutateOptions).onSettled)||r.call(a,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(e.onError){var o,i,s,l;null==(o=(i=this.mutateOptions).onError)||o.call(i,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(s=(l=this.mutateOptions).onSettled)||s.call(l,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}e.listeners&&this.listeners.forEach(({listener:e})=>{e(this.currentResult)})})}}var c=n(39595),u=n(56154);function m(e,t,n){const i=(0,o.GR)(e,t,n),l=(0,c.jE)({context:i.context}),[m]=r.useState(()=>new d(l,i));r.useEffect(()=>{m.setOptions(i)},[m,i]);const p=(0,a.r)(r.useCallback(e=>m.subscribe(s.j.batchCalls(e)),[m]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),g=r.useCallback((e,t)=>{m.mutate(e,t).catch(h)},[m]);if(p.error&&(0,u.G)(m.options.useErrorBoundary,[p.error]))throw p.error;return{...p,mutate:g,mutateAsync:p.mutate}}function h(){}},72607:function(e,t,n){n.d(t,{J:function(){return s}});var r=n(96584),a=n(61077),o=n(46709),i=n(34599);const s=({experimentId:e,enabled:t=!0,nameFilter:n=""})=>{const{data:s,fetchNextPage:l,hasNextPage:d,isLoading:c,isFetching:u,refetch:m,error:h}=(0,r.q)({queryKey:[i.P4,e,n],queryFn:async({queryKey:[,e,t],pageParam:n})=>{const r={experiment_ids:[e],filter_string:t?`name ILIKE '%${t}%'`:void 0,order_by:["created_time DESC"],max_results:50,page_token:n};return await(0,a.ff)((0,a.we)("ajax-api/3.0/mlflow/datasets/search"),{method:"POST",body:r})},cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:t,getNextPageParam:e=>e.next_page_token});return{data:(0,o.useMemo)(()=>{var e;return null!==(e=null===s||void 0===s?void 0:s.pages.flatMap(e=>{var t;return null!==(t=e.datasets)&&void 0!==t?t:[]}))&&void 0!==e?e:[]},[s]),fetchNextPage:l,hasNextPage:d,isLoading:c,isFetching:u,refetch:m,error:h}}},76256:function(e,t,n){n.d(t,{L:function(){return a},S:function(){return o}});var r=n(43617);function a(e,t){return(0,r.N4)(t)}const o=r.N4},89949:function(e,t,n){n.d(t,{tH:function(){return s}});var r=n(46709);function a(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}a({},"ErrorBoundary",()=>s);a({},"ErrorBoundaryContext",()=>o);const o=(0,r.createContext)(null),i={didCatch:!1,error:null};class s extends r.Component{state=i;static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary=(...e)=>{const{error:t}=this.state;null!==t&&(this.props.onReset?.({args:e,reason:"imperative-api"}),this.setState(i))};componentDidCatch(e,t){this.props.onError?.(e,t)}componentDidUpdate(e,t){const{didCatch:n}=this.state,{resetKeys:r}=this.props;n&&null!==t.error&&function(e=[],t=[]){return e.length!==t.length||e.some((e,n)=>!Object.is(e,t[n]))}(e.resetKeys,r)&&(this.props.onReset?.({next:r,prev:e.resetKeys,reason:"keys"}),this.setState(i))}render(){const{children:e,fallbackRender:t,FallbackComponent:n,fallback:a}=this.props,{didCatch:i,error:s}=this.state;let l=e;if(i){const e={error:s,resetErrorBoundary:this.resetErrorBoundary};if((0,r.isValidElement)(a))l=a;else if("function"===typeof t)l=t(e);else{if(!n)throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop");l=(0,r.createElement)(n,e)}}return(0,r.createElement)(o.Provider,{value:{didCatch:i,error:s,resetErrorBoundary:this.resetErrorBoundary}},l)}}function l(e){if(null==e||"boolean"!==typeof e.didCatch||"function"!==typeof e.resetErrorBoundary)throw new Error("ErrorBoundaryContext not found");return!0}function d(){const e=(0,r.useContext)(o);l(e);const[t,n]=(0,r.useState)({error:null,hasError:!1}),a=(0,r.useMemo)(()=>({resetBoundary:()=>{e?.resetErrorBoundary(),n({error:null,hasError:!1})},showBoundary:e=>n({error:e,hasError:!0})}),[e?.resetErrorBoundary]);if(t.hasError)throw t.error;return a}a({},"useErrorBoundary",()=>d);function c(e,t){const n=n=>(0,r.createElement)(s,t,(0,r.createElement)(e,n)),a=e.displayName||e.name||"Unknown";return n.displayName=`withErrorBoundary(${a})`,n}a({},"withErrorBoundary",()=>c)}}]);