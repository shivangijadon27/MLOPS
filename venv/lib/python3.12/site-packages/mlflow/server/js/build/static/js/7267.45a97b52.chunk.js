"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[7267],{5857:function(e,n,t){t.d(n,{O:function(){return i},n:function(){return a}});var r=t(46709),o=t(91105);const i="selectedDatasetId",a=()=>{var e;const[n,t]=(0,o.ok)();return[null!==(e=n.get(i))&&void 0!==e?e:void 0,(0,r.useCallback)(e=>{t(n=>e?(n.set(i,e),n):(n.delete(i),n),{replace:!0})},[t]),(0,r.useCallback)(()=>{t(e=>(e.delete(i),e),{replace:!0})},[t])]}},16144:function(e,n,t){t.d(n,{f:function(){return r.f}});var r=t(64226)},27556:function(e,n,t){t.d(n,{YQ:function(){return o},d7:function(){return a}});var r=t(46709);function o(e,n,t){var o=this,i=(0,r.useRef)(null),a=(0,r.useRef)(0),s=(0,r.useRef)(null),l=(0,r.useRef)([]),u=(0,r.useRef)(),d=(0,r.useRef)(),c=(0,r.useRef)(e),m=(0,r.useRef)(!0);c.current=e;var p="undefined"!=typeof window,h=!n&&0!==n&&p;if("function"!=typeof e)throw new TypeError("Expected a function");n=+n||0;var g=!!(t=t||{}).leading,f=!("trailing"in t)||!!t.trailing,v="maxWait"in t,y="debounceOnServer"in t&&!!t.debounceOnServer,b=v?Math.max(+t.maxWait||0,n):null;(0,r.useEffect)(function(){return m.current=!0,function(){m.current=!1}},[]);var R=(0,r.useMemo)(function(){var e=function(e){var n=l.current,t=u.current;return l.current=u.current=null,a.current=e,d.current=c.current.apply(t,n)},t=function(e,n){h&&cancelAnimationFrame(s.current),s.current=h?requestAnimationFrame(e):setTimeout(e,n)},r=function(e){if(!m.current)return!1;var t=e-i.current;return!i.current||t>=n||t<0||v&&e-a.current>=b},R=function(n){return s.current=null,f&&l.current?e(n):(l.current=u.current=null,d.current)},w=function e(){var o=Date.now();if(r(o))return R(o);if(m.current){var s=n-(o-i.current),l=v?Math.min(s,b-(o-a.current)):s;t(e,l)}},C=function(){if(p||y){var c=Date.now(),h=r(c);if(l.current=[].slice.call(arguments),u.current=o,i.current=c,h){if(!s.current&&m.current)return a.current=i.current,t(w,n),g?e(i.current):d.current;if(v)return t(w,n),e(i.current)}return s.current||t(w,n),d.current}};return C.cancel=function(){s.current&&(h?cancelAnimationFrame(s.current):clearTimeout(s.current)),a.current=0,l.current=i.current=u.current=s.current=null},C.isPending=function(){return!!s.current},C.flush=function(){return s.current?R(Date.now()):d.current},C},[g,v,n,b,f,h,p,y]);return R}function i(e,n){return e===n}function a(e,n,t){var a=t&&t.equalityFn||i,s=(0,r.useRef)(e),l=(0,r.useState)({})[1],u=o((0,r.useCallback)(function(e){s.current=e,l({})},[l]),n,t),d=(0,r.useRef)(e);return a(d.current,e)||(u(e),d.current=e),[s.current,u]}},29774:function(e,n,t){t.d(n,{Au:function(){return s},tF:function(){return l}});var r=t(46709),o=t(36476),i=t(73408);const a=(0,r.createContext)({currentUserActionError:null,handleError:()=>{},handlePromise:()=>{},clearUserActionError:()=>{}}),s=({children:e,errorFilter:n})=>{const[t,s]=(0,r.useState)(null),l=(0,r.useCallback)((e,t)=>{if(null===n||void 0===n||!n(e)){const n=(0,o.a$)(e);s(n),t&&t(n)}},[s,n]),u=(0,r.useCallback)(e=>{e.catch(e=>{l(e)})},[l]),d=(0,r.useCallback)(()=>{s(null)},[s]);return(0,i.Y)(a.Provider,{value:(0,r.useMemo)(()=>({currentUserActionError:t,handleError:l,handlePromise:u,clearUserActionError:d}),[d,t,l,u]),children:e})},l=()=>{const{currentUserActionError:e,handleError:n,handlePromise:t,clearUserActionError:o}=(0,r.useContext)(a),i=(0,r.useCallback)((e,t,r)=>{n(t,r)},[n]);return(0,r.useMemo)(()=>({currentUserActionError:e,handleError:n,handleErrorWithEvent:i,handlePromise:t,clearUserActionError:o}),[o,n,t,e,i])}},33972:function(e,n,t){t.d(n,{i:function(){return i}});var r=t(76118),o=t(46709);const i=(e,n)=>{const t=(0,o.useRef)();return t.current&&(0,r.isEqual)(n,t.current.deps)||(t.current={deps:n,value:e()}),t.current.value}},60062:function(e,n,t){t.d(n,{E:function(){return g}});var r=t(46709),o=t(48667),i=t(56606),a=t(27949),s=t(23403),l=t(4200);class u extends l.Q{constructor(e,n){super(),this.client=e,this.queries=[],this.result=[],this.observers=[],this.observersMap={},n&&this.setQueries(n)}onSubscribe(){1===this.listeners.size&&this.observers.forEach(e=>{e.subscribe(n=>{this.onUpdate(e,n)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.observers.forEach(e=>{e.destroy()})}setQueries(e,n){this.queries=e,a.j.batch(()=>{const e=this.observers,t=this.findMatchingObservers(this.queries);t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions,n));const r=t.map(e=>e.observer),o=Object.fromEntries(r.map(e=>[e.options.queryHash,e])),a=r.map(e=>e.getCurrentResult()),s=r.some((n,t)=>n!==e[t]);(e.length!==r.length||s)&&(this.observers=r,this.observersMap=o,this.result=a,this.hasListeners()&&((0,i.iv)(e,r).forEach(e=>{e.destroy()}),(0,i.iv)(r,e).forEach(e=>{e.subscribe(n=>{this.onUpdate(e,n)})}),this.notify()))})}getCurrentResult(){return this.result}getQueries(){return this.observers.map(e=>e.getCurrentQuery())}getObservers(){return this.observers}getOptimisticResult(e){return this.findMatchingObservers(e).map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions))}findMatchingObservers(e){const n=this.observers,t=new Map(n.map(e=>[e.options.queryHash,e])),r=e.map(e=>this.client.defaultQueryOptions(e)),o=r.flatMap(e=>{const n=t.get(e.queryHash);return null!=n?[{defaultedQueryOptions:e,observer:n}]:[]}),i=new Set(o.map(e=>e.defaultedQueryOptions.queryHash)),a=r.filter(e=>!i.has(e.queryHash)),l=new Set(o.map(e=>e.observer)),u=n.filter(e=>!l.has(e)),d=e=>{const n=this.client.defaultQueryOptions(e),t=this.observersMap[n.queryHash];return null!=t?t:new s.$(this.client,n)},c=a.map((e,n)=>{if(e.keepPreviousData){const t=u[n];if(void 0!==t)return{defaultedQueryOptions:e,observer:t}}return{defaultedQueryOptions:e,observer:d(e)}});return o.concat(c).sort((e,n)=>r.indexOf(e.defaultedQueryOptions)-r.indexOf(n.defaultedQueryOptions))}onUpdate(e,n){const t=this.observers.indexOf(e);-1!==t&&(this.result=(0,i._D)(this.result,t,n),this.notify())}notify(){a.j.batch(()=>{this.listeners.forEach(({listener:e})=>{e(this.result)})})}}var d=t(39595),c=t(56718),m=t(77524),p=t(60164),h=t(2719);function g({queries:e,context:n}){const t=(0,d.jE)({context:n}),i=(0,c.w)(),s=(0,m.h)(),l=r.useMemo(()=>e.map(e=>{const n=t.defaultQueryOptions(e);return n._optimisticResults=i?"isRestoring":"optimistic",n}),[e,t,i]);l.forEach(e=>{(0,h.tu)(e),(0,p.LJ)(e,s)}),(0,p.wZ)(s);const[g]=r.useState(()=>new u(t,l)),f=g.getOptimisticResult(l);(0,o.r)(r.useCallback(e=>i?()=>{}:g.subscribe(a.j.batchCalls(e)),[g,i]),()=>g.getCurrentResult(),()=>g.getCurrentResult()),r.useEffect(()=>{g.setQueries(l,{listeners:!1})},[l,g]);const v=f.some((e,n)=>(0,h.EU)(l[n],e,i))?f.flatMap((e,n)=>{const t=l[n],r=g.getObservers()[n];if(t&&r){if((0,h.EU)(t,e,i))return(0,h.iL)(t,r,s);(0,h.nE)(e,i)&&(0,h.iL)(t,r,s)}return[]}):[];if(v.length>0)throw Promise.all(v);const y=g.getQueries(),b=f.find((e,n)=>{var t,r;return(0,p.$1)({result:e,errorResetBoundary:s,useErrorBoundary:null!=(t=null==(r=l[n])?void 0:r.useErrorBoundary)&&t,query:y[n]})});if(null!=b&&b.error)throw b.error;return f}},64226:function(e,n,t){t.d(n,{f:function(){return u}});t(46709);var r=t(79081),o=t(7655),i=t(73408);const a=86400,s={timeZoneName:"short",year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"},l=({date:e,intl:n,tooltipFormatOptions:t=s})=>{const r=new Date,o=Math.round((r.getTime()-e.getTime())/1e3),i=navigator.language||"en-US";let l="";try{l=Intl.DateTimeFormat(i,t).format(e)}catch(u){}for(const s of(e=>[{seconds:31536e3,timeAgoMessage:n=>e.formatMessage({id:"NF6ePS",defaultMessage:"{count, plural, =1 {1 year} other {# years}} ago"},{count:n})},{seconds:2592e3,timeAgoMessage:n=>e.formatMessage({id:"N79Rdb",defaultMessage:"{count, plural, =1 {1 month} other {# months}} ago"},{count:n})},{seconds:a,timeAgoMessage:n=>e.formatMessage({id:"XwD3hV",defaultMessage:"{count, plural, =1 {1 day} other {# days}} ago"},{count:n})},{seconds:3600,timeAgoMessage:n=>e.formatMessage({id:"i1Hj20",defaultMessage:"{count, plural, =1 {1 hour} other {# hours}} ago"},{count:n})},{seconds:60,timeAgoMessage:n=>e.formatMessage({id:"ZO8PZt",defaultMessage:"{count, plural, =1 {1 minute} other {# minutes}} ago"},{count:n})},{seconds:1,timeAgoMessage:n=>e.formatMessage({id:"gQB+Vs",defaultMessage:"{count, plural, =1 {1 second} other {# seconds}} ago"},{count:n})}])(n)){const e=Math.floor(o/s.seconds);if(e>=1)return{displayText:s.timeAgoMessage(e),tooltipTitle:l}}return{displayText:n.formatMessage({id:"ZOsiNc",defaultMessage:"just now"}),tooltipTitle:l}},u=({date:e,tooltipFormatOptions:n=s})=>{const t=(0,o.A)(),{displayText:a,tooltipTitle:u}=l({date:e,intl:t,tooltipFormatOptions:n});return(0,i.Y)(r.T,{componentId:"web-shared.time-ago",content:u,children:(0,i.Y)("span",{children:a})})}},65159:function(e,n,t){t.r(n),t.d(n,{default:function(){return Rn}});var r=t(68248),o=t(59930),i=t.n(o),a=t(46709),s=t(95328),l=t(29774),u=t(89949),d=t(82716),c=t(27757),m=t(40724),p=t(73408);var h={name:"1vfb318",styles:"flex:1;display:flex;align-items:center;justify-content:center"};const g=({error:e})=>{var n;return(0,p.Y)(d.PageWrapper,{css:h,children:(0,p.Y)(d.Empty,{"data-testid":"fallback",title:(0,p.Y)(m.A,{id:"w80phd",defaultMessage:"Error"}),description:null!==(n=null===e||void 0===e?void 0:e.message)&&void 0!==n?n:(0,p.Y)(m.A,{id:"tQrhZ8",defaultMessage:"An error occurred while rendering this component."}),image:(0,p.Y)(c.k,{})})})},f=({children:e,resetKey:n})=>(0,p.Y)(u.tH,{FallbackComponent:g,resetKeys:[n],children:(0,p.Y)(l.Au,{children:e})});var v=t(76256),y=t(77680),b=t(79081),R=t(91105),w=t(70513),C=t(60284),x=t(49620),S=t(67063),I=t(16144);const D=(e,n)=>[e,n].join("."),M=e=>{const[n,...t]=e.split(".");if(t.length&&Object.values(le).includes(n))return{columnType:n,key:t.join(".")}};var Y=t(34931);const A=(0,a.createContext)({isRowHidden:()=>!1,toggleRowVisibility:()=>{},setVisibilityMode:()=>{},visibilityMode:Y.oy.SHOWALL,usingCustomVisibility:!1,allRunsHidden:!1}),T=({children:e})=>{const[n,t]=(0,a.useState)(new Set),[r,o]=(0,a.useState)(Y.oy.SHOWALL),i=(0,a.useCallback)((e,t,o)=>r===Y.oy.CUSTOM?n.has(e):r===Y.oy.HIDEALL||(r===Y.oy.FIRST_10_RUNS?t>=10:r===Y.oy.FIRST_20_RUNS?t>=20:r===Y.oy.HIDE_FINISHED_RUNS&&["FINISHED","FAILED","KILLED"].includes(null!==o&&void 0!==o?o:"")),[n,r]),s=(0,a.useCallback)(e=>{t(n=>{const t=new Set(n);return t.has(e)?t.delete(e):t.add(e),t}),o(Y.oy.CUSTOM)},[]),l=(0,a.useCallback)(e=>{o(e),e!==Y.oy.CUSTOM&&t(new Set)},[]),u=r===Y.oy.CUSTOM&&n.size>0,d=r===Y.oy.HIDEALL,c=(0,a.useMemo)(()=>({isRowHidden:i,toggleRowVisibility:s,setVisibilityMode:l,visibilityMode:r,usingCustomVisibility:u,allRunsHidden:d}),[i,s,l,r,u,d]);return(0,p.Y)(A.Provider,{value:c,children:e})},k=()=>(0,a.useContext)(A);var E=t(44105),F=t(31655),H=t(181),U=t(5857);const L=({dataset:e,children:n,className:t})=>{const{experimentId:r}=(0,R.g)(),o=(0,a.useMemo)(()=>(0,H.pt)(e.source),[e.source]),{search:i,hash:s}=(0,R.zy)();if(null!==o&&void 0!==o&&o.dataset_id&&r){const e=C.Ay.getExperimentPageTabRoute(r,E.fM.Datasets),a=new URLSearchParams(i);return a.set(U.O,o.dataset_id),(0,p.Y)(R.N_,{to:{pathname:e,search:a.toString(),hash:s},className:t,children:n})}return n};const O=({row:e,table:{options:{meta:n}}})=>"subRuns"in e.original?(0,p.Y)("div",{children:"-"}):(0,p.Y)(d.Checkbox,{componentId:"mlflow.eval-runs.checkbox-cell","data-testid":`eval-runs-table-cell-checkbox-${e.id}`,disabled:!e.getCanSelect(),isChecked:e.getIsSelected(),wrapperStyle:{padding:0,margin:0},onChange:()=>e.toggleSelected(),onClick:e=>e.stopPropagation()});var B={name:"y1ecum",styles:"text-overflow:ellipsis;white-space:nowrap;overflow:hidden;flex-shrink:1"};const N=({row:e,table:{options:{meta:n}}})=>{const{theme:t}=(0,c.u)(),o=(0,x.MQ)(),i=(0,x.LE)();if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const a=e.original.info.runUuid;return(0,p.FD)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:t.spacing.xs},""),onClick:()=>{var e,t;null===(e=(t=n).setSelectedRunUuid)||void 0===e||e.call(t,a)},children:[(0,p.Y)(S.E,{color:i(a),onChangeColor:e=>o({runUuid:a,colorValue:e})}),(0,p.Y)(c.T.Link,{css:B,componentId:"mlflow.eval-runs.run-name-cell",id:"run-name-cell",children:e.original.info.runName}),!(0,F.iA)()&&(0,p.Y)("div",{css:(0,r.AH)({display:"none",flexShrink:0,".eval-runs-table-row:hover &":{display:"inline"},svg:{width:t.typography.fontSizeMd,height:t.typography.fontSizeMd}},""),children:(0,p.Y)(R.N_,{target:"_blank",rel:"noreferrer",to:C.Ay.getRunPageTabRoute(e.original.info.experimentId,a,E.N3.EVALUATIONS),children:(0,p.Y)(b.T,{content:(0,p.Y)(m.A,{id:"T3RjOb",defaultMessage:"Go to the run"}),componentId:"mlflow.eval-runs.run-name-cell.tooltip",children:(0,p.Y)(c.B,{type:"link",target:"_blank",icon:(0,p.Y)(c.au,{}),size:"small",componentId:"mlflow.eval-runs.run-name-cell.open-run-page"})})})})]})};var z={name:"1kvqz6y",styles:"& > svg{width:12px;height:12px;}"},_={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"},q={name:"1cot5qr",styles:"max-width:100%;margin-right:0"};const P=({row:e,table:{options:{meta:n}}})=>{var t,o,i,a;const{theme:s}=(0,c.u)();if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const l=e.original,u=null!==(t=null===(o=l.inputs)||void 0===o?void 0:o.datasetInputs)&&void 0!==t?t:[],m=null!==(i=null===(a=u[0])||void 0===a?void 0:a.dataset)&&void 0!==i?i:null;if(!m)return(0,p.Y)("div",{children:"-"});const h=(0,p.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:s.spacing.xs,maxWidth:"100%",color:s.colors.textPrimary},""),children:[(0,p.Y)(d.TableIcon,{css:z}),(0,p.Y)(c.T.Text,{css:_,children:m.name})]}),g=(0,p.Y)(L,{dataset:m,children:h});return(0,p.Y)("div",{children:(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.dataset-cell-tooltip",content:m.name,children:(0,p.Y)(d.Tag,{componentId:"mlflow.eval-runs.dataset-cell",onClick:e=>{var t,r,o,i;e.stopPropagation(),n.setSelectedDatasetWithRun({datasetWithTags:{dataset:m},runData:{experimentId:null===(t=l.info)||void 0===t?void 0:t.experimentId,runUuid:null!==(r=null===(o=l.info)||void 0===o?void 0:o.runUuid)&&void 0!==r?r:"",runName:null===(i=l.info)||void 0===i?void 0:i.runName,datasets:u}}),n.setIsDrawerOpen(!0)},id:"dataset-cell",css:q,children:g})})})};var V={name:"18x9eu",styles:"max-width:100%;margin-right:0;cursor:pointer"},W={name:"qhxz92",styles:"max-width:100%"},K={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"};const j=({row:e})=>{var n,t,o,i,a;const s="inputs"in e.original?null===(n=e.original.inputs)||void 0===n||null===(t=n.modelInputs)||void 0===t||null===(o=t[0])||void 0===o?void 0:o.modelId:void 0,{theme:l}=(0,c.u)(),{data:u,isLoading:m}=(0,w.b3)({loggedModelId:s,enabled:Boolean(s)});if(!s||"subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const h=null!==(i=null===u||void 0===u||null===(a=u.info)||void 0===a?void 0:a.name)&&void 0!==i?i:s;return m?(0,p.Y)(d.ParagraphSkeleton,{}):(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.model-version-cell-tooltip",content:h,children:(0,p.Y)(d.Tag,{componentId:"mlflow.eval-runs.model-version-cell",id:"model-version-cell",css:V,children:(0,p.Y)(R.N_,{to:C.Ay.getExperimentLoggedModelDetailsPageRoute(e.original.info.experimentId,s),target:"_blank",css:W,children:(0,p.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:l.spacing.xs,maxWidth:"100%"},""),children:[(0,p.Y)(d.ModelsIcon,{css:(0,r.AH)({"& > svg":{width:12,height:12,color:l.colors.textPrimary}},"")}),(0,p.Y)(c.T.Text,{css:K,children:h})]})})})})},Q=({getValue:e})=>{const n=e();return(0,p.Y)("span",{title:n,children:null!==n&&void 0!==n?n:"-"})};var G={name:"1bnhmdk",styles:"overflow:hidden;text-overflow:ellipsis;text-wrap:nowrap"},$={name:"zfbdj8",styles:"display:none;flex-shrink:0"};const Z=({column:e,title:n})=>{const{theme:t}=(0,c.u)(),o=(0,a.useMemo)(()=>{var n,t;return null!==(n=null===(t=M(e.id))||void 0===t?void 0:t.key)&&void 0!==n?n:e.id},[e.id]);return(0,p.FD)("div",{css:(0,r.AH)({overflow:"hidden",display:"flex",alignItems:"center",gap:t.spacing.xs,":hover":{cursor:"pointer","& > div":{display:"inline"}}},""),children:[(0,p.Y)(b.T,{componentId:"codegen_no_dynamic_mlflow_web_js_src_experiment_tracking_pages_experiment_evaluation_runs_experimentevaluationrunstablecellrenderers_284",content:o,children:(0,p.Y)("span",{css:G,children:(0,p.Y)(c.T.Text,{bold:!0,children:null!==n&&void 0!==n?n:o})})}),!e.getIsSorted()&&(0,p.Y)("div",{css:$,children:(0,p.Y)(d.SortUnsortedIcon,{})})]})},X=({row:e})=>{if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const n=e.original.info.startTime;return n?(0,p.Y)(I.f,{date:new Date(Number(n))}):(0,p.Y)("div",{children:"-"})};var J={name:"e0dnmk",styles:"cursor:pointer"};const ee=({row:e,table:n})=>{const{isRowHidden:t,toggleRowVisibility:r}=k();if("subRuns"in e.original)return(0,p.Y)("div",{children:"-"});const o=e.original.info.runUuid,i=e.index,a=e.original.info.status,s=t(o,i,a)?d.VisibleOffIcon:d.VisibleIcon;return(0,p.Y)(s,{onClick:e=>{e.stopPropagation(),r(o)},css:J})};var ne=t(21678);let te=function(e){return e.TRACES="traces",e.CHARTS="charts",e}({});const re="viewMode";var oe=t(7655);const ie=a.memo(function(){const{theme:e}=(0,c.u)(),n=(0,oe.A)(),{visibilityMode:t,setVisibilityMode:r,usingCustomVisibility:o,allRunsHidden:i}=k();return(0,p.FD)(d.DropdownMenu.Root,{modal:!1,children:[(0,p.Y)(d.DropdownMenu.Trigger,{asChild:!0,children:(0,p.Y)("button",{css:ae.actionButton(e),"data-testid":"eval-runs-visibility-column-header","aria-label":n.formatMessage({id:"wKXJ6U",defaultMessage:"Toggle visibility of evaluation runs"}),children:t===Y.oy.HIDEALL||t===Y.oy.HIDE_FINISHED_RUNS||i?(0,p.Y)(d.VisibleOffIcon,{}):(0,p.Y)(d.VisibleIcon,{})})}),(0,p.Y)(d.DropdownMenu.Content,{children:(0,p.FD)(d.DropdownMenu.RadioGroup,{componentId:"mlflow.eval-runs.visibility-mode-selector",value:t,onValueChange:e=>r(e),children:[(0,p.FD)(d.DropdownMenu.RadioItem,{value:Y.oy.FIRST_10_RUNS,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"vEuvEt",defaultMessage:"Show first 10"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:Y.oy.FIRST_20_RUNS,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"LK+UHk",defaultMessage:"Show first 20"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:Y.oy.SHOWALL,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"WDqWWa",defaultMessage:"Show all runs"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:Y.oy.HIDEALL,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"QH2RJZ",defaultMessage:"Hide all runs"})]}),(0,p.FD)(d.DropdownMenu.RadioItem,{value:Y.oy.HIDE_FINISHED_RUNS,children:[(0,p.Y)(d.DropdownMenu.ItemIndicator,{children:o?(0,p.Y)(d.DashIcon,{}):null}),(0,p.Y)(m.A,{id:"Q7MSrQ",defaultMessage:"Hide finished runs"})]})]})})]})}),ae={actionButton:e=>({background:"transparent",border:"none",cursor:"pointer",padding:0,margin:0,display:"inline-flex",alignItems:"center",justifyContent:"flex-start",verticalAlign:"text-bottom",minWidth:24,minHeight:24,svg:{width:e.general.iconFontSize,height:e.general.iconFontSize,cursor:"pointer",color:e.colors.textPrimary,flexShrink:0}})};let se=function(e){return e.checkbox="checkbox",e.visibility="visibility",e.runName="run_name",e.dataset="dataset",e.modelVersion="model_version",e.createdAt="created_at",e}({}),le=function(e){return e.ATTRIBUTE="attribute",e.METRIC="metric",e.PARAM="param",e.TAG="tag",e}({});const ue=new Set([se.checkbox,se.visibility,se.runName]),de={[se.checkbox]:!0,[se.visibility]:!0,[se.runName]:!0,[se.createdAt]:!0,[se.dataset]:!0,[se.modelVersion]:!0},ce={[se.checkbox]:(0,y.zR)({id:"TQ3N+4",defaultMessage:"Select"}),[se.visibility]:(0,y.zR)({id:"6ZhLfu",defaultMessage:"Visibility"}),[se.runName]:(0,y.zR)({id:"TWnsnV",defaultMessage:"Run Name"}),[se.createdAt]:(0,y.zR)({id:"2OrFCG",defaultMessage:"Created at"}),[se.dataset]:(0,y.zR)({id:"SQUVnW",defaultMessage:"Dataset"}),[se.modelVersion]:(0,y.zR)({id:"CZXHRi",defaultMessage:"Version"})},me={[le.ATTRIBUTE]:(0,y.zR)({id:"4HKr3y",defaultMessage:"Attributes"}),[le.METRIC]:(0,y.zR)({id:"zZCBR9",defaultMessage:"Metrics"}),[le.PARAM]:(0,y.zR)({id:"mY6f0y",defaultMessage:"Params"}),[le.TAG]:(0,y.zR)({id:"HbC1a1",defaultMessage:"Tags"})};var pe=t(90061),he=t(43617),ge=t(1475);var fe={name:"ti75j2",styles:"margin:0"},ve={name:"14sng3t",styles:"max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis"};const ye=({groupKey:e,groupValue:n})=>{const{theme:t}=(0,c.u)();return(0,p.Y)(b.T,{content:e+": "+n,componentId:"mlflow.eval-runs.group-tag",children:(0,p.FD)(d.Tag,{css:fe,componentId:"mlflow.eval-runs.group-tag",children:[(0,p.FD)(c.T.Text,{bold:!0,css:(0,r.AH)({maxWidth:100,marginRight:t.spacing.xs,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},""),children:[e,":"]}),(0,p.Y)(c.T.Text,{css:ve,children:n})]})})},be=({groupValues:e})=>{const n=e.groupByData;return e.mode===ge.uq.Dataset?(0,p.Y)(ye,{groupKey:"Dataset",groupValue:String(e.value)},n):(0,p.Y)(ye,{groupKey:n,groupValue:String(e.value)},n)};var Re={name:"ozd7xs",styles:"flex-shrink:0"};const we=a.memo(({row:e,isActive:n,isGrouped:t,enableImprovedComparison:o})=>{const{theme:i}=(0,c.u)(),s=(0,R.Zp)(),l=(0,a.useCallback)(()=>{if(o&&"info"in e.original){const{experimentId:n,runUuid:t}=e.original.info;s(C.Ay.getRunPageTabRoute(n,t,E.N3.EVALUATIONS))}},[o,s,e.original]);return"groupValues"in e.original?(0,p.Y)(d.TableRow,{className:"eval-runs-table-row",children:(0,p.Y)(d.TableCell,{children:(0,p.FD)("div",{css:(0,r.AH)({display:"flex",alignItems:"center",gap:i.spacing.sm},""),children:[(0,p.Y)(c.B,{componentId:"mlflow.eval-runs.group-expand-button",size:"small",css:Re,icon:e.getIsExpanded()?(0,p.Y)(d.ChevronDownIcon,{}):(0,p.Y)(c.o,{}),onClick:e.getToggleExpandedHandler()}),(0,p.Y)(c.T.Text,{bold:!0,children:(0,p.Y)(m.A,{id:"UWHfmZ",defaultMessage:"Group:"})}),e.original.groupValues.map(e=>(0,p.Y)(be,{groupValues:e},e.groupByData))]})})},e.id):(0,p.Y)(d.TableRow,{className:"eval-runs-table-row",onClick:o?l:void 0,css:(0,r.AH)({cursor:o?"pointer":void 0,marginLeft:o&&t&&e.depth>0?i.spacing.lg:void 0},""),children:e.getVisibleCells().map(e=>{var t;return(0,p.Y)(d.TableCell,{css:[null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.styles,{backgroundColor:n?i.colors.actionDefaultBackgroundHover:"transparent"},""],children:(0,he.Kv)(e.column.columnDef.cell,e.getContext())},e.id)})},e.id)},(e,n)=>e.isActive===n.isActive&&e.isSelected===n.isSelected&&e.columns===n.columns&&e.isExpanded===n.isExpanded&&e.isHidden===n.isHidden&&e.isGrouped===n.isGrouped&&e.enableImprovedComparison===n.enableImprovedComparison);var Ce={name:"82a6rk",styles:"flex:1"};const xe=(0,a.forwardRef)(({data:e,uniqueColumns:n,selectedColumns:t,selectedRunUuid:r,setSelectedRunUuid:o,isLoading:i,hasNextPage:s,rowSelection:l,setRowSelection:u,setSelectedDatasetWithRun:c,setIsDrawerOpen:h,viewMode:g,onScroll:f,isGrouped:y,enableImprovedComparison:b},R)=>{const[w,C]=(0,a.useState)([]),[x,S]=(0,a.useState)(!0),{isRowHidden:I}=k(),D=(0,a.useMemo)(()=>{const e=(e=>{const n=[{id:se.checkbox,cell:O,enableResizing:!1,enableSorting:!1,size:32,meta:{styles:{minWidth:32,maxWidth:32}}}];e===te.CHARTS&&n.push({id:se.visibility,header:ie,cell:ee,enableResizing:!1,enableSorting:!1,size:40,meta:{styles:{minWidth:40,maxWidth:40,padding:"0 4px"}}});const t=[{id:se.runName,header:()=>(0,p.Y)(m.A,{...ce[se.runName]}),cell:N,enableResizing:!0,meta:{styles:{minWidth:100}}},{id:se.createdAt,header:e=>(0,p.Y)(Z,{...e,title:(0,p.Y)(m.A,{...ce[se.createdAt]})}),accessorFn:e=>{if(!("subRuns"in e))return e.info.startTime},cell:X,enableSorting:!0,sortingFn:"alphanumeric",enableResizing:!0,meta:{styles:{minWidth:100}}},{id:se.dataset,header:()=>(0,p.Y)(m.A,{...ce[se.dataset]}),cell:P,enableResizing:!0,meta:{styles:{minWidth:100}}},{id:se.modelVersion,header:()=>(0,p.Y)(m.A,{...ce[se.modelVersion]}),cell:j,enableResizing:!0,meta:{styles:{minWidth:100}}}];return[...n,...t]})(g);return n.forEach(n=>{e.push({id:n,accessorFn:e=>{if(!("subRuns"in e))return((e,n)=>{var t,r,o,i,a,s,l,u,d,c,m,p,h;const{columnType:g,key:f}=null!==(t=M(e))&&void 0!==t?t:{};if(f)switch(g){case le.METRIC:return null!==(r=null===(o=n.data)||void 0===o||null===(i=o.metrics)||void 0===i||null===(a=i.find(e=>e.key===f))||void 0===a?void 0:a.value)&&void 0!==r?r:void 0;case le.PARAM:return null!==(s=null===(l=n.data)||void 0===l||null===(u=l.params)||void 0===u||null===(d=u.find(e=>e.key===f))||void 0===d?void 0:d.value)&&void 0!==s?s:void 0;case le.TAG:return null!==(c=null===(m=n.data)||void 0===m||null===(p=m.tags)||void 0===p||null===(h=p.find(e=>e.key===f))||void 0===h?void 0:h.value)&&void 0!==c?c:void 0;default:return}})(n,e)},cell:Q,header:Z,enableSorting:!0,sortingFn:"alphanumeric",meta:{styles:{minWidth:100,maxWidth:200}}})}),e.filter(e=>{var n;return t[null!==(n=e.id)&&void 0!==n?n:""]})},[t,n,g]),Y=(0,v.L)("mlflow/server/js/src/experiment-tracking/pages/experiment-evaluation-runs/ExperimentEvaluationRunsTable.tsx",{columns:D,data:e,getCoreRowModel:(0,pe.HT)(),getRowId:(e,n)=>"info"in e?e.info.runUuid:e.groupKey,enableSorting:!0,onSortingChange:C,getSortedRowModel:(0,pe.h5)(),enableColumnResizing:!1,enableExpanding:!0,getExpandedRowModel:(0,pe.D0)(),getSubRows:e=>{if("subRuns"in e)return e.subRuns},getRowCanExpand:e=>{var n;return Boolean(null===(n=e.subRows)||void 0===n?void 0:n.length)},onExpandedChange:S,enableRowSelection:e=>!("subRuns"in e.original),meta:{setSelectedRunUuid:o,setSelectedDatasetWithRun:c,setIsDrawerOpen:h},onRowSelectionChange:u,state:{rowSelection:l,sorting:w,expanded:x}});return(0,p.FD)(d.Table,{css:Ce,scrollable:!0,onScroll:f,ref:R,children:[(0,p.Y)(d.TableRow,{isHeader:!0,children:Y.getLeafHeaders().map(e=>{var n;return(0,p.Y)(d.TableHeader,{css:null===(n=e.column.columnDef.meta)||void 0===n?void 0:n.styles,sortable:e.column.getCanSort(),sortDirection:e.column.getIsSorted(),onToggleSort:e.column.getToggleSortingHandler(),componentId:"mlflow.eval-runs.header",header:e,column:e.column,children:(0,he.Kv)(e.column.columnDef.header,e.getContext())},e.id)})}),!i&&Y.getRowModel().rows.map(e=>{const n="info"in e.original&&e.original.info.runUuid===r,t="info"in e.original?e.original.info.status:void 0;return(0,p.Y)(we,{row:e,isActive:n,isSelected:l[e.id],isExpanded:e.getIsExpanded(),isHidden:I(e.id,e.index,t),columns:D,isGrouped:y,enableImprovedComparison:b},e.id)}),(i||s)&&(0,p.Y)(d.TableSkeletonRows,{table:Y})]})});var Se=t(25637),Ie=t(42595),De=t(33702),Me=t(8740),Ye=t(76118),Ae=t(18585);const Te=({groupByConfig:e,setGroupByConfig:n,runs:t})=>{const r=t.some(e=>{var n,t,r;return(null!==(n=null===(t=e.inputs)||void 0===t||null===(r=t.datasetInputs)||void 0===r?void 0:r.length)&&void 0!==n?n:0)>0}),{uniqueParams:o,uniqueTags:i}=(0,a.useMemo)(()=>{const e=new Set,n=new Set;for(const s of t){for(const n of null!==(r=null===(o=s.data)||void 0===o?void 0:o.params)&&void 0!==r?r:[]){var r,o;e.add(n.key)}for(const e of null!==(i=null===(a=s.data)||void 0===a?void 0:a.tags)&&void 0!==i?i:[]){var i,a;(0,H.oD)(e.key)&&n.add(e.key)}}return{uniqueParams:e,uniqueTags:n}},[t]),s=(t,r)=>{var o;const i=null!==(o=null===e||void 0===e?void 0:e.groupByKeys)&&void 0!==o?o:[],a=new Set(i);if((0,Ae.sd)(e,t,r))for(const e of a)e.mode===t&&e.groupByData===r&&a.delete(e);else a.add({mode:t,groupByData:r});var s;0===a.size?n(null):n({aggregateFunction:null!==(s=null===e||void 0===e?void 0:e.aggregateFunction)&&void 0!==s?s:ge.it.Average,groupByKeys:Array.from(a)})};return(0,p.FD)(d.DialogCombobox,{componentId:"mlflow.eval-runs.table-column-selector",label:"Group by",multiSelect:!0,children:[(0,p.Y)(d.DialogComboboxTrigger,{}),(0,p.Y)(d.DialogComboboxContent,{children:(0,p.FD)(d.DialogComboboxOptionList,{children:[r&&(0,p.FD)(p.FK,{children:[(0,p.Y)(d.DialogComboboxSectionHeader,{children:(0,p.Y)(m.A,{id:"BfMFME",defaultMessage:"Attributes"})}),(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:"dataset",checked:(0,Ae.sd)(e,ge.uq.Dataset,"dataset"),onChange:()=>{s(ge.uq.Dataset,"dataset")}},"dataset")]}),o.size>0&&(0,p.FD)(p.FK,{children:[(0,p.Y)(d.DialogComboboxSectionHeader,{children:(0,p.Y)(m.A,{id:"lS7kq2",defaultMessage:"Parameters"})}),Array.from(o).map(n=>(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:n,checked:(0,Ae.sd)(e,ge.uq.Param,n),onChange:()=>{s(ge.uq.Param,n)}},n))]}),i.size>0&&(0,p.FD)(p.FK,{children:[(0,p.Y)(d.DialogComboboxSectionHeader,{children:(0,p.Y)(m.A,{id:"sEVVSd",defaultMessage:"Tags"})}),Array.from(i).map(n=>(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:n,checked:(0,Ae.sd)(e,ge.uq.Tag,n),onChange:()=>{s(ge.uq.Tag,n)}},n))]})]})})]})};var ke=t(61060),Ee=t(12803);const Fe=({rowSelection:e,setRowSelection:n,refetchRuns:t,onCompare:r,selectedRunUuid:o,compareToRunUuid:i,enableImprovedComparison:s})=>{const[l,u]=(0,a.useState)(!1),h=(0,a.useMemo)(()=>Object.entries(e).filter(([e,n])=>n).map(([e])=>e),[e]),{mutate:g,isLoading:f}=(({onSuccess:e,onError:n})=>{const{mutate:t,isLoading:r}=(0,ke.n)({mutationFn:({runUuids:e})=>Promise.all(e.map(e=>Ee.x.deleteRun({run_id:e}))),onSuccess:e,onError:n});return{mutate:t,isLoading:r}})({onSuccess:()=>{t(),n({}),u(!1)}}),v=(0,a.useCallback)(()=>{g({runUuids:h})},[g,h]),y=(0,a.useCallback)(()=>{2===h.length&&r&&r(h[0],h[1])},[r,h]),R=2===h.length,w=(0,a.useMemo)(()=>{if(!o||!i||2!==h.length)return!1;const e=new Set([o,i]);return h.every(n=>e.has(n))},[o,i,h]),C=!R||w,x=0===h.length;return(0,p.FD)(p.FK,{children:[(0,p.FD)(d.DropdownMenu.Root,{children:[(0,p.Y)(d.DropdownMenu.Trigger,{asChild:!0,children:(0,p.Y)(c.B,{type:"primary",componentId:"mlflow.eval-runs.actions-button",disabled:x,endIcon:(0,p.Y)(d.ChevronDownIcon,{}),children:(0,p.Y)(m.A,{id:"N/tNrE",defaultMessage:"Actions"})})}),(0,p.FD)(d.DropdownMenu.Content,{children:[!s&&(0,p.Y)(d.DropdownMenu.Item,{componentId:"mlflow.eval-runs.actions.compare",onClick:y,disabled:C,disabledReason:(0,p.Y)(m.A,{id:"Ub+VQh",defaultMessage:"Please select 2 runs to compare"}),children:(0,p.Y)(m.A,{id:"2igs1f",defaultMessage:"Compare"})}),(0,p.Y)(d.DropdownMenu.Item,{componentId:"mlflow.eval-runs.actions.delete",onClick:()=>u(!0),children:(0,p.Y)(m.A,{id:"7tlSUw",defaultMessage:"Delete runs"})})]})]}),(0,p.Y)(b.d,{componentId:"mlflow.eval-runs.runs-delete-modal",visible:l,onOk:v,okButtonProps:{danger:!0,loading:f},okText:(0,p.Y)(m.A,{id:"EBwDIg",defaultMessage:"Delete"}),onCancel:()=>{u(!1)},cancelText:(0,p.Y)(m.A,{id:"2+EUFB",defaultMessage:"Cancel"}),confirmLoading:f,title:(0,p.Y)(m.A,{id:"mmz4aA",defaultMessage:"Delete {numRuns, plural, =1 {1 run} other {# runs}}",values:{numRuns:h.length}}),children:(0,p.Y)(m.A,{id:"xIP8WW",defaultMessage:"Are you sure you want to delete these runs?"})})]})};const He=e=>{const n=new Set,t=new Set,r=[];return e.forEach(e=>{var o,i,a;null===(o=e.data.metrics)||void 0===o||o.forEach(e=>{n.add(e.key)}),null===(i=e.data.params)||void 0===i||i.forEach(e=>{t.add(e.key)});const s={};null===(a=e.data.tags)||void 0===a||a.forEach(e=>{s[e.key]={key:e.key,value:e.value}}),r.push(s)}),{metricKeyList:Array.from(n),paramKeyList:Array.from(t),tagsList:r}};var Ue={name:"ozd7xs",styles:"flex-shrink:0"},Le={name:"ovk77c",styles:"min-width:0"},Oe={name:"ozd7xs",styles:"flex-shrink:0"};const Be=({rowSelection:e,setRowSelection:n,refetchRuns:t,isFetching:o,runs:i,searchRunsError:s,searchFilter:l,setSearchFilter:u,selectedColumns:h,setSelectedColumns:g,groupByConfig:f,setGroupByConfig:v,viewMode:y,setViewMode:R,onCompare:w,selectedRunUuid:C,compareToRunUuid:x,isComparisonMode:S,setIsComparisonMode:I,enableImprovedComparison:D})=>{const Y=(0,oe.A)(),{theme:A}=(0,c.u)(),T=Object.entries(e).filter(([e,n])=>n).map(([e])=>e),k=(0,a.useMemo)(()=>(0,Ye.groupBy)(Object.entries(h),([e])=>{var n,t;return null!==(n=null===(t=M(e))||void 0===t?void 0:t.columnType)&&void 0!==n?n:le.ATTRIBUTE}),[h]),E=2===T.length,F=(0,a.useCallback)(()=>{2===T.length&&(w(T[0],T[1]),I(!0))},[T,w,I]);return(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:A.spacing.sm},""),children:[(0,p.FD)("div",{css:(0,r.AH)({display:"flex",gap:A.spacing.sm},""),children:[(0,p.FD)(d.SegmentedControlGroup,{name:"mlflow.eval-runs.page-mode-selector",componentId:"mlflow.eval-runs.page-mode-selector",value:y,css:Ue,children:[(0,p.Y)(d.SegmentedControlButton,{value:te.TRACES,icon:(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.traces-mode-toggle-tooltip",content:(0,p.Y)(m.A,{id:"nIk08y",defaultMessage:"Trace view"}),delayDuration:0,children:(0,p.Y)(d.ListBorderIcon,{})}),onClick:()=>null===R||void 0===R?void 0:R(te.TRACES)}),(0,p.Y)(d.SegmentedControlButton,{value:te.CHARTS,icon:(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.charts-mode-toggle-tooltip",content:(0,p.Y)(m.A,{id:"RUju4k",defaultMessage:"Charts"}),delayDuration:0,children:(0,p.Y)(d.ChartLineIcon,{})}),onClick:()=>null===R||void 0===R?void 0:R(te.CHARTS)})]}),(0,p.Y)(Me.D,{css:Le,runsData:He(i),searchFilter:l,onSearchFilterChange:u,onClear:()=>u(""),requestError:s}),(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.table-refresh-button.tooltip",content:Y.formatMessage({id:"ckfi1K",defaultMessage:"Refresh evaluation runs"}),children:(0,p.Y)(c.B,{componentId:"mlflow.eval-runs.table-refresh-button",icon:(0,p.Y)(d.RefreshIcon,{}),onClick:t,loading:o,css:Oe,disabled:o,"aria-label":Y.formatMessage({id:"rcdaen",defaultMessage:"Refresh evaluation runs"})})})]}),(0,p.FD)("div",{css:(0,r.AH)({display:"flex",gap:A.spacing.sm},""),children:[(0,p.FD)(d.DialogCombobox,{componentId:"mlflow.eval-runs.table-column-selector",label:"Columns",multiSelect:!0,children:[(0,p.Y)(d.DialogComboboxTrigger,{}),(0,p.Y)(d.DialogComboboxContent,{children:(0,p.Y)(d.DialogComboboxOptionList,{children:Object.entries(k).map(([e,n])=>{if(!n.length)return null;const t=me[e];return(0,p.FD)(p.FK,{children:[(0,p.Y)(b.S,{size:"xs"}),(0,p.Y)(d.DialogComboboxSectionHeader,{children:t?Y.formatMessage(t):e}),n.map(([e,n])=>{var t,r;const o=ce[e],i=o?Y.formatMessage(o):null!==(t=null===(r=M(e))||void 0===r?void 0:r.key)&&void 0!==t?t:e;return ue.has(e)?null:(0,p.Y)(d.DialogComboboxOptionListCheckboxItem,{value:e,onChange:()=>{const t={...h};t[e]=!n,g(t)},checked:n,children:i},e)})]})})})})]}),(0,p.Y)(Te,{groupByConfig:f,setGroupByConfig:v,runs:i}),D&&y!==te.CHARTS&&(0,p.Y)(b.T,{componentId:"mlflow.eval-runs.compare-button.tooltip",content:E?(0,p.Y)(m.A,{id:"Z+tEhr",defaultMessage:"Compare selected runs"}):(0,p.Y)(m.A,{id:"Hay/ss",defaultMessage:"Select up to 2 runs to compare"}),children:(0,p.Y)(c.B,{componentId:"mlflow.eval-runs.compare-button",onClick:F,disabled:!E,children:(0,p.Y)(m.A,{id:"6arejB",defaultMessage:"Compare"})})}),(0,p.Y)(Fe,{rowSelection:e,setRowSelection:n,refetchRuns:t,onCompare:w,selectedRunUuid:C,compareToRunUuid:x,enableImprovedComparison:D})]})]})};var Ne=t.p+"static/media/eval-runs-empty.5b96bbb9a4c5dc6b413000491892bb6f.svg",ze=t(11522),_e=t(48292);const qe="selectedRunUuid";var Pe=t(78171),Ve=t(19112);const We=e=>`import mlflow\nfrom mlflow.genai import datasets, evaluate, scorers\n\nmlflow.set_experiment(experiment_id="${e}")\n\n# Step 1: Define evaluation dataset\neval_dataset = [{\n  "inputs": {\n    "query": "What is MLflow?",\n  }\n}]\n\n# Step 2: Define predict_fn\n# predict_fn will be called for every row in your evaluation\n# dataset. Replace with your app's prediction function.\n# NOTE: The **kwargs to predict_fn are the same as the keys of\n# the \`inputs\` in your dataset.\ndef predict(query):\n  return query + " an answer"\n\n# Step 3: Run evaluation\nevaluate(\n  data=eval_dataset,\n  predict_fn=predict,\n  scorers=scorers.get_all_scorers()\n)\n\n# Results will appear back in this UI`,Ke=({experimentId:e})=>{(0,oe.A)();const{theme:n}=(0,c.u)(),[t,o]=(0,a.useState)(!1),i=(0,p.Y)(m.A,{id:"7BkVQ9",defaultMessage:"Run the following code to start an evaluation."}),s=(0,p.Y)(Ve.z7,{theme:n.isDarkMode?"duotoneDark":"light",language:"python",children:We(e)});return(0,p.FD)(p.FK,{children:[(0,p.Y)(c.B,{componentId:"mlflow.eval-runs.start-run-button",icon:(0,p.Y)(d.ChartLineIcon,{}),onClick:()=>o(!0),children:(0,p.Y)(m.A,{id:"cMa3hp",defaultMessage:"Run evaluation"})}),(0,p.Y)(b.d,{componentId:"mlflow.eval-runs.start-run-modal",title:(0,p.Y)(m.A,{id:"3QGkg9",defaultMessage:"Run evaluation"}),visible:t,okText:"Discard",footer:null,onCancel:()=>o(!1),children:(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:n.spacing.sm},""),children:[(0,p.Y)(c.T.Text,{children:i}),s]})})]})},je=e=>e.mode===ge.uq.Dataset?`Dataset: ${e.value}`:`${e.groupByData} (${e.mode}): ${e.value}`,Qe=(e,n)=>{var t,r,o,i,a,s,l,u,d,c,m;const p=n.groupByKeys,h=[];for(const g of p)switch(g.mode){case ge.uq.Dataset:h.push({mode:ge.uq.Dataset,groupByData:"dataset",value:null!==(t=null===(r=e.inputs)||void 0===r||null===(o=r.datasetInputs)||void 0===o||null===(i=o[0])||void 0===i||null===(a=i.dataset)||void 0===a?void 0:a.digest)&&void 0!==t?t:null});break;case ge.uq.Param:const n=null===(s=e.data)||void 0===s||null===(l=s.params)||void 0===l?void 0:l.find(e=>e.key===g.groupByData);h.push({mode:ge.uq.Param,groupByData:g.groupByData,value:null!==(u=null===n||void 0===n?void 0:n.value)&&void 0!==u?u:null});break;case ge.uq.Tag:const p=null===(d=e.data)||void 0===d||null===(c=d.tags)||void 0===c?void 0:c.find(e=>e.key===g.groupByData);h.push({mode:ge.uq.Tag,groupByData:g.groupByData,value:null!==(m=null===p||void 0===p?void 0:p.value)&&void 0!==m?m:null})}return h};var Ge=t(35286),$e=t(29757),Ze=t(51120),Xe=t(95379),Je=t(86133);const en=(e,n=1)=>`experiment-evaluation-runs-charts-ui-state-v${n}-${e}`,nn=()=>({compareRunCharts:void 0,compareRunSections:void 0,autoRefreshEnabled:!1,isAccordionReordered:!1,chartsSearchFilter:"",globalLineChartConfig:void 0,isDirty:!1}),tn=(e,n)=>{if("UPDATE"===n.type)return{...n.stateSetter(e),isDirty:!0};if("METRICS_UPDATED"===n.type){const{compareRunCharts:t,compareRunSections:r}=(e=>{const n=(0,Ye.compact)((0,Ye.uniq)(e.map(e=>e.includes("/")?(0,Ye.first)(e.split("/")):null))),t=e.map(e=>{const n=e.includes("/")?(0,Ye.first)(e.split("/")):null;return{deleted:!1,type:Je.zL.BAR,uuid:`autogen-${e}`,metricSectionId:n?`autogen-${n}`:"default",isGenerated:!0,metricKey:e,displayName:e}}),r=n.map(e=>({display:!0,name:e,uuid:`autogen-${e}`,isReordered:!1}));return(0,Ye.isEmpty)(r)&&r.push({display:!0,name:"Metrics",uuid:"default",isReordered:!1}),{compareRunCharts:t,compareRunSections:r}})(n.allMetricKeys);return((e,n)=>{var t,r;if((!e.compareRunCharts||!e.compareRunSections||!e.isDirty)&&(n.compareRunCharts.length>0||n.compareRunSections.length>0))return{...e,compareRunCharts:null!==(t=n.compareRunCharts)&&void 0!==t?t:[],compareRunSections:null!==(r=n.compareRunSections)&&void 0!==r?r:[]};const o=n.compareRunCharts.filter(n=>{var t;return!(null!==(t=e.compareRunCharts)&&void 0!==t&&t.find(e=>e.uuid===n.uuid))}),i=n.compareRunSections.filter(n=>{var t;return o.find(e=>e.metricSectionId===n.uuid)&&!(null!==(t=e.compareRunSections)&&void 0!==t&&t.find(e=>e.uuid===n.uuid))});return i.length>0||o.length>0?{...e,compareRunCharts:e.compareRunCharts?[...e.compareRunCharts,...o]:n.compareRunCharts,compareRunSections:e.compareRunSections?[...e.compareRunSections,...i]:n.compareRunSections}:e})(e,{compareRunCharts:t,compareRunSections:r})}return"INITIALIZE"===n.type&&n.initialConfig?n.initialConfig:e},rn=(e,n)=>{const[t,r]=(0,a.useReducer)(tn,void 0,nn),[o,i]=(0,a.useState)(!0);(0,a.useEffect)(()=>{i(!0),(async e=>{const n=localStorage.getItem(en(e));if(n)try{return JSON.parse(n)}catch{return}})(n).then(e=>{r({type:"INITIALIZE",initialConfig:e}),i(!1)})},[n]),(0,a.useEffect)(()=>{o||r({type:"METRICS_UPDATED",allMetricKeys:e})},[e,o]),(0,a.useEffect)(()=>{t.isDirty&&(async(e,n)=>{localStorage.setItem(en(e),JSON.stringify(n))})(n,t)},[n,t]);const s=(0,a.useCallback)(e=>r({type:"UPDATE",stateSetter:e}),[]);return{chartUIState:t,updateUIState:s,loading:o}};var on=t(33972),an=t(55600),sn=t(94119);const ln=[Je.zL.LINE,Je.zL.BAR,Je.zL.CONTOUR,Je.zL.DIFFERENCE,Je.zL.PARALLEL,Je.zL.SCATTER],un=({runs:e=[],chartUIState:n})=>{var t;const r=(0,x.LE)(),{isRowHidden:o}=k(),i=(0,a.useMemo)(()=>e.filter(e=>e.info).map((e,n)=>{var t,i,a;const s=(0,Ye.keyBy)(null===(t=e.data)||void 0===t?void 0:t.metrics,"key"),l=(0,Ye.keyBy)(null===(i=e.data)||void 0===i?void 0:i.params,"key"),u=(0,Ye.keyBy)(null===(a=e.data)||void 0===a?void 0:a.tags,"key");return{displayName:e.info.runName,images:{},metrics:s,params:l,tags:u,uuid:e.info.runUuid,color:r(e.info.runUuid),runInfo:e.info,hidden:o(e.info.runUuid,n,e.info.status)}}),[e,o,r]),s=(0,a.useMemo)(()=>(0,Ye.uniq)(i.flatMap(e=>Object.keys(e.metrics))),[i]),l=(0,a.useMemo)(()=>(0,Ye.uniq)(i.flatMap(e=>Object.keys(e.params))),[i]),u=(0,Xe.KP)(),d=(0,Xe.iO)(),c=(0,Xe.cA)(),m=(0,Xe.Ez)(),[h,g]=(0,a.useState)(null),f=(0,a.useCallback)(e=>n=>g(Je.i$.getEmptyChartCardByType(n,!1,void 0,e)),[]),v=(0,a.useMemo)(()=>({runs:i}),[i]);return(0,p.Y)("div",{children:(0,p.Y)(Ge.W,{contextData:v,component:sn.X,children:(0,p.FD)($e.c_,{visibleChartCards:n.compareRunCharts,children:[(0,p.Y)(Ze.J,{supportedChartTypes:ln,compareRunSections:n.compareRunSections,compareRunCharts:n.compareRunCharts,reorderCharts:d,insertCharts:c,chartData:i,startEditChart:g,removeChart:u,addNewChartCard:f,search:null!==(t=n.chartsSearchFilter)&&void 0!==t?t:"",groupBy:null,setFullScreenChart:()=>{},autoRefreshEnabled:n.autoRefreshEnabled,hideEmptyCharts:!1,globalLineChartConfig:n.globalLineChartConfig}),h&&(0,p.Y)(an.z,{chartRunData:i,metricKeyList:s,paramKeyList:l,config:h,onSubmit:e=>{m({...e,displayName:void 0}),g(null)},onCancel:()=>g(null),groupBy:null,supportedChartTypes:ln})]})})})},dn=({runs:e=[],experimentId:n})=>{const t=(0,a.useMemo)(()=>{const n=e.flatMap(e=>{var n,t;return(null===(n=e.data)||void 0===n||null===(t=n.metrics)||void 0===t?void 0:t.map(e=>e.key))||[]});return Array.from(new Set(n))},[e]),r=(0,on.i)(()=>t,[t]),{chartUIState:o,loading:i,updateUIState:s}=rn(r,n);return i?(0,p.Y)(d.TableSkeleton,{lines:5}):(0,p.Y)(Xe.oB,{updateChartsUIState:s,children:(0,p.Y)(un,{runs:e,chartUIState:o})})};var cn=t(54871);var mn={name:"1h0bf8r",styles:"body, :host{user-select:none;}"},pn={name:"1752fna",styles:"max-width:min(100%, 600px);text-align:center"},hn={name:"1bmnxg7",styles:"white-space:nowrap"},gn={name:"zt9k2r",styles:"max-width:100%;max-height:200px"},fn={name:"pjvwn7",styles:"display:flex;flex-direction:column;flex:1;min-height:0px"},vn={name:"n56zw6",styles:"display:flex;flex-direction:row;flex:1;min-height:0px"},yn={name:"5ob2ly",styles:"display:flex;position:relative"};const bn=()=>{const{experimentId:e}=(0,R.g)(),{theme:n}=(0,c.u)(),[t,o]=(0,a.useState)(432),[l,u]=(0,a.useState)(!1),[d,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)(""),[v,y]=(0,a.useState)(),[b,w]=(0,a.useState)(!1),[C,x]=(0,a.useState)(de),S=(0,F.iA)(),[I,M]=(0,a.useState)(S?{aggregateFunction:ge.it.Average,groupByKeys:[{mode:ge.uq.Dataset,groupByData:"dataset"}]}:null),[Y,A]=(0,a.useState)(!1),{viewMode:k,setViewMode:E}=(()=>{const[e,n]=(0,R.ok)();return{viewMode:(0,ne.SK)(te,e.get(re),te.TRACES),setViewMode:e=>{n(n=>{const t=new URLSearchParams(n);return t.set(re,e),t})}}})(),[U,L]=(()=>{var e;const[n,t]=(0,R.ok)(),r=null!==(e=n.get(qe))&&void 0!==e?e:void 0,o=(0,a.useCallback)(e=>{t(n=>void 0===e?(n.delete(qe),n):(n.set(qe,e),n),{replace:!0})},[t]);return[r,o]})(),[O,B]=(0,Pe.Y)(),[,N]=(0,R.ok)();i()(e,"Experiment ID must be defined");const[z,_]=(0,a.useState)({});(0,cn.Gt)("selectedRunIds",z);const{data:q,isLoading:P,isFetching:V,error:W,fetchNextPage:K,hasNextPage:j,refetch:Q}=(0,s.X)({experimentId:e,enabled:!0,filter:g}),G=(0,a.useMemo)(()=>{var e;return null!==(e=null===q||void 0===q?void 0:q.map(e=>e.info.runUuid))&&void 0!==e?e:[]},[q]);S||null===q||void 0===q||!q.length||U&&G.includes(U)||L(q[0].info.runUuid);const $=(0,a.useMemo)(()=>Object.entries(z).filter(([e,n])=>n).map(([e])=>e),[z]),Z=(0,a.useRef)(!1);(0,a.useEffect)(()=>{if(S&&!Z.current&&U&&null!==q&&void 0!==q&&q.length&&G.includes(U)){Z.current=!0;const e={[U]:!0};O&&G.includes(O)&&(e[O]=!0,A(!0)),_(e)}},[S,U,O,q,G,A]),(0,a.useEffect)(()=>{if(S&&Y)if(0===$.length)A(!1),L(void 0),B(void 0);else if(1===$.length){const e=$[0];U!==e&&L(e),O&&B(void 0)}else if($.length>=2){U&&$.includes(U)||L($[0]);const e=$.find(e=>e!==U);e&&e!==O&&B(e)}},[S,Y,$,U,O,L,B,A]);const X=(0,a.useMemo)(()=>{const e=new Set,n=new Set,t=new Set;for(const a of null!==q&&void 0!==q?q:[]){for(const n of null!==(r=a.data.metrics)&&void 0!==r?r:[]){var r;e.add(n.key)}for(const e of null!==(o=a.data.params)&&void 0!==o?o:[]){var o;n.add(e.key)}for(const e of null!==(i=a.data.tags)&&void 0!==i?i:[]){var i;(0,H.oD)(e.key)&&t.add(e.key)}}return[...Array.from(e).map(e=>D(le.METRIC,e)),...Array.from(n).map(e=>D(le.PARAM,e)),...Array.from(t).map(e=>D(le.TAG,e))]},[q]),J=(0,a.useMemo)(()=>Object.keys(de),[]),ee=(0,a.useMemo)(()=>Object.keys(C).filter(e=>!J.includes(e)),[J,C]);if((0,a.useMemo)(()=>(0,Ye.xor)(ee,X),[ee,X]).length>0){const e=X.filter(e=>e.startsWith(le.METRIC+".")),n=S?new Set(e.slice(0,5)):new Set(e);x({...de,...(0,Ye.mapValues)((0,Ye.keyBy)(X),(e,t)=>n.has(t))})}const oe=0===G.length&&!g&&!P,ie=((e,n)=>{if(!n)return e;const t={};for(const o of e){const e=Qe(o,n),r=e.map(je).join(", ");t[r]||(t[r]={groupValues:e,subRuns:[]}),t[r].subRuns.push(o)}const r=[];return Object.entries(t).forEach(([e,{groupValues:n,subRuns:t}])=>{const o={groupKey:e,groupValues:n,subRuns:t};r.push(o)}),r})(null!==q&&void 0!==q?q:[],I),ae=(0,a.useCallback)((e,n)=>{N(t=>(t.set("selectedRunUuid",e),t.set("compareToRunUuid",n),t),{replace:!0})},[N]),se=(0,a.useRef)(null),ue=(0,a.useCallback)(e=>{if(e){const{scrollHeight:n,scrollTop:t,clientHeight:r}=e;n-t-r<100&&!V&&j&&K()}},[K,V,j]);(0,a.useEffect)(()=>{ue(se.current)},[ue]);const ce=()=>(0,p.Y)(Be,{runs:null!==q&&void 0!==q?q:[],refetchRuns:Q,isFetching:V||P,searchRunsError:W,searchFilter:g,setSearchFilter:f,rowSelection:z,setRowSelection:_,selectedColumns:C,setSelectedColumns:x,groupByConfig:I,setGroupByConfig:M,viewMode:k,setViewMode:E,onCompare:ae,selectedRunUuid:U,compareToRunUuid:O,isComparisonMode:Y,setIsComparisonMode:A,enableImprovedComparison:S}),me=()=>{var e;return(0,p.Y)(xe,{data:ie,uniqueColumns:X,selectedColumns:C,selectedRunUuid:S&&Y&&k===te.TRACES?U:void 0,setSelectedRunUuid:e=>{L(e),B(void 0)},isLoading:P,hasNextPage:null!==j&&void 0!==j&&j,rowSelection:z,setRowSelection:_,setSelectedDatasetWithRun:y,setIsDrawerOpen:w,viewMode:k,onScroll:e=>ue(e.currentTarget),ref:se,isGrouped:Boolean(null===I||void 0===I||null===(e=I.groupByKeys)||void 0===e?void 0:e.length),enableImprovedComparison:S})},pe=()=>(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flex:1,flexDirection:"column",justifyContent:"center",alignItems:"center",marginTop:n.spacing.lg,paddingLeft:n.spacing.md,maxWidth:"100%"},""),children:[(0,p.Y)(c.T.Title,{level:3,color:"secondary",children:(0,p.Y)(m.A,{id:"050N3C",defaultMessage:"Evaluate and improve the quality, cost, latency of your GenAI app"})}),(0,p.Y)(c.T.Paragraph,{color:"secondary",css:pn,children:(0,p.Y)(m.A,{id:"NKj5Xb",defaultMessage:"Create evaluation datasets in order to iteratively evaluate and improve your app. Run evaluations to check that your fixes are working, and compare quality between app / prompt versions. {learnMoreLink}",values:{learnMoreLink:(0,p.Y)(c.T.Link,{componentId:"mlflow.eval-runs.empty-state.learn-more-link",href:"https://mlflow.org/docs/latest/genai/eval-monitor/quickstart/",css:hn,openInNewTab:!0,children:(0,p.Y)(m.A,{id:"TdTXXf",defaultMessage:"Learn more"})})}})}),(0,p.Y)("img",{css:gn,src:Ne,alt:"No runs found"}),(0,p.Y)("div",{css:(0,r.AH)({display:"flex",gap:n.spacing.sm,marginTop:n.spacing.md},""),children:(0,p.Y)(Ke,{experimentId:e})})]});return S&&!Y&&k!==te.CHARTS?(0,p.Y)(T,{children:(0,p.FD)("div",{css:fn,children:[(0,p.FD)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",gap:n.spacing.sm,flex:1,minHeight:"0px",overflow:"hidden"},""),children:[ce(),oe?pe():me()]}),v&&(0,p.Y)(_e.O,{isOpen:b,setIsOpen:w,selectedDatasetWithRun:v,setSelectedDatasetWithRun:y})]})}):(0,p.Y)(T,{children:(0,p.FD)("div",{css:vn,children:[(0,p.Y)(Se.ResizableBox,{css:yn,style:{flex:`0 0 ${d?0:t}px`},width:t,axis:"x",resizeHandles:["e"],minConstraints:[250,0],handle:(0,p.Y)(Ie.z,{runListHidden:d,updateRunListHidden:e=>{h(!d)}}),onResize:(e,{size:n})=>{d||o(n.width)},onResizeStart:()=>!d&&u(!0),onResizeStop:()=>u(!1),children:(0,p.FD)("div",{css:(0,r.AH)({display:d?"none":"flex",flexDirection:"column",gap:n.spacing.sm,maxWidth:"100%",flex:1,zIndex:0,minHeight:"0px",overflow:"hidden",paddingRight:n.spacing.sm},""),children:[ce(),me()]})}),(0,p.Y)("div",{css:(0,r.AH)({flex:1,display:"flex",borderLeft:`1px solid ${n.colors.border}`,minHeight:"0px",overflowY:"scroll"},""),children:k===te.CHARTS?(0,p.Y)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",flex:1,minHeight:"0px",paddingLeft:n.spacing.sm},""),children:(0,p.Y)(dn,{runs:q,experimentId:e})}):U?(0,p.Y)("div",{css:(0,r.AH)({display:"flex",flexDirection:"column",flex:1,minHeight:"0px",paddingLeft:n.spacing.sm},""),children:(n=>{var t;return k===te.CHARTS?(0,p.Y)(dn,{runs:q,experimentId:e}):(0,p.Y)(De.r,{experimentId:e,runUuid:n,runDisplayName:ze.A.getRunDisplayName(null===q||void 0===q||null===(t=q.find(e=>e.info.runUuid===n))||void 0===t?void 0:t.info,n),setCurrentRunUuid:L,showCompareSelector:!0,showRefreshButton:!0})})(U)}):oe?pe():null}),l&&(0,p.Y)(r.mL,{styles:mn}),v&&(0,p.Y)(_e.O,{isOpen:b,setIsOpen:w,selectedDatasetWithRun:v,setSelectedDatasetWithRun:y})]})})};var Rn=()=>(0,p.Y)(f,{children:(0,p.Y)(bn,{})})},70513:function(e,n,t){t.d(n,{Ef:function(){return l},b3:function(){return s}});var r=t(49708),o=t(61077);t(46709);const i=e=>["GET_LOGGED_MODEL",e],a=async({queryKey:[,e]})=>(0,o.ff)((0,o.we)(`ajax-api/2.0/mlflow/logged-models/${e}`)),s=({loggedModelId:e,enabled:n=!0})=>{const{data:t,isLoading:o,isFetching:s,refetch:l,error:u}=(0,r.I)({queryKey:i(null!==e&&void 0!==e?e:""),queryFn:a,cacheTime:0,refetchOnWindowFocus:!1,retry:!1,enabled:n});return{isLoading:o,isFetching:s,data:null===t||void 0===t?void 0:t.model,refetch:l,error:u}},l=async(e,n=!1)=>{try{return await(0,o.ff)((0,o.we)(`ajax-api/2.0/mlflow/logged-models/${e}`))}catch(t){if(n)return;throw t}}}}]);