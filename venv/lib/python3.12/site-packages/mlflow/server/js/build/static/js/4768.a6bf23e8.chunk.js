"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[4768],{30618:function(e,t,i){i.d(t,{b:function(){return l}});var a=i(90970),n=i(15714),o=i(60719),s=i(49960),r=i(44941),l=(0,a.gu)({chartName:"LineChart",GraphicalChild:n.N,axisComponents:[{axisType:"xAxis",AxisComp:o.W},{axisType:"yAxis",AxisComp:s.h}],formatAxisMap:r.pr})},34768:function(e,t,i){i.d(t,{TraceAssessmentChart:function(){return E}});var a=i(68248),n=i(46709),o=i(27757),s=i(82716),r=i(40724),l=i(66774),c=i(39833),d=i(60719),m=i(49960),u=i(858),v=i(6581),p=i(13240),h=i(30618),g=i(15714),f=i(97245),x=i(16844),y=i(23327),T=i(83110);const C=(e,t)=>{for(let i=0;i<t.length;i++){const a=i===t.length-1;if(e>=t[i].min&&(a?e<=t[i].max:e<t[i].max))return i}return t.length-1};var S=i(69983);function A(e){const{experimentIds:t,startTimeMs:i,endTimeMs:a,timeIntervalSeconds:o,timeBuckets:s}=(0,S.W0)(),r=(0,n.useMemo)(()=>[(0,x.$L)(x.mg.NAME,e)],[e]),{data:l,isLoading:c,error:d}=(0,y.o)({experimentIds:t,startTimeMs:i,endTimeMs:a,viewType:x.mW.ASSESSMENTS,metricName:x.cs.ASSESSMENT_VALUE,aggregations:[{aggregation_type:x.DF.AVG}],filters:r,timeIntervalSeconds:o}),{data:m,isLoading:u,error:v}=(0,y.o)({experimentIds:t,startTimeMs:i,endTimeMs:a,viewType:x.mW.ASSESSMENTS,metricName:x.cs.ASSESSMENT_COUNT,aggregations:[{aggregation_type:x.DF.COUNT}],filters:r,dimensions:[x.gV.ASSESSMENT_VALUE]}),p=(0,n.useMemo)(()=>(null===l||void 0===l?void 0:l.data_points)||[],[null===l||void 0===l?void 0:l.data_points]),h=(0,n.useMemo)(()=>(null===m||void 0===m?void 0:m.data_points)||[],[null===m||void 0===m?void 0:m.data_points]),g=(0,n.useCallback)(e=>{var t,i;return null!==(t=null===(i=e.values)||void 0===i?void 0:i[x.DF.AVG])&&void 0!==t?t:null},[]),f=(0,T.NM)(p,g);return{timeSeriesChartData:(0,n.useMemo)(()=>s.map(e=>{var t;return{name:(0,T.fq)(e,o),value:null!==(t=f.get(e))&&void 0!==t?t:null,timestampMs:e}}),[s,f,o]),distributionChartData:(0,n.useMemo)(()=>{const e={};for(const o of h){var t;const a=null===(t=o.dimensions)||void 0===t?void 0:t[x.gV.ASSESSMENT_VALUE];if(void 0!==a){var i;const t=(null===(i=o.values)||void 0===i?void 0:i[x.DF.COUNT])||0;e[a]=(e[a]||0)+t}}const a=Object.keys(e);if(((e,t=5)=>{if(0===e.length)return!1;const i=e.map(e=>parseFloat(e)).filter(e=>!isNaN(e)),a=new Set(i);return i.some(e=>!Number.isInteger(e))||a.size>t})(a)){const t=((e,t=5)=>{const i=e.map(e=>parseFloat(e)).filter(e=>!isNaN(e));if(0===i.length)return[];const a=Math.min(...i),n=Math.max(...i);if(a===n)return[{min:a,max:n,label:a.toFixed(2)}];const o=(n-a)/t;return Array.from({length:t},(e,i)=>{const s=a+i*o,r=i===t-1?n:a+(i+1)*o;return{min:s,max:r,label:`${s.toFixed(2)}-${r.toFixed(2)}`}})})(a),i=t.map(()=>0);for(const[a,n]of Object.entries(e)){const e=parseFloat(a);if(!isNaN(e)){const a=C(e,t);i[a]+=n}}return t.map((e,t)=>({name:e.label,count:i[t]}))}var n;return(n=a,[...n].sort((e,t)=>e.localeCompare(t,void 0,{numeric:!0}))).map(t=>({name:t,count:e[t]||0}))},[h]),isLoading:c||u,error:d||v,hasData:p.length>0||h.length>0}}var M=i(3409),k=i(14429),Y=i(91105),N=i(73408);var b={name:"82a6rk",styles:"flex:1"};const w=({label:e,children:t})=>{const{theme:i}=(0,o.u)();return(0,N.FD)("div",{css:b,children:[(0,N.Y)(o.T.Text,{color:"secondary",size:"sm",children:e}),(0,N.Y)("div",{css:(0,a.AH)({height:M.tz,marginTop:i.spacing.sm},""),children:(0,N.Y)(l.u,{width:"100%",height:"100%",children:t})})]})},E=({assessmentName:e,lineColor:t,avgValue:i})=>{const{theme:l}=(0,o.u)(),x=(0,M.zZ)(),y=(0,M.IT)(),C=(0,M.gy)(),{experimentIds:b,timeIntervalSeconds:E}=(0,S.W0)(),[F]=(0,k.VA)(),_=(0,Y.Zp)(),D=t||l.colors.green500,I=(0,n.useCallback)(e=>[e,"count"],[]),V=(0,n.useCallback)(t=>{if(!t)return;const i=(0,M.R3)(b[0],F,[(0,M.OM)(e,t)]);_(i)},[b,e,F,_]),L=(0,n.useCallback)(t=>[t.toFixed(2),e],[e]),W=(0,n.useCallback)((t,i)=>{if(void 0===(null===i||void 0===i?void 0:i.timestampMs))return;const a=(0,M.Id)(b[0],i.timestampMs,E,[(0,M.t4)(e)]);_(a)},[b,E,e,_]),H=(0,N.Y)(M.Vn,{formatter:L,linkConfig:{componentId:"mlflow.overview.quality.assessment_timeseries.view_traces_link",onLinkClick:W}}),z=(0,N.Y)(M.Vn,{formatter:I,linkConfig:{componentId:"mlflow.overview.quality.assessment.view_traces_link",linkText:(0,N.Y)(r.A,{id:"B/mYsr",defaultMessage:"View traces with this score"}),onLinkClick:V}}),{timeSeriesChartData:O,distributionChartData:U,isLoading:B,error:G,hasData:$}=A(e);return B?(0,N.Y)(M.lh,{}):G?(0,N.Y)(M.nN,{}):$?(0,N.FD)(M.h,{"data-testid":`assessment-chart-${e}`,children:[(0,N.Y)(M.XQ,{icon:(0,N.Y)(s.CheckCircleIcon,{css:(0,a.AH)({color:D},"")}),title:e,value:void 0!==i?i.toFixed(2):void 0,subtitle:void 0!==i?(0,N.Y)(r.A,{id:"Rwi+VC",defaultMessage:"avg score"}):void 0}),(0,N.FD)("div",{css:(0,a.AH)({display:"flex",gap:l.spacing.lg,marginTop:l.spacing.sm},""),children:[(0,N.Y)(w,{label:(0,N.Y)(r.A,{id:"uHzRht",defaultMessage:"Total aggregate scores"}),children:(0,N.FD)(c.E,{data:U,layout:"vertical",margin:{top:10,right:10,left:10,bottom:0},children:[(0,N.Y)(d.W,{type:"number",allowDecimals:!1,...x}),(0,N.Y)(m.h,{type:"category",dataKey:"name",...y,width:60}),(0,N.Y)(u.m,{content:z,cursor:{fill:l.colors.actionTertiaryBackgroundHover}}),(0,N.Y)(v.s,{...C}),(0,N.Y)(p.y,{dataKey:"count",fill:D,radius:[0,4,4,0]})]})}),void 0!==i&&(0,N.Y)(w,{label:(0,N.Y)(r.A,{id:"JNv3nr",defaultMessage:"Moving average over time"}),children:(0,N.FD)(h.b,{data:O,margin:{top:10,right:10,left:10,bottom:0},children:[(0,N.Y)(d.W,{dataKey:"name",...x}),(0,N.Y)(m.h,{...y}),(0,N.Y)(u.m,{content:H,cursor:{stroke:l.colors.actionTertiaryBackgroundHover}}),(0,N.Y)(v.s,{...C}),(0,N.Y)(g.N,{type:"monotone",dataKey:"value",name:e,stroke:D,strokeWidth:2,dot:(0,T.vx)(D),legendType:"plainline"}),(0,N.Y)(f.e,{y:i,stroke:l.colors.textSecondary,strokeDasharray:"4 4",label:{value:`AVG (${i.toFixed(2)})`,position:"insideTopRight",fill:l.colors.textSecondary,fontSize:10}})]})})]})]}):(0,N.FD)(M.h,{children:[(0,N.Y)(M.XQ,{icon:(0,N.Y)(s.CheckCircleIcon,{css:(0,a.AH)({color:D},"")}),title:e}),(0,N.Y)(M.iE,{})]})}},39833:function(e,t,i){i.d(t,{E:function(){return l}});var a=i(90970),n=i(13240),o=i(60719),s=i(49960),r=i(44941),l=(0,a.gu)({chartName:"BarChart",GraphicalChild:n.y,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:o.W},{axisType:"yAxis",AxisComp:s.h}],formatAxisMap:r.pr})}}]);