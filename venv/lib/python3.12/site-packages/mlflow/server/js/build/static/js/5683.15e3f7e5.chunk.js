"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[5683],{3409:function(e,t,n){n.d(t,{tz:function(){return v},h:function(){return R},iE:function(){return M},nN:function(){return C},XQ:function(){return S},lh:function(){return A},Vn:function(){return E},OM:function(){return k},t4:function(){return L},dC:function(){return _},WW:function(){return I},Id:function(){return N},R3:function(){return D},zZ:function(){return F},IT:function(){return O},T4:function(){return H},gy:function(){return U}});var o=n(68248),i=n(46709),s=n(27757),a=n(82716),r=n(40724),l=n(70431),d=n(80739);var c=n(91105),m=n(69983),u=n(60284),g=n(44105),p=n(15756),f=n(73408);const v=200,h=120,T=60;var y={name:"lugakg",styles:"font-weight:normal"};const S=({icon:e,title:t,value:n,subtitle:i})=>{const{theme:a}=(0,s.u)();return(0,f.FD)("div",{css:(0,o.AH)({marginBottom:a.spacing.lg},""),children:[(0,f.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:a.spacing.xs},""),children:[(0,f.Y)("span",{css:(0,o.AH)({color:a.colors.textSecondary,display:"flex"},""),children:e}),(0,f.Y)(s.T.Text,{bold:!0,size:"lg",children:t})]}),void 0!==n&&(0,f.FD)(s.T.Title,{level:3,css:(0,o.AH)({margin:0,marginTop:a.spacing.sm},""),children:[n,i&&(0,f.FD)(f.FK,{children:[" ",(0,f.Y)(s.T.Text,{color:"secondary",css:y,children:i})]})]})]})},b=({children:e,height:t=280})=>{const{theme:n}=(0,s.u)();return(0,f.Y)("div",{css:(0,o.AH)({border:`1px solid ${n.colors.border}`,borderRadius:n.borders.borderRadiusMd,padding:n.spacing.lg,height:t,display:"flex",alignItems:"center",justifyContent:"center"},""),children:e})};var Y={name:"1u1zie3",styles:"width:120px"},w={name:"m0jwvv",styles:"width:80px"},x={name:"82a6rk",styles:"flex:1"};const A=({height:e=280})=>{const{theme:t}=(0,s.u)();return(0,f.FD)("div",{css:(0,o.AH)({border:`1px solid ${t.colors.border}`,borderRadius:t.borders.borderRadiusMd,padding:t.spacing.lg,height:e,display:"flex",flexDirection:"column",gap:t.spacing.md},""),children:[(0,f.Y)(a.TitleSkeleton,{css:Y}),(0,f.Y)(a.TitleSkeleton,{css:w}),(0,f.Y)("div",{css:x,children:(0,f.Y)(a.TableSkeleton,{lines:4})})]})},C=({height:e,message:t})=>(0,f.Y)(b,{height:e,children:(0,f.Y)(s.T.Text,{color:"error",children:t||(0,f.Y)(r.A,{id:"cp/h86",defaultMessage:"Failed to load chart data"})})}),M=({height:e,message:t})=>(0,f.Y)("div",{css:(0,o.AH)({height:e||"100%",display:"flex",alignItems:"center",justifyContent:"center"},""),children:(0,f.Y)(s.T.Text,{color:"secondary",children:t||(0,f.Y)(r.A,{id:"zwktEP",defaultMessage:"No data available for the selected time range"})})});function D(e,t,n){const o=u.Ay.getExperimentPageTabRoute(e,g.fM.Traces),i=new URLSearchParams,{startTimeLabel:s,startTime:a,endTime:r}=null!==t&&void 0!==t?t:{};return s&&i.set("startTimeLabel",s),a&&i.set("startTime",a),r&&i.set("endTime",r),null===n||void 0===n||n.forEach(e=>i.append("filter",e)),`${o}?${i.toString()}`}function N(e,t,n,o){return D(e,{startTimeLabel:"CUSTOM",startTime:new Date(t).toISOString(),endTime:new Date(t+1e3*n).toISOString()},o)}function L(e){return[p.w8.ASSESSMENT,p.dD.IS_NOT_NULL,"",e].join("::")}function k(e,t){return[p.w8.ASSESSMENT,p.tl.EQUALS,t,e].join("::")}function _(e){return[p.Gq,p.tl.EQUALS,e].join("::")}function I(e){return[p.RC,p.tl.EQUALS,e].join("::")}function E({active:e,payload:t,label:n,formatter:a,linkConfig:l}){var d,u,g,p,v;const{theme:T}=(0,s.u)(),y=(0,c.Zp)(),{hideTooltipLinks:S,tooltipLinkUrlBuilder:b,tooltipLinkText:Y}=null!==(d=(0,i.useContext)(m.J0))&&void 0!==d?d:{};if(!e||null===t||void 0===t||!t.length)return null;const w=null===(u=t[0])||void 0===u?void 0:u.payload,x=void 0!==(null===l||void 0===l?void 0:l.onLinkClick),A=(null===l||void 0===l?void 0:l.experimentId)&&(null===l||void 0===l?void 0:l.timeIntervalSeconds)&&void 0!==(null===w||void 0===w?void 0:w.timestampMs),C=!S&&l&&(x||A);return(0,f.FD)("div",{css:(0,o.AH)({backgroundColor:`${T.colors.backgroundPrimary}80`,backdropFilter:"blur(2px)",border:`1px solid ${T.colors.border}`,borderRadius:T.borders.borderRadiusMd,fontSize:T.typography.fontSizeSm,padding:T.spacing.sm,pointerEvents:"auto",marginLeft:-20,marginRight:-20},""),children:[n&&(0,f.Y)("div",{css:(0,o.AH)({fontWeight:500,marginBottom:T.spacing.xs},""),children:n}),(0,f.Y)("div",{css:(0,o.AH)({maxHeight:h,overflowY:"auto",overflowX:"hidden"},""),children:t.map((e,t)=>{const[n,i]=a(e.value,e.name);return(0,f.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:T.spacing.xs,paddingTop:T.spacing.xs,paddingBottom:T.spacing.xs},""),children:[(0,f.Y)("span",{css:(0,o.AH)({width:T.spacing.sm,height:T.spacing.sm,borderRadius:"50%",backgroundColor:e.color,flexShrink:0},"")}),(0,f.FD)("span",{css:(0,o.AH)({color:e.color},""),children:[i,":"]}),(0,f.Y)("span",{children:n})]},t)})}),C&&(0,f.Y)("div",{css:(0,o.AH)({borderTop:`1px solid ${T.colors.border}`,marginTop:T.spacing.xs,paddingTop:T.spacing.xs},""),children:(0,f.Y)(s.T.Link,{componentId:null!==(g=null===l||void 0===l?void 0:l.componentId)&&void 0!==g?g:"mlflow.overview.usage.traces.view_traces_link",onClick:()=>{if(x)l.onLinkClick(n,w);else if(A){const e=b?b(l.experimentId,w.timestampMs,l.timeIntervalSeconds):N(l.experimentId,w.timestampMs,l.timeIntervalSeconds);y(e)}},css:(0,o.AH)({cursor:"pointer",display:"flex",alignItems:"center",gap:T.spacing.xs},""),children:null!==(p=null!==(v=null===l||void 0===l?void 0:l.linkText)&&void 0!==v?v:Y)&&void 0!==p?p:(0,f.Y)(r.A,{id:"c+3yBY",defaultMessage:"View traces for this period"})})})]})}function F(){const{theme:e}=(0,s.u)();return{tick:{fontSize:10,fill:e.colors.textSecondary,dy:e.spacing.sm},axisLine:!1,tickLine:!1,interval:"preserveStartEnd"}}function O(){const{theme:e}=(0,s.u)();return{tick:{fontSize:10,fill:e.colors.textSecondary},axisLine:!1,tickLine:!1,width:40}}function U(e){var t;const{theme:n}=(0,s.u)();return{formatter:e=>(0,f.Y)("span",{css:(0,o.AH)({color:n.colors.textPrimary,fontSize:n.typography.fontSizeSm,cursor:"pointer"},""),children:e}),wrapperStyle:{maxHeight:null!==(t=null===e||void 0===e?void 0:e.maxHeight)&&void 0!==t?t:T,overflowY:"auto",overflowX:"hidden",paddingTop:n.spacing.xs}}}const R=({children:e,componentId:t,...n})=>{const{theme:a}=(0,s.u)(),r=function(e){const t=(0,i.useRef)((0,l.A)()),n=(0,i.useRef)(0),o=(0,d.R)();return{onClick:(0,i.useCallback)(()=>{if(!e)return;const i=Date.now();i-n.current<1e4||(n.current=i,o({componentId:e,componentViewId:t.current,componentType:s.f.Card,eventType:s.d.OnClick,value:"chart_interaction"}))},[e,o])}}(t);return(0,f.Y)("div",{css:(0,o.AH)({border:`1px solid ${a.colors.border}`,borderRadius:a.borders.borderRadiusMd,padding:a.spacing.lg,backgroundColor:a.colors.backgroundPrimary},""),...r,...n,children:e})};function H(){const{theme:e}=(0,s.u)();return{strokeOpacity:.3,fill:e.colors.blue200,fillOpacity:.3}}},14429:function(e,t,n){n.d(t,{KT:function(){return c},Pz:function(){return u},UY:function(){return g},VA:function(){return m},oy:function(){return d}});var o=n(46709),i=n(91105),s=n(79444);const a="startTimeLabel",r="startTime",l="endTime",d="LAST_7_DAYS",c=(0,o.createContext)(null),m=()=>{const e=(0,s.U)(),t=(0,o.useContext)(c),[n,m]=(0,i.ok)();let u,p,f;var v;t?(u=t.params.startTimeLabel||d,p=t.params.startTime,f=t.params.endTime):(u=n.get(a)||d,p=n.get(r)||void 0,f=null!==(v=n.get(l))&&void 0!==v?v:void 0);if("CUSTOM"!==u){const t=g(e.dateNow,{startTimeLabel:u});p=t.startTime,f=t.endTime}const h=(0,o.useMemo)(()=>({startTimeLabel:u,startTime:p,endTime:f}),[u,p,f]),T=(0,o.useCallback)((e,n=!1)=>{t?t.setParams(null!==e&&void 0!==e?e:{startTimeLabel:void 0,startTime:void 0,endTime:void 0},n):m(t=>(void 0===(null===e||void 0===e?void 0:e.startTime)?t.delete(r):"CUSTOM"===e.startTimeLabel&&t.set(r,e.startTime),void 0===(null===e||void 0===e?void 0:e.endTime)?t.delete(l):"CUSTOM"===e.startTimeLabel&&t.set(l,e.endTime),void 0===(null===e||void 0===e?void 0:e.startTimeLabel)?t.delete(a):t.set(a,e.startTimeLabel),t),{replace:n})},[t,m]);return[h,T,Boolean(n.has(a)||(null===t||void 0===t?void 0:t.disableAutomaticInitialization))]},u=()=>{const[e]=m();return(0,o.useMemo)(()=>{const{startTime:t,endTime:n}=e;return{startTime:t?new Date(t).getTime().toString():void 0,endTime:n?new Date(n).getTime().toString():void 0}},[e])};function g(e,t){return t.startTimeLabel&&"CUSTOM"!==t.startTimeLabel?function(e,t){switch(t){case"LAST_HOUR":return{startTime:new Date(new Date(e).setUTCHours((new Date).getUTCHours()-1)).toISOString(),endTime:e.toISOString()};case"LAST_24_HOURS":return{startTime:new Date(new Date(e).setUTCDate((new Date).getUTCDate()-1)).toISOString(),endTime:e.toISOString()};case"LAST_7_DAYS":return{startTime:new Date(new Date(e).setUTCDate((new Date).getUTCDate()-7)).toISOString(),endTime:e.toISOString()};case"LAST_30_DAYS":return{startTime:new Date(new Date(e).setUTCDate((new Date).getUTCDate()-30)).toISOString(),endTime:e.toISOString()};case"LAST_YEAR":return{startTime:new Date(new Date(e).setUTCFullYear((new Date).getUTCFullYear()-1)).toISOString(),endTime:e.toISOString()};case"ALL":return{startTime:void 0,endTime:e.toISOString()};default:throw new Error(`Unexpected start time label: ${t}`)}}(e,t.startTimeLabel):{startTime:t.startTime,endTime:t.endTime}}},23327:function(e,t,n){n.d(t,{o:function(){return r}});var o=n(49708),i=n(61077),s=n(90935);const a="traceMetrics";function r({experimentIds:e,startTimeMs:t,endTimeMs:n,viewType:r,metricName:l,aggregations:d,timeIntervalSeconds:c,filters:m,dimensions:u,enabled:g=!0}){const p={experiment_ids:e,view_type:r,metric_name:l,aggregations:d,time_interval_seconds:c,start_time_ms:t,end_time_ms:n,filters:m,dimensions:u};return(0,o.I)({queryKey:[a,e,t,n,r,l,d,c,m,u],queryFn:async()=>await async function(e){return(0,i.qP)((0,i.we)("ajax-api/3.0/mlflow/traces/metrics"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).catch(s.J)}(p),enabled:e.length>0&&g,refetchOnWindowFocus:!1})}},46956:function(e,t,n){n.d(t,{aP:function(){return c},bf:function(){return l},kY:function(){return m},y_:function(){return d}});var o=n(68248),i=n(46709),s=n(82716),a=n(27757),r=n(73408);function l(e,t="desc"){const[n,o]=(0,i.useState)(e),[s,a]=(0,i.useState)(t),r=(0,i.useCallback)(e=>{n===e?a("asc"===s?"desc":"asc"):(o(e),a("desc"))},[n,s]);return{sortColumn:n,sortDirection:s,handleSort:r}}function d({column:e,sortColumn:t,sortDirection:n,onSort:i,children:l,centered:d}){const{theme:c}=(0,a.u)();return(0,r.FD)("div",{role:"button",tabIndex:0,onClick:()=>i(e),onKeyDown:t=>"Enter"===t.key&&i(e),css:(0,o.AH)({display:"flex",alignItems:"center",gap:c.spacing.xs,cursor:"pointer",justifyContent:d?"center":"flex-start",color:c.colors.textSecondary,fontSize:c.typography.fontSizeSm,fontWeight:600,"&:hover":{color:c.colors.textPrimary}},""),children:[l,t===e&&("asc"===n?(0,r.Y)(s.SortAscendingIcon,{}):(0,r.Y)(s.SortDescendingIcon,{}))]})}function c(e){const{theme:t}=(0,a.u)(),n={display:"grid",gridTemplateColumns:e,gap:t.spacing.lg,borderBottom:`1px solid ${t.colors.border}`};return{rowStyle:n,headerRowStyle:{...n,padding:`${t.spacing.sm}px ${t.spacing.lg}px ${t.spacing.sm}px 0`},bodyRowStyle:{...n,padding:`${t.spacing.md}px ${t.spacing.lg}px ${t.spacing.md}px 0`,alignItems:"center","&:last-child":{borderBottom:"none"}},cellStyle:{textAlign:"center"}}}const m=({name:e,color:t,scrollToElementId:n})=>{const{theme:i}=(0,a.u)(),s=()=>{const e=document.getElementById(n);e&&e.scrollIntoView({behavior:"smooth",block:"start"})};return(0,r.FD)("div",{role:"button",tabIndex:0,onClick:s,onKeyDown:e=>"Enter"===e.key&&s(),css:(0,o.AH)({display:"flex",alignItems:"center",gap:i.spacing.sm,cursor:"pointer","&:hover":{textDecoration:"underline"}},""),children:[(0,r.Y)("div",{css:(0,o.AH)({width:8,height:8,borderRadius:"50%",backgroundColor:t,flexShrink:0},"")}),(0,r.Y)(a.T.Text,{css:(0,o.AH)({fontFamily:"monospace",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:i.colors.actionPrimaryBackgroundDefault},""),children:e})]})}},79444:function(e,t,n){n.d(t,{U:function(){return d},k:function(){return l}});var o=n(76118),i=n(46709),s=n(73408);const a=()=>({dateNow:new Date,lastRefreshTime:Date.now(),refresh:()=>{}}),r=(0,i.createContext)(a()),l=({config:e,children:t})=>{const n=a(),l=(0,o.merge)({},n,e),[d,c]=i.useState(l.lastRefreshTime),m=(0,i.useMemo)(()=>new Date(d),[d]),u=(0,i.useCallback)(()=>{c(Date.now())},[]);return(0,s.Y)(r.Provider,{value:{...l,dateNow:m,lastRefreshTime:d,refresh:u},children:t})},d=()=>{const e=(0,i.useContext)(r);return e||a()}},84411:function(e,t,n){n.d(t,{$:function(){return T}});var o=n(68248),i=n(46709),s=n(82716),a=n(27757),r=n(79081),l=n(15756),d=n(42747),c=n(92338),m=n(14429),u=n(76118),g=n(16453),p=n(79444),f=n(39595),v=n(92388),h=n(73408);const T=i.memo(function({excludeOptions:e,refreshButtonComponentId:t="mlflow.experiment-evaluation-monitoring.refresh-date-button"}){const n=(0,d.tz)(),{theme:T}=(0,a.u)(),y=((0,f.jE)(),(0,v.C)({queryKey:[l.TH]})),[S,b]=(0,m.VA)(),Y=(0,i.useMemo)(()=>{const t=(0,c.p)(n);return null!==e&&void 0!==e&&e.length?t.filter(t=>!e.includes(t.key)):t},[n,e]),w=n.formatMessage({id:"BJvcsS",defaultMessage:"Time Range"}),x=(0,p.U)();return(0,h.FD)("div",{css:(0,o.AH)({display:"flex",gap:T.spacing.sm,alignItems:"center"},""),children:[(0,h.FD)(s.DialogCombobox,{componentId:"mlflow.experiment-evaluation-monitoring.date-selector",label:w,value:S.startTimeLabel?[S.startTimeLabel]:[m.oy],children:[(0,h.Y)(s.DialogComboboxTrigger,{renderDisplayedValue:e=>{var t;return null===(t=Y.find(t=>t.key===e))||void 0===t?void 0:t.label},allowClear:!(0,u.isNil)(S.startTimeLabel)&&S.startTimeLabel!==m.oy,onClear:()=>{b({startTimeLabel:m.oy})},"data-testid":"time-range-select-dropdown"}),(0,h.Y)(s.DialogComboboxContent,{children:(0,h.Y)(s.DialogComboboxOptionList,{children:Y.map(e=>(0,h.Y)(s.DialogComboboxOptionListSelectItem,{checked:S.startTimeLabel===e.key||e.key===m.oy&&(0,u.isNil)(S.startTimeLabel),title:e.label,"data-testid":`time-range-select-${e}`,value:e.key,onChange:()=>{b({...S,startTimeLabel:e.key})},children:e.label},e.key))})})]}),"CUSTOM"===S.startTimeLabel&&(0,h.Y)(h.FK,{children:(0,h.Y)(g.cv,{id:"date-picker-range",includeTime:!0,selected:{from:new Date(S.startTime),to:S.endTime?new Date(S.endTime):x.dateNow},onChange:e=>{const t=e.target.value;b({...S,startTime:null!==t&&void 0!==t&&t.from?t.from.toISOString():void 0,endTime:null!==t&&void 0!==t&&t.to?t.to.toISOString():void 0})},startDatePickerProps:{componentId:"experiment-evaluation-monitoring-start-date-picker",datePickerProps:{disabled:{after:x.dateNow}},value:S.startTime?new Date(S.startTime):void 0},endDatePickerProps:{componentId:"experiment-evaluation-monitoring-end-date-picker",datePickerProps:{disabled:{after:x.dateNow}},value:S.endTime?new Date(S.endTime):void 0}})}),(0,h.Y)(r.T,{componentId:"mlflow.experiment-evaluation-monitoring.trace-info-hover-request-time",content:n.formatMessage({id:"Arvaod",defaultMessage:"Showing data up to {date}."},{date:x.dateNow.toLocaleString(navigator.language,{timeZoneName:"short"})}),children:(0,h.Y)(a.B,{type:"link",componentId:t,disabled:Boolean(y),onClick:()=>{x.refresh()},children:(0,h.Y)(s.RefreshIcon,{})})})]})})},85683:function(e,t,n){n.r(t),n.d(t,{default:function(){return ce}});var o=n(68248),i=n(46709),s=n(59930),a=n.n(s),r=n(91105),l=n(27757),d=n(82716),c=n(40724),m=n(67689),u=n(84411),g=n(14429),p=n(79444),f=n(25889),v=n(34421),h=n(36120),T=n(48123),y=n(40263),S=n(26415),b=n(94473),Y=n(16844),w=n(23327),x=n(69983);var A=n(3409),C=n(73408);const M=i.lazy(()=>Promise.all([n.e(291),n.e(5378),n.e(5714),n.e(4768)]).then(n.bind(n,34768)).then(e=>({default:e.TraceAssessmentChart}))),D=e=>(0,C.Y)(i.Suspense,{fallback:(0,C.Y)(d.LegacySkeleton,{active:!0}),children:(0,C.Y)(M,{...e})});var N=n(83110),L=n(66916),k=n(7655),_=n(19112),I=n(92338);var E={name:"1blwlv5",styles:"flex:1;flex-direction:column;display:flex;align-items:center;justify-content:center"},F={name:"xvginl",styles:"max-width:600px"},O={name:"bjn8wh",styles:"position:relative"};const U=({hasAssessmentsOutsideTimeRange:e=!1})=>{const{theme:t}=(0,l.u)(),n=(0,k.A)(),[s]=(0,g.VA)(),a=(0,i.useMemo)(()=>(0,I.p)(n),[n]),{experimentIds:r}=(0,x.W0)(),m=(0,i.useMemo)(()=>`import openai\n\nimport mlflow\nfrom mlflow.genai.scorers import Correctness\n\nmlflow.set_tracking_uri(YOUR_TRACKING_URI)\nmlflow.set_experiment(experiment_id="${r[0]}")\n\n# Define your model's predict function\ndef my_model(question: str) -> str:\n    response = openai.OpenAI().chat.completions.create(\n        model="gpt-4o-mini",\n        messages=[{"role": "user", "content": question}],\n    )\n    return response.choices[0].message.content\n\neval_dataset = [\n    {\n        "inputs": {"question": "How do I log a model with MLflow?"},\n        "expectations": {\n            "expected_response": "You can log a model by using the mlflow.<flavor>.log_model function."\n        },\n    },\n]\n\n# Run evaluation with built-in scorer Correctness\nmlflow.genai.evaluate(\n    data=eval_dataset,\n    predict_fn=my_model,\n    scorers=[Correctness()],\n)`,[r]);if(e){var u;const e=(null===(u=a.find(e=>e.key===s.startTimeLabel))||void 0===u?void 0:u.label)||"";return(0,C.Y)(d.Empty,{image:(0,C.Y)(L.S,{}),title:(0,C.Y)(c.A,{id:"AHaom4",defaultMessage:"No assessments available"}),description:(0,C.FD)(C.FK,{children:[(0,C.Y)(c.A,{id:"yzf17M",defaultMessage:'Some assessments are hidden by your time range filter: "{filterLabel}".',values:{filterLabel:(0,C.Y)("strong",{children:e})}}),(0,C.Y)("br",{}),(0,C.Y)(c.A,{id:"bUdkau",defaultMessage:"Try selecting a longer time range."})]})})}return(0,C.FD)("div",{css:E,children:[(0,C.Y)(l.T.Text,{color:"secondary",css:(0,o.AH)({marginBottom:t.spacing.lg},""),children:(0,C.Y)(c.A,{id:"AHaom4",defaultMessage:"No assessments available"})}),(0,C.Y)(l.T.Title,{level:3,color:"secondary",children:(0,C.Y)(c.A,{id:"HF6L/f",defaultMessage:"Monitor quality metrics from scorers"})}),(0,C.FD)(l.T.Paragraph,{color:"secondary",css:F,children:[(0,C.Y)(c.A,{id:"NnO0Lz",defaultMessage:"MLflow allows you to evaluate your GenAI applications using scorers. Scorers compute quality metrics like relevance, correctness, and custom assessments. Copy the code snippet below to run an evaluation, or visit the documentation for a more in-depth example."}),(0,C.Y)(l.T.Link,{componentId:"mlflow.quality_tab.empty_state.learn_more_link",css:(0,o.AH)({marginLeft:t.spacing.xs},""),href:"https://mlflow.org/docs/latest/genai/eval-monitor/",openInNewTab:!0,children:(0,C.Y)(c.A,{id:"tiQptW",defaultMessage:"Learn more"})})]}),(0,C.FD)("div",{css:O,children:[(0,C.Y)(_.VE,{componentId:"mlflow.overview.quality_tab.empty_state.example_code_copy",css:(0,o.AH)({position:"absolute",top:t.spacing.xs,right:t.spacing.xs},""),copyText:m}),(0,C.Y)(_.z7,{language:"python",showLineNumbers:!0,children:m})]})]})};var R=n(46956);var H={name:"1fttcpj",styles:"display:flex;flex-direction:column"},B={name:"r0pyvo",styles:"max-height:300px;overflow-y:auto"};const P=({assessmentNames:e,countsByName:t,avgValuesByName:n})=>{const{theme:s}=(0,l.u)(),{getChartColor:a}=(0,N.yC)(),{sortColumn:r,sortDirection:m,handleSort:u}=(0,R.bf)("totalCount"),{headerRowStyle:g,bodyRowStyle:p,cellStyle:f}=(0,R.aP)("minmax(80px, 2fr) 1fr 1fr"),v=(0,i.useMemo)(()=>e.map(e=>({scorerName:e,totalCount:t.get(e),avgValue:n.get(e)})),[e,t,n]),h=(0,i.useMemo)(()=>v.length?[...v].sort((e,t)=>{let n=0;switch(r){case"scorerName":n=e.scorerName.localeCompare(t.scorerName);break;case"totalCount":n=e.totalCount-t.totalCount;break;case"avgValue":var o,i;n=(null!==(o=e.avgValue)&&void 0!==o?o:-1/0)-(null!==(i=t.avgValue)&&void 0!==i?i:-1/0);break}return"asc"===m?n:-n}):v,[v,r,m]);return(0,C.FD)(A.h,{componentId:"mlflow.overview.quality.quality_summary_table",children:[(0,C.Y)(A.XQ,{icon:(0,C.Y)(d.SparkleIcon,{css:(0,o.AH)({color:s.colors.yellow500},"")}),title:(0,C.Y)(c.A,{id:"VDf1X1",defaultMessage:"Quality Summary"})}),(0,C.FD)("div",{css:H,children:[(0,C.FD)("div",{css:g,children:[(0,C.Y)(R.y_,{column:"scorerName",sortColumn:r,sortDirection:m,onSort:u,children:(0,C.Y)(c.A,{id:"FoMjFN",defaultMessage:"Scorer"})}),(0,C.Y)(R.y_,{column:"totalCount",sortColumn:r,sortDirection:m,onSort:u,centered:!0,children:(0,C.Y)(c.A,{id:"7yW27D",defaultMessage:"Total Count"})}),(0,C.Y)(R.y_,{column:"avgValue",sortColumn:r,sortDirection:m,onSort:u,centered:!0,children:(0,C.Y)(c.A,{id:"bmBV9A",defaultMessage:"Average Value"})})]}),(0,C.Y)("div",{css:B,children:h.map((t,n)=>{const o=e.indexOf(t.scorerName),i=-1===o?n:o;return(0,C.FD)("div",{css:p,children:[(0,C.Y)(R.kY,{name:t.scorerName,color:a(i),scrollToElementId:`assessment-chart-${t.scorerName}`}),(0,C.Y)(l.T.Text,{css:f,children:(0,N.B4)(t.totalCount)}),(0,C.Y)(l.T.Text,{css:f,children:(s=t.avgValue,void 0===s?"-":s.toFixed(2))})]},t.scorerName);var s})})]})]})},V=()=>{const{theme:e}=(0,l.u)(),{assessmentNames:t,avgValuesByName:n,countsByName:s,isLoading:a,error:r,hasData:m}=function(){const{experimentIds:e,startTimeMs:t,endTimeMs:n}=(0,x.W0)(),o=(0,i.useMemo)(()=>[(0,Y.$L)(Y.mg.TYPE,Y.AN.FEEDBACK)],[]),{data:s,isLoading:a,error:r}=(0,w.o)({experimentIds:e,startTimeMs:t,endTimeMs:n,viewType:Y.mW.ASSESSMENTS,metricName:Y.cs.ASSESSMENT_COUNT,aggregations:[{aggregation_type:Y.DF.COUNT}],filters:o,dimensions:[Y.gV.ASSESSMENT_NAME]}),{data:l,isLoading:d,error:c}=(0,w.o)({experimentIds:e,startTimeMs:t,endTimeMs:n,viewType:Y.mW.ASSESSMENTS,metricName:Y.cs.ASSESSMENT_VALUE,aggregations:[{aggregation_type:Y.DF.AVG}],filters:o,dimensions:[Y.gV.ASSESSMENT_NAME]}),{assessmentNames:m,countsByName:u}=(0,i.useMemo)(()=>{if(null===s||void 0===s||!s.data_points)return{assessmentNames:[],countsByName:new Map};const e=new Set,t=new Map;for(const i of s.data_points){var n,o;const s=null===(n=i.dimensions)||void 0===n?void 0:n[Y.gV.ASSESSMENT_NAME],a=null===(o=i.values)||void 0===o?void 0:o[Y.DF.COUNT];s&&void 0!==a&&(e.add(s),t.set(s,a))}return{assessmentNames:Array.from(e).sort(),countsByName:t}},[null===s||void 0===s?void 0:s.data_points]);return{assessmentNames:m,avgValuesByName:(0,i.useMemo)(()=>{if(null===l||void 0===l||!l.data_points)return new Map;const e=new Map;for(const o of l.data_points){var t,n;const i=null===(t=o.dimensions)||void 0===t?void 0:t[Y.gV.ASSESSMENT_NAME],s=null===(n=o.values)||void 0===n?void 0:n[Y.DF.AVG];i&&void 0!==s&&e.set(i,s)}return e},[null===l||void 0===l?void 0:l.data_points]),countsByName:u,isLoading:a||d,error:r||c,hasData:m.length>0}}(),{hasAssessmentsOutsideTimeRange:u,isLoading:g}=function(e){const{experimentIds:t}=(0,x.W0)(),n=(0,i.useMemo)(()=>[(0,Y.$L)(Y.mg.TYPE,Y.AN.FEEDBACK)],[]),{data:o,isLoading:s,error:a}=(0,w.o)({experimentIds:t,startTimeMs:void 0,endTimeMs:void 0,viewType:Y.mW.ASSESSMENTS,metricName:Y.cs.ASSESSMENT_COUNT,aggregations:[{aggregation_type:Y.DF.COUNT}],filters:n,dimensions:[Y.gV.ASSESSMENT_NAME],enabled:e});return{hasAssessmentsOutsideTimeRange:(0,i.useMemo)(()=>!(null===o||void 0===o||!o.data_points)&&o.data_points.length>0,[null===o||void 0===o?void 0:o.data_points]),isLoading:s,error:a}}(!m&&!a),{getChartColor:p}=(0,N.yC)();return a||!m&&g?(0,C.Y)(A.lh,{}):r?(0,C.Y)(A.nN,{}):m?(0,C.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:e.spacing.md},""),children:[(0,C.FD)("div",{children:[(0,C.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:e.spacing.xs,marginBottom:e.spacing.xs},""),children:[(0,C.Y)(d.SparkleIcon,{css:(0,o.AH)({color:e.colors.yellow500},"")}),(0,C.Y)(l.T.Text,{bold:!0,size:"lg",children:(0,C.Y)(c.A,{id:"ic8x74",defaultMessage:"Quality Insights"})})]}),(0,C.Y)(l.T.Text,{color:"secondary",children:(0,C.Y)(c.A,{id:"o0NwZU",defaultMessage:"Quality metrics computed by scorers."})})]}),(0,C.Y)(P,{assessmentNames:t,countsByName:s,avgValuesByName:n}),t.map((e,t)=>(0,C.Y)("div",{id:`assessment-chart-${e}`,children:(0,C.Y)(D,{assessmentName:e,lineColor:p(t),avgValue:n.get(e)})},e))]}):(0,C.Y)(U,{hasAssessmentsOutsideTimeRange:u})};var $=n(82719);const z=()=>{const{theme:e}=(0,l.u)(),{totalCalls:t,failedCalls:n,successRate:s,avgLatency:a,isLoading:r,error:m}=function(){var e,t,n;const{experimentIds:o,startTimeMs:s,endTimeMs:a}=(0,x.W0)(),r=(0,i.useMemo)(()=>[(0,Y.jm)(Y.Mm.TYPE,Y.du.TOOL)],[]),{data:l,isLoading:d,error:c}=(0,w.o)({experimentIds:o,startTimeMs:s,endTimeMs:a,viewType:Y.mW.SPANS,metricName:Y.Ub.SPAN_COUNT,aggregations:[{aggregation_type:Y.DF.COUNT}],filters:r,dimensions:[Y.it.SPAN_STATUS]}),{data:m,isLoading:u,error:g}=(0,w.o)({experimentIds:o,startTimeMs:s,endTimeMs:a,viewType:Y.mW.SPANS,metricName:Y.Ub.LATENCY,aggregations:[{aggregation_type:Y.DF.AVG}],filters:r}),{totalCalls:p,successCalls:f,failedCalls:v}=(0,i.useMemo)(()=>{if(null===l||void 0===l||!l.data_points)return{totalCalls:0,successCalls:0,failedCalls:0};let e=0,t=0,n=0;for(const s of l.data_points){var o,i;const a=(null===(o=s.values)||void 0===o?void 0:o[Y.DF.COUNT])||0,r=null===(i=s.dimensions)||void 0===i?void 0:i[Y.it.SPAN_STATUS];e+=a,r===Y.Fp.OK?t+=a:r===Y.Fp.ERROR&&(n+=a)}return{totalCalls:e,successCalls:t,failedCalls:n}},[null===l||void 0===l?void 0:l.data_points]);return{totalCalls:p,successCalls:f,failedCalls:v,successRate:p>0?f/p*100:0,avgLatency:(null===m||void 0===m||null===(e=m.data_points)||void 0===e||null===(t=e[0])||void 0===t||null===(n=t.values)||void 0===n?void 0:n[Y.DF.AVG])||0,isLoading:d||u,error:c||g}}();return m?(0,C.Y)(A.nN,{}):(0,C.FD)("div",{css:(0,o.AH)({display:"flex",gap:e.spacing.md,flexWrap:"wrap"},""),children:[(0,C.Y)($.hI,{icon:(0,C.Y)(d.WrenchIcon,{}),iconColor:e.colors.blue600,iconBgColor:e.colors.blue100,value:(0,N.B4)(t),label:(0,C.Y)(c.A,{id:"wvuSAK",defaultMessage:"Total Tool Calls"}),isLoading:r}),(0,C.Y)($.hI,{icon:(0,C.Y)(L.C,{}),iconColor:e.colors.yellow600,iconBgColor:e.colors.yellow100,value:(0,N.YL)(a),label:(0,C.Y)(c.A,{id:"yRzU8K",defaultMessage:"Avg Latency"}),isLoading:r}),(0,C.Y)($.hI,{icon:(0,C.Y)(d.CheckCircleIcon,{}),iconColor:e.colors.green600,iconBgColor:e.colors.green100,value:`${s.toFixed(2)}%`,label:(0,C.Y)(c.A,{id:"961sxj",defaultMessage:"Success Rate"}),isLoading:r}),(0,C.Y)($.hI,{icon:(0,C.Y)(L.X,{}),iconColor:e.colors.red600,iconBgColor:e.colors.red100,value:(0,N.B4)(n),label:(0,C.Y)(c.A,{id:"oWtdfc",defaultMessage:"Failed Calls"}),isLoading:r})]})};const j=i.lazy(()=>Promise.all([n.e(291),n.e(5378),n.e(5714),n.e(8472)]).then(n.bind(n,38472)).then(e=>({default:e.ToolErrorRateChart}))),K=e=>(0,C.Y)(i.Suspense,{fallback:(0,C.Y)(A.lh,{}),children:(0,C.Y)(j,{...e})}),W=()=>{const{getChartColor:e}=(0,N.yC)(),{toolNames:t,errorRateByTool:n,isLoading:o,error:s,hasData:a}=function(){const{experimentIds:e,startTimeMs:t,endTimeMs:n}=(0,x.W0)(),o=(0,i.useMemo)(()=>[(0,Y.jm)(Y.Mm.TYPE,Y.du.TOOL)],[]),{data:s,isLoading:a,error:r}=(0,w.o)({experimentIds:e,startTimeMs:t,endTimeMs:n,viewType:Y.mW.SPANS,metricName:Y.Ub.SPAN_COUNT,aggregations:[{aggregation_type:Y.DF.COUNT}],filters:o,dimensions:[Y.it.SPAN_NAME,Y.it.SPAN_STATUS]}),{toolNames:l,errorRateByTool:d}=(0,i.useMemo)(()=>{if(null===s||void 0===s||!s.data_points)return{toolNames:[],errorRateByTool:new Map};const e=new Map;for(const a of s.data_points){var t,n,o;const i=null===(t=a.dimensions)||void 0===t?void 0:t[Y.it.SPAN_NAME];if(!i)continue;const s=(null===(n=a.values)||void 0===n?void 0:n[Y.DF.COUNT])||0,r=null===(o=a.dimensions)||void 0===o?void 0:o[Y.it.SPAN_STATUS];e.has(i)||e.set(i,{error:0,total:0});const l=e.get(i);l.total+=s,r===Y.Fp.ERROR&&(l.error+=s)}const i=new Map;for(const[s,{error:a,total:r}]of e)i.set(s,r>0?a/r*100:0);return{toolNames:Array.from(e.keys()).sort(),errorRateByTool:i}},[null===s||void 0===s?void 0:s.data_points]);return{toolNames:l,errorRateByTool:d,isLoading:a,error:r,hasData:l.length>0}}();return o?(0,C.Y)(A.lh,{}):s?(0,C.Y)(A.nN,{}):a?(0,C.Y)($.vK,{children:t.map((t,o)=>{var i;return(0,C.Y)("div",{id:`tool-chart-${t}`,children:(0,C.Y)(K,{toolName:t,lineColor:e(o),overallErrorRate:null!==(i=n.get(t))&&void 0!==i?i:0})},t)})}):null},q=i.lazy(()=>Promise.all([n.e(291),n.e(5378),n.e(5910)]).then(n.bind(n,25910)).then(e=>({default:e.ToolUsageChart}))),Q=()=>(0,C.Y)(i.Suspense,{fallback:(0,C.Y)(A.lh,{}),children:(0,C.Y)(q,{})}),G=i.lazy(()=>Promise.all([n.e(291),n.e(5378),n.e(5714),n.e(5679)]).then(n.bind(n,55679)).then(e=>({default:e.ToolLatencyChart}))),J=()=>(0,C.Y)(i.Suspense,{fallback:(0,C.Y)(A.lh,{}),children:(0,C.Y)(G,{})}),X=i.lazy(()=>n.e(8462).then(n.bind(n,18462)).then(e=>({default:e.ToolPerformanceSummary}))),Z=()=>(0,C.Y)(i.Suspense,{fallback:(0,C.Y)(A.lh,{}),children:(0,C.Y)(X,{})});var ee=n(4286),te=n(93281);let ne=function(e){return e.Usage="usage",e.Quality="quality",e.ToolCalls="tool-calls",e}({});const oe=ne.Usage;var ie={name:"3z2sxu",styles:"display:flex;flex-direction:column;flex:1;overflow:hidden"},se={name:"l2hjmg",styles:"display:flex;flex-direction:column;flex:1;min-height:0"},ae={name:"9jwnf3",styles:"flex:1;overflow-y:auto"},re={name:"9jwnf3",styles:"flex:1;overflow-y:auto"},le={name:"9jwnf3",styles:"flex:1;overflow-y:auto"};const de=()=>{const{experimentId:e}=(0,r.g)(),{theme:t}=(0,l.u)(),[n,s]=(()=>{const{experimentId:e,overviewTab:t}=(0,r.g)(),n=(0,r.Zp)(),o=(0,r.zy)();return[Object.values(ne).includes(t)?t:oe,(0,i.useCallback)(t=>{n(`/experiments/${e}/overview/${t}${o.search}`,{replace:!0})},[e,n,o.search])]})(),[Y,w]=(0,i.useState)(null),A=(0,m.x$)();a()(e,"Experiment ID must be defined");const[M]=(0,g.VA)(),D=(0,p.U)(),{startTime:L,endTime:k}=(0,i.useMemo)(()=>(0,g.UY)(D.dateNow,M),[D.dateNow,M]),_=L?new Date(L).getTime():void 0,I=k?new Date(k).getTime():void 0,E=(0,te.N3)(_,I);(0,i.useEffect)(()=>{Y&&!(0,te.ei)(_,I,Y)&&w(null)},[_,I,Y]);const F=null!==Y&&void 0!==Y?Y:E,O=te.ZG[F],U=(0,i.useMemo)(()=>(0,N.yB)(_,I,O),[_,I,O]);return(0,C.FD)("div",{css:ie,children:[A&&(0,C.Y)(d.Alert,{componentId:"mlflow.experiment.overview.filestore-warning",type:"warning",css:(0,o.AH)({marginBottom:t.spacing.sm},""),message:(0,C.Y)(c.A,{id:"mYcueV",defaultMessage:"The Overview tab requires a SQL-based tracking store for full functionality, file-based backend is not supported."})}),(0,C.FD)(d.Tabs.Root,{componentId:"mlflow.experiment.overview.tabs",value:n,onValueChange:e=>s(e),valueHasNoPii:!0,css:se,children:[(0,C.FD)(d.Tabs.List,{children:[(0,C.Y)(d.Tabs.Trigger,{value:ne.Usage,children:(0,C.Y)(c.A,{id:"ecUdab",defaultMessage:"Usage"})}),(0,C.Y)(d.Tabs.Trigger,{value:ne.Quality,children:(0,C.Y)(c.A,{id:"lRO4km",defaultMessage:"Quality"})}),(0,C.Y)(d.Tabs.Trigger,{value:ne.ToolCalls,children:(0,C.Y)(c.A,{id:"a9kRlY",defaultMessage:"Tool calls"})})]}),(0,C.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:t.spacing.sm},""),children:[(0,C.Y)(ee.l,{value:F,onChange:w,startTimeMs:_,endTimeMs:I,allowClear:null!==Y&&Y!==E,onClear:()=>w(null)}),(0,C.Y)(u.$,{excludeOptions:["ALL"],refreshButtonComponentId:"mlflow.experiment.overview.refresh-button"})]}),(0,C.FD)(x.F7,{experimentIds:[e],startTimeMs:_,endTimeMs:I,timeIntervalSeconds:O,timeBuckets:U,children:[(0,C.Y)(d.Tabs.Content,{value:ne.Usage,css:ae,children:(0,C.FD)($.aE,{children:[(0,C.Y)(f.a,{}),(0,C.FD)($.vK,{children:[(0,C.Y)(v.K,{}),(0,C.Y)(h.L,{})]}),(0,C.FD)($.vK,{children:[(0,C.Y)(T.o,{}),(0,C.Y)(y.A,{})]}),(0,C.FD)($.vK,{children:[(0,C.Y)(S.q,{}),(0,C.Y)(b.m,{})]})]})}),(0,C.Y)(d.Tabs.Content,{value:ne.Quality,css:re,children:(0,C.Y)($.aE,{children:(0,C.Y)(V,{})})}),(0,C.Y)(d.Tabs.Content,{value:ne.ToolCalls,css:le,children:(0,C.FD)($.aE,{children:[(0,C.Y)(z,{}),(0,C.Y)(Z,{}),(0,C.FD)($.vK,{children:[(0,C.Y)(Q,{}),(0,C.Y)(J,{})]}),(0,C.Y)(W,{})]})})]})]})]})};var ce=()=>(0,C.Y)(p.k,{children:(0,C.Y)(de,{})})},90935:function(e,t,n){n.d(t,{J:function(){return i}});var o=n(36476);async function i(e){if(e instanceof o.Un){var t;const n=await(null===(t=e.response)||void 0===t?void 0:t.json());e.message=null===n||void 0===n?void 0:n.message}throw e}},92338:function(e,t,n){function o(e){return[{key:"LAST_HOUR",label:e.formatMessage({id:"bjoGjg",defaultMessage:"Last hour"})},{key:"LAST_24_HOURS",label:e.formatMessage({id:"JChRnq",defaultMessage:"Last 24 hours"})},{key:"LAST_7_DAYS",label:e.formatMessage({id:"eQsXm7",defaultMessage:"Last 7 days"})},{key:"LAST_30_DAYS",label:e.formatMessage({id:"p1H1KR",defaultMessage:"Last 30 days"})},{key:"LAST_YEAR",label:e.formatMessage({id:"EI7moF",defaultMessage:"Last year"})},{key:"ALL",label:e.formatMessage({id:"HeNa8H",defaultMessage:"All"})},{key:"CUSTOM",label:e.formatMessage({id:"TpmJlu",defaultMessage:"Custom"})}]}n.d(t,{p:function(){return o}})}}]);