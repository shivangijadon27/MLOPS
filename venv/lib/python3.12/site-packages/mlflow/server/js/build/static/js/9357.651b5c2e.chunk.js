"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[9357],{55570:function(e,n,i){i.d(n,{X:function(){return c}});i(46709);var o=i(89949),t=i(82716),a=i(27757),d=i(40724),l=i(73408);function r(){return(0,l.Y)(t.Empty,{"data-testid":"fallback",title:(0,l.Y)(d.A,{id:"qAdWdK",defaultMessage:"Error"}),description:(0,l.Y)(d.A,{id:"RzZVxC",defaultMessage:"An error occurred while rendering this component."}),image:(0,l.Y)(a.k,{})})}function s({children:e,customFallbackComponent:n}){function i(e,n){console.error("Caught Unexpected Error: ",e,n.componentStack)}return n?(0,l.Y)(o.tH,{onError:i,FallbackComponent:n,children:e}):(0,l.Y)(o.tH,{onError:i,fallback:(0,l.Y)(r,{}),children:e})}function c(e,n,i,o){return function(e){return(0,l.Y)(s,{customFallbackComponent:o,children:(0,l.Y)(n,{...e})})}}},59357:function(e,n,i){i.r(n),i.d(n,{default:function(){return we}});var o=i(91105),t=i(55570),a=i(91113),d=i(884),l=i(39595),r=i(46709),s=i(30431),c=i(49708),m=i(25117);var g=i(61060);var p=i(1422);var u=i(44341),f=i(85344),h=i(29447);function v(e){const n=(0,o.Zp)(),i=(0,l.jE)(),{data:t,isLoading:a,error:f}=(e=>(0,c.I)(["gateway_endpoint",e],{queryFn:()=>m.t.getEndpoint(e),retry:!1,enabled:Boolean(e)}))(e),v=null===t||void 0===t?void 0:t.endpoint,y=(0,d.mN)({defaultValues:{name:"",trafficSplitModels:[],fallbackModels:[],usageTracking:!1,experimentId:""}});(0,r.useEffect)(()=>{if(v&&v.model_mappings){var e,n,i,o,t;const a=null!==(e=v.model_mappings.filter(e=>"PRIMARY"===e.linkage_type))&&void 0!==e?e:[],d=null!==(n=v.model_mappings.filter(e=>"FALLBACK"===e.linkage_type))&&void 0!==n?n:[],l=a.reduce((e,n)=>{var i;return e+(null!==(i=n.weight)&&void 0!==i?i:1)},0);y.reset({name:null!==(i=v.name)&&void 0!==i?i:"",trafficSplitModels:a.map(e=>{var n,i,o,t,d,r,s,c,m,g;return{modelDefinitionId:null===(n=e.model_definition)||void 0===n?void 0:n.model_definition_id,modelDefinitionName:null!==(i=null===(o=e.model_definition)||void 0===o?void 0:o.name)&&void 0!==i?i:"",provider:null!==(t=null===(d=e.model_definition)||void 0===d?void 0:d.provider)&&void 0!==t?t:"",modelName:null!==(r=null===(s=e.model_definition)||void 0===s?void 0:s.model_name)&&void 0!==r?r:"",secretMode:"existing",existingSecretId:null!==(c=null===(m=e.model_definition)||void 0===m?void 0:m.secret_id)&&void 0!==c?c:"",newSecret:{name:"",authMode:"",secretFields:{},configFields:{}},weight:l>0?(null!==(g=e.weight)&&void 0!==g?g:1)/l*100:100/a.length}}),fallbackModels:d.sort((e,n)=>{var i,o;return(null!==(i=e.fallback_order)&&void 0!==i?i:0)-(null!==(o=n.fallback_order)&&void 0!==o?o:0)}).map((e,n)=>{var i,o,t,a,d,l,r,s,c;return{modelDefinitionId:null===(i=e.model_definition)||void 0===i?void 0:i.model_definition_id,modelDefinitionName:null!==(o=null===(t=e.model_definition)||void 0===t?void 0:t.name)&&void 0!==o?o:"",provider:null!==(a=null===(d=e.model_definition)||void 0===d?void 0:d.provider)&&void 0!==a?a:"",modelName:null!==(l=null===(r=e.model_definition)||void 0===r?void 0:r.model_name)&&void 0!==l?l:"",secretMode:"existing",existingSecretId:null!==(s=null===(c=e.model_definition)||void 0===c?void 0:c.secret_id)&&void 0!==s?s:"",newSecret:{name:"",authMode:"",secretFields:{},configFields:{}},fallbackOrder:n+1}}),usageTracking:null!==(o=v.usage_tracking)&&void 0!==o&&o,experimentId:null!==(t=v.experiment_id)&&void 0!==t?t:""})}},[v,y]);const{mutateAsync:x,error:w,isLoading:b}=(()=>{const e=(0,l.jE)();return(0,g.n)({mutationFn:e=>m.t.updateEndpoint({endpoint_id:e.endpointId,name:e.name,model_configs:e.model_configs,routing_strategy:e.routing_strategy,fallback_config:e.fallback_config,usage_tracking:e.usage_tracking,experiment_id:e.experiment_id}),onSuccess:()=>{e.invalidateQueries(["gateway_endpoints"]),e.invalidateQueries(["gateway_endpoint"])}})})(),{mutateAsync:Y}=(0,u.w)(),{mutateAsync:A}=(0,p.H)(),{mutateAsync:M}=(()=>{const e=(0,l.jE)();return(0,g.n)({mutationFn:e=>m.t.updateModelDefinition({model_definition_id:e.modelDefinitionId,secret_id:e.secretId,provider:e.provider,model_name:e.modelName}),onSuccess:()=>{e.invalidateQueries(["gateway_endpoints"]),e.invalidateQueries(["gateway_endpoint"]),e.invalidateQueries(["gateway_model_definitions"])}})})(),S=b,I=w,k=(0,r.useCallback)(async e=>{if(v)try{const i=async e=>{if("existing"===e.secretMode)return e.existingSecretId;return(await Y({secret_name:e.newSecret.name,secret_value:e.newSecret.secretFields,provider:e.provider,auth_config:e.newSecret.configFields})).secret.secret_id},o=async n=>{if(n.modelDefinitionId){var o;const e=null===(o=v.model_mappings)||void 0===o?void 0:o.find(e=>{var i;return(null===(i=e.model_definition)||void 0===i?void 0:i.model_definition_id)===n.modelDefinitionId});if(null!==e&&void 0!==e&&e.model_definition){if(n.provider!==e.model_definition.provider||n.modelName!==e.model_definition.model_name||"existing"===n.secretMode&&n.existingSecretId!==e.model_definition.secret_id||"new"===n.secretMode){const e=await i(n);await M({modelDefinitionId:n.modelDefinitionId,secretId:e,provider:n.provider,modelName:n.modelName})}}return n.modelDefinitionId}const t=await i(n);if(!n.provider||!n.modelName)throw new Error("Provider and model name are required to create a model definition");const a=Date.now();let d=`${e.name||v.name}-${n.provider}-${n.modelName}-${a}`.toLowerCase().replace(/[^a-z0-9-]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");d||(d=`model-definition-${a}`);return(await A({name:d,secret_id:t,provider:n.provider,model_name:n.modelName})).model_definition.model_definition_id},t=await Promise.all(e.trafficSplitModels.map(e=>o(e))),a=await Promise.all(e.fallbackModels.map(e=>o(e))),d=e.trafficSplitModels.reduce((e,n)=>e+n.weight,0),l=e.trafficSplitModels.length||1,r=[...e.trafficSplitModels.map((e,n)=>({model_definition_id:t[n],linkage_type:"PRIMARY",weight:d>0?e.weight/100:1/l})),...e.fallbackModels.map((e,n)=>({model_definition_id:a[n],linkage_type:"FALLBACK",fallback_order:e.fallbackOrder}))],s=e.trafficSplitModels.length>1?"REQUEST_BASED_TRAFFIC_SPLIT":void 0,c=e.fallbackModels.length>0?{strategy:"SEQUENTIAL",max_attempts:e.fallbackModels.length+1}:void 0;await x({endpointId:v.endpoint_id,name:e.name||void 0,model_configs:r,routing_strategy:s,fallback_config:c,usage_tracking:e.usageTracking}),n(h.Ay.getEndpointDetailsRoute(v.endpoint_id))}catch{}},[v,x,n,Y,A,M]),T=(0,r.useCallback)(()=>{n(h.Ay.gatewayPageRoute)},[n]),_=(0,r.useCallback)(async n=>{v&&(await x({endpointId:v.endpoint_id,name:n}),i.invalidateQueries({queryKey:["gateway","endpoint",e]}),i.invalidateQueries({queryKey:["gateway","endpoints"]}))},[v,x,i,e]),C=y.watch("trafficSplitModels"),D=y.watch("fallbackModels"),F=(0,r.useMemo)(()=>{if(0===C.length)return!1;const e=C.reduce((e,n)=>e+n.weight,0);if(Math.abs(e-100)>.01)return!1;const n=e=>{if(!e.provider||!e.modelName)return!1;if("existing"===e.secretMode)return Boolean(e.existingSecretId);{if(!e.newSecret)return!1;const n=Boolean(e.newSecret.name&&e.newSecret.authMode),i=!!e.newSecret.secretFields&&Object.values(e.newSecret.secretFields).some(e=>e);return n&&i}},i=C.every(n),o=D.every(n);return i&&o},[C,D]),H=y.watch("name"),$=y.watch("usageTracking"),P=(0,r.useMemo)(()=>{var e,n,i,o,t,a;if(!v)return!1;const d=null!==(e=v.name)&&void 0!==e?e:"";if(H!==d)return!0;const l=null!==(n=v.usage_tracking)&&void 0!==n&&n;if($!==l)return!0;const r=null!==(i=null===(o=v.model_mappings)||void 0===o?void 0:o.filter(e=>"PRIMARY"===e.linkage_type))&&void 0!==i?i:[],s=null!==(t=null===(a=v.model_mappings)||void 0===a?void 0:a.filter(e=>"FALLBACK"===e.linkage_type))&&void 0!==t?t:[];if(C.length!==r.length)return!0;if(D.length!==s.length)return!0;const c=r.reduce((e,n)=>{var i;return e+(null!==(i=n.weight)&&void 0!==i?i:1)},0),m=C.some((e,n)=>{var i;const o=r[n];if(!o||!o.model_definition)return!0;const t=c>0?(null!==(i=o.weight)&&void 0!==i?i:1)/c*100:100/r.length;if(e.modelDefinitionId&&e.modelDefinitionId!==o.model_definition.model_definition_id)return!0;if(e.modelDefinitionId&&e.modelDefinitionId===o.model_definition.model_definition_id){if(e.provider!==o.model_definition.provider||e.modelName!==o.model_definition.model_name||"existing"===e.secretMode&&e.existingSecretId!==o.model_definition.secret_id||"new"===e.secretMode)return!0}return e.provider!==o.model_definition.provider||e.modelName!==o.model_definition.model_name||"existing"!==e.secretMode||e.existingSecretId!==o.model_definition.secret_id||Math.abs(e.weight-t)>.01}),g=D.some(e=>{if(!e.modelDefinitionId)return!0;const n=s.find(n=>{var i;return(null===(i=n.model_definition)||void 0===i?void 0:i.model_definition_id)===e.modelDefinitionId});if(!n)return!0;if(n.model_definition){if(e.provider!==n.model_definition.provider||e.modelName!==n.model_definition.model_name||"existing"===e.secretMode&&e.existingSecretId!==n.model_definition.secret_id||"new"===e.secretMode)return!0}return n.fallback_order!==e.fallbackOrder});return m||g},[v,H,$,C,D]),{data:L}=(0,s.c)();return{form:y,isLoadingEndpoint:a,isSubmitting:S,loadError:f,mutationError:I,endpoint:v,existingEndpoints:L,isFormComplete:F,hasChanges:P,handleSubmit:k,handleCancel:T,handleNameUpdate:_}}var y=i(68248),x=i(27757),w=i(82716),b=i(79081),Y=i(40724),A=i(7655),M=i(6459),S=i(98332),I=i(63420),k=i(35583),T=i(93422),_=i(73716),C=i(75329),D=i(73408);var F={name:"1066lcq",styles:"display:flex;justify-content:space-between;align-items:center"},H={name:"1hhxok4",styles:"margin:0;font-weight:bold"},$={name:"1u1zie3",styles:"width:120px"},P={name:"1d3w5wq",styles:"width:100%"};const L=({model:e,index:n,onModelChange:i,onWeightChange:o,onRemove:t,componentIdPrefix:a})=>{const{theme:d}=(0,x.u)(),l=(0,A.A)(),[s,c]=(0,r.useState)(!e.provider&&!e.modelName),[m,g]=(0,r.useState)(null),p=null!==m&&void 0!==m?m:0===e.weight?"":String(e.weight),{existingSecrets:u,isLoadingSecrets:f,authModes:h,defaultAuthMode:v,isLoadingProviderConfig:M}=(0,_.t)({provider:e.provider}),L={mode:e.secretMode,existingSecretId:e.existingSecretId,newSecret:e.newSecret},N=e.provider&&e.modelName;return(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:d.spacing.md,padding:d.spacing.md,border:`2px solid ${d.colors.border}`,borderRadius:d.borders.borderRadiusMd,backgroundColor:d.colors.backgroundPrimary},""),children:[(0,D.FD)("div",{css:F,children:[(0,D.FD)("div",{css:(0,y.AH)({display:"flex",alignItems:"center",gap:d.spacing.sm,flex:1},""),children:[(0,D.Y)(x.B,{componentId:`${a}.expand.${n}`,icon:s?(0,D.Y)(w.ChevronDownIcon,{}):(0,D.Y)(x.o,{}),onClick:()=>c(!s),size:"small"}),(0,D.Y)(w.FormUI.Label,{css:H,children:(0,D.Y)(Y.A,{id:"JNmxAa",defaultMessage:"Model {number}",values:{number:n+1}})}),!s&&N&&(0,D.FD)(x.T.Text,{css:(0,y.AH)({fontFamily:"monospace",color:d.colors.textSecondary},""),children:[(0,C.aU)(e.provider)," / ",e.modelName,(0,D.FD)("span",{css:(0,y.AH)({marginLeft:d.spacing.sm,color:d.colors.actionTertiaryTextDefault},""),children:["(",e.weight,"%)"]})]})]}),(0,D.Y)(b.T,{componentId:`${a}.remove-tooltip.${n}`,content:l.formatMessage({id:"eWm+AG",defaultMessage:"Remove model"}),children:(0,D.Y)(x.B,{componentId:`${a}.remove.${n}`,icon:(0,D.Y)(w.TrashIcon,{}),onClick:()=>t(n)})})]}),s&&(0,D.FD)(D.FK,{children:[(0,D.Y)(I.U,{value:e.provider,onChange:e=>{i(n,{provider:e,modelName:"",secretMode:"new",existingSecretId:"",newSecret:{name:"",authMode:"",secretFields:{},configFields:{}}})},componentIdPrefix:`${a}.provider.${n}`}),(0,D.Y)(k.o,{provider:e.provider,value:e.modelName,onChange:e=>i(n,{modelName:e}),componentIdPrefix:`${a}.model.${n}`}),(0,D.Y)(T.$,{value:L,onChange:e=>{i(n,{secretMode:e.mode,existingSecretId:e.existingSecretId,newSecret:e.newSecret})},provider:e.provider,existingSecrets:u,isLoadingSecrets:f,authModes:h,defaultAuthMode:v,isLoadingProviderConfig:M,componentIdPrefix:`${a}.api-key.${n}`}),(0,D.FD)("div",{css:$,children:[(0,D.Y)(w.FormUI.Label,{htmlFor:`${a}.weight.${n}`,children:(0,D.Y)(Y.A,{id:"pOqgMC",defaultMessage:"Weight"})}),(0,D.FD)("div",{css:(0,y.AH)({display:"flex",alignItems:"center",gap:d.spacing.xs},""),children:[(0,D.Y)(S.f,{componentId:`${a}.weight.${n}`,type:"number",min:0,max:100,value:p,onChange:e=>{g(e.target.value);const i=parseInt(e.target.value,10);o(n,Number.isNaN(i)?0:i)},css:P}),(0,D.Y)("span",{css:(0,y.AH)({color:d.colors.textSecondary},""),children:"%"})]})]})]})]})};var N={name:"1066lcq",styles:"display:flex;justify-content:space-between;align-items:center"};const E=({value:e,onChange:n,componentIdPrefix:i="mlflow.gateway.traffic-split"})=>{const{theme:o}=(0,x.u)(),t=(0,r.useCallback)(()=>{n([...e,{modelDefinitionName:"",provider:"",modelName:"",secretMode:"new",existingSecretId:"",newSecret:{name:"",authMode:"",secretFields:{},configFields:{}},weight:0}])},[e,n]),a=(0,r.useCallback)(i=>{n(e.filter((e,n)=>n!==i))},[e,n]),d=(0,r.useCallback)((i,o)=>{const t=[...e];t[i]={...t[i],...o},n(t)},[e,n]),l=(0,r.useCallback)((i,o)=>{const t=[...e];t[i]={...t[i],weight:o},n(t)},[e,n]),s=e.reduce((e,n)=>e+n.weight,0),c=100===s;return(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:o.spacing.md},""),children:[e.map((e,n)=>(0,D.Y)(L,{model:e,index:n,onModelChange:d,onWeightChange:l,onRemove:a,componentIdPrefix:i},n)),(0,D.FD)("div",{css:N,children:[(0,D.Y)(x.B,{componentId:`${i}.add`,icon:(0,D.Y)(w.PlusIcon,{}),onClick:t,children:(0,D.Y)(Y.A,{id:"MsSpWB",defaultMessage:"Add model for traffic split"})}),e.length>0&&(0,D.FD)("div",{css:(0,y.AH)({display:"flex",alignItems:"center",gap:o.spacing.xs,color:c?o.colors.textSecondary:o.colors.textValidationDanger,fontSize:o.typography.fontSizeSm},""),children:[(0,D.Y)(Y.A,{id:"6fV0+T",defaultMessage:"Total: {total}%",values:{total:s}}),!c&&(0,D.Y)(Y.A,{id:"ftZaLl",defaultMessage:"(must equal 100%)"})]})]})]})};var R=i(17066),B=i(24014),U=i(72943),O=i(59126);const z="FALLBACK_MODEL";var j={name:"1066lcq",styles:"display:flex;justify-content:space-between;align-items:center"},G={name:"uaizzl",styles:"cursor:grab;display:flex;align-items:center;&:active{cursor:grabbing;}"},q={name:"1hhxok4",styles:"margin:0;font-weight:bold"};const K=({model:e,index:n,onModelChange:i,onRemove:o,onMove:t,componentIdPrefix:a})=>{const{theme:d}=(0,x.u)(),l=(0,A.A)(),[s,c]=(0,r.useState)(!e.provider&&!e.modelName),m=(0,r.useRef)(null),[{isDragging:g},p,u]=(0,U.i)({type:z,item:{type:z,index:n},collect:e=>({isDragging:e.isDragging()})}),[{isOver:f},h]=(0,O.H)({accept:z,hover:e=>{if(!m.current)return;const i=e.index,o=n;i!==o&&(t(i,o),e.index=o)},collect:e=>({isOver:e.isOver()})});u(h(m));const{existingSecrets:v,isLoadingSecrets:M,authModes:S,defaultAuthMode:F,isLoadingProviderConfig:H}=(0,_.t)({provider:e.provider}),$={mode:e.secretMode,existingSecretId:e.existingSecretId,newSecret:e.newSecret},P=e.provider&&e.modelName;return(0,D.FD)("div",{ref:m,css:(0,y.AH)({display:"flex",flexDirection:"column",gap:d.spacing.md,padding:d.spacing.md,border:`2px solid ${d.colors.border}`,borderRadius:d.borders.borderRadiusMd,backgroundColor:d.colors.backgroundPrimary,opacity:g?.5:1,borderColor:f?d.colors.actionPrimaryBackgroundDefault:d.colors.border},""),children:[(0,D.FD)("div",{css:j,children:[(0,D.FD)("div",{css:(0,y.AH)({display:"flex",alignItems:"center",gap:d.spacing.sm,flex:1},""),children:[(0,D.Y)("div",{ref:p,css:G,children:(0,D.Y)(w.DragIcon,{css:(0,y.AH)({color:d.colors.textSecondary},"")})}),(0,D.Y)(x.B,{componentId:`${a}.expand.${n}`,icon:s?(0,D.Y)(w.ChevronDownIcon,{}):(0,D.Y)(x.o,{}),onClick:()=>c(!s),size:"small"}),(0,D.Y)(w.FormUI.Label,{css:q,children:(0,D.Y)(Y.A,{id:"hDExYR",defaultMessage:"Fallback Model {order}",values:{order:n+1}})}),!s&&P&&(0,D.FD)(x.T.Text,{css:(0,y.AH)({fontFamily:"monospace",color:d.colors.textSecondary},""),children:[(0,C.aU)(e.provider)," / ",e.modelName]})]}),(0,D.Y)(b.T,{componentId:`${a}.remove-tooltip.${n}`,content:l.formatMessage({id:"XZlIAj",defaultMessage:"Remove fallback model"}),children:(0,D.Y)(x.B,{componentId:`${a}.remove.${n}`,icon:(0,D.Y)(w.TrashIcon,{}),onClick:()=>o(n)})})]}),s&&(0,D.FD)(D.FK,{children:[(0,D.Y)(I.U,{value:e.provider,onChange:e=>{i(n,{provider:e,modelName:"",secretMode:"new",existingSecretId:"",newSecret:{name:"",authMode:"",secretFields:{},configFields:{}}})},componentIdPrefix:`${a}.provider.${n}`}),(0,D.Y)(k.o,{provider:e.provider,value:e.modelName,onChange:e=>i(n,{modelName:e}),componentIdPrefix:`${a}.model.${n}`}),(0,D.Y)(T.$,{value:$,onChange:e=>{i(n,{secretMode:e.mode,existingSecretId:e.existingSecretId,newSecret:e.newSecret})},provider:e.provider,existingSecrets:v,isLoadingSecrets:M,authModes:S,defaultAuthMode:F,isLoadingProviderConfig:H,componentIdPrefix:`${a}.api-key.${n}`})]})]})},X=({value:e,onChange:n,componentIdPrefix:i="mlflow.gateway.fallback"})=>{const{theme:o}=(0,x.u)(),t=(0,r.useCallback)(()=>{const i=e.length>0?Math.max(...e.map(e=>e.fallbackOrder))+1:1;n([...e,{modelDefinitionName:"",provider:"",modelName:"",secretMode:"new",existingSecretId:"",newSecret:{name:"",authMode:"",secretFields:{},configFields:{}},fallbackOrder:i}])},[e,n]),a=(0,r.useCallback)(i=>{const o=e.filter((e,n)=>n!==i).map((e,n)=>({...e,fallbackOrder:n+1}));n(o)},[e,n]),d=(0,r.useCallback)((i,o)=>{const t=[...e];t[i]={...t[i],...o},n(t)},[e,n]),l=(0,r.useCallback)((i,o)=>{const t=[...e],[a]=t.splice(i,1);t.splice(o,0,a);const d=t.map((e,n)=>({...e,fallbackOrder:n+1}));n(d)},[e,n]);return(0,D.Y)(R.Q,{backend:B.t2,children:(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:o.spacing.md},""),children:[e.map((e,n)=>(0,D.Y)(K,{model:e,index:n,onModelChange:d,onRemove:a,onMove:l,componentIdPrefix:i},n)),(0,D.Y)(x.B,{componentId:`${i}.add`,icon:(0,D.Y)(w.PlusIcon,{}),onClick:t,children:(0,D.Y)(Y.A,{id:"NlwpVQ",defaultMessage:"Add fallback"})})]})})};var Q=i(96872),V=i(91701),W=i(19112);var Z={name:"bjn8wh",styles:"position:relative"},J={name:"1i9vogi",styles:"margin-top:0"};const ee=({open:e,onClose:n,endpointName:i,baseUrl:o})=>{const{theme:t}=(0,x.u)(),[a,d]=(0,r.useState)("unified"),[l,s]=(0,r.useState)("openai"),[c,m]=(0,r.useState)("curl"),[g,p]=(0,r.useState)("curl"),u=(e=>e||("undefined"!==typeof window?window.location.origin:"http://localhost:5000"))(o),f=`curl -X POST ${u}/gateway/${i}/mlflow/invocations \\\n  -H "Content-Type: application/json" \\\n  -d '{\n  "messages": [\n    {"role": "user", "content": "Hello, how are you?"}\n  ]\n}'`,h=`import requests\n\nresponse = requests.post(\n    "${u}/gateway/${i}/mlflow/invocations",\n    json={\n        "messages": [\n            {"role": "user", "content": "Hello, how are you?"}\n        ]\n    }\n)\nprint(response.json())`,v=`curl -X POST ${u}/gateway/mlflow/v1/chat/completions \\\n  -H "Content-Type: application/json" \\\n  -d '{\n  "model": "${i}",\n  "messages": [\n    {"role": "user", "content": "How are you?"}\n  ]\n}'`,A=`from openai import OpenAI\n\nclient = OpenAI(\n    base_url="${u}/gateway/mlflow/v1",\n    api_key="",  # API key not needed, configured server-side\n)\n\nmessages = [{"role": "user", "content": "How are you?"}]\n\nresponse = client.chat.completions.create(\n    model="${i}",  # Endpoint name as model\n    messages=messages,\n)\nprint(response.choices[0].message)`,M=`curl -X POST ${u}/gateway/openai/v1/responses \\\n  -H "Content-Type: application/json" \\\n  -d '{\n  "model": "${i}",\n  "input": "How are you?"\n}'`,S=`from openai import OpenAI\n\nclient = OpenAI(\n    base_url="${u}/gateway/openai/v1",\n    api_key="dummy",  # API key not needed, configured server-side\n)\n\nresponse = client.responses.create(\n    model="${i}",\n    input="How are you?",\n)\nprint(response.output_text)`,I=`curl -X POST ${u}/gateway/anthropic/v1/messages \\\n  -H "Content-Type: application/json" \\\n  -d '{\n  "model": "${i}",\n  "max_tokens": 1024,\n  "messages": [\n    {"role": "user", "content": "How are you?"}\n  ]\n}'`,k=`import anthropic\n\nclient = anthropic.Anthropic(\n    base_url="${u}/gateway/anthropic",\n    api_key="dummy",  # API key not needed, configured server-side\n)\n\nresponse = client.messages.create(\n    model="${i}",\n    max_tokens=1024,\n    messages=[{"role": "user", "content": "How are you?"}],\n)\nprint(response.content[0].text)`,T=`curl -X POST ${u}/gateway/gemini/v1beta/models/${i}:generateContent \\\n  -H "Content-Type: application/json" \\\n  -d '{\n  "contents": [{\n    "parts": [{"text": "How are you?"}]\n  }]\n}'`,_=`from google import genai\n\n# Configure with custom endpoint\nclient = genai.Client(\n    api_key='dummy',\n    http_options={\n        'base_url': "${u}/gateway/gemini",\n    }\n)\nresponse = client.models.generate_content(\n    model="${i}",\n    contents={'text': 'How are you?'},\n)\nclient.close()\nprint(response.candidates[0].content.parts[0].text)`,C=(e,n,i="text")=>(0,D.FD)("div",{css:(0,y.AH)({marginBottom:t.spacing.md},""),children:[(0,D.FD)("div",{css:(0,y.AH)({display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:t.spacing.xs},""),children:[(0,D.Y)(x.T.Text,{bold:!0,children:e}),(0,D.Y)(V.i,{componentId:`mlflow.gateway.usage-modal.copy-${e.toLowerCase().replace(/\s+/g,"-")}`,copyText:n,icon:(0,D.Y)(w.CopyIcon,{}),showLabel:!1})]}),(0,D.Y)("div",{css:Z,children:(0,D.Y)(W.z7,{language:i,theme:t.isDarkMode?"duotoneDark":"light",style:{fontSize:t.typography.fontSizeSm,padding:`${t.spacing.sm}px ${t.spacing.md}px`},children:n})})]});return(0,D.Y)(b.d,{componentId:"mlflow.gateway.endpoint-usage-modal",visible:e,onCancel:n,title:(0,D.Y)(Y.A,{id:"/Sa51w",defaultMessage:"Query endpoint"}),footer:null,size:"wide",children:(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:t.spacing.md,maxHeight:"70vh",overflowY:"auto"},""),children:[(0,D.Y)(x.T.Text,{color:"secondary",children:(0,D.Y)(Y.A,{id:"+HgSTK",defaultMessage:"Use these code examples to call your endpoint. Choose between unified APIs for seamless model switching or passthrough APIs for provider-specific features."})}),(0,D.FD)("div",{css:(0,y.AH)({display:"flex",gap:t.spacing.sm,borderBottom:`1px solid ${t.colors.border}`},""),children:[(0,D.Y)("div",{css:(0,y.AH)({padding:`${t.spacing.sm}px ${t.spacing.md}px`,cursor:"pointer",borderBottom:"unified"===a?`2px solid ${t.colors.actionPrimaryBackgroundDefault}`:"2px solid transparent",color:"unified"===a?t.colors.actionPrimaryBackgroundDefault:t.colors.textSecondary,fontWeight:"unified"===a?"bold":"normal"},""),onClick:()=>d("unified"),children:(0,D.Y)(Y.A,{id:"vwD2zW",defaultMessage:"Unified APIs"})}),(0,D.Y)("div",{css:(0,y.AH)({padding:`${t.spacing.sm}px ${t.spacing.md}px`,cursor:"pointer",borderBottom:"passthrough"===a?`2px solid ${t.colors.actionPrimaryBackgroundDefault}`:"2px solid transparent",color:"passthrough"===a?t.colors.actionPrimaryBackgroundDefault:t.colors.textSecondary,fontWeight:"passthrough"===a?"bold":"normal"},""),onClick:()=>d("passthrough"),children:(0,D.Y)(Y.A,{id:"dQawRm",defaultMessage:"Passthrough APIs"})})]}),"unified"===a&&(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:t.spacing.lg},""),children:[(0,D.FD)(w.SegmentedControlGroup,{name:"unified-language-selector",componentId:"mlflow.gateway.usage-modal.unified-language-selector",value:g,onChange:({target:{value:e}})=>p(e),children:[(0,D.Y)(w.SegmentedControlButton,{value:"curl",children:"cURL"}),(0,D.Y)(w.SegmentedControlButton,{value:"python",children:"Python"})]}),(0,D.FD)("div",{children:[(0,D.Y)(x.T.Title,{level:4,css:J,children:(0,D.Y)(Y.A,{id:"Y7AIKR",defaultMessage:"MLflow Invocations API"})}),(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginBottom:t.spacing.md},""),children:(0,D.Y)(Y.A,{id:"tv0qk9",defaultMessage:"Native MLflow API for model invocations. Supports seamless model switching and advanced routing."})}),"curl"===g&&C("cURL",f,"text"),"python"===g&&C("Python",h,"python")]}),(0,D.FD)("div",{children:[(0,D.Y)(x.T.Title,{level:4,children:(0,D.Y)(Y.A,{id:"dsPsxG",defaultMessage:"OpenAI-Compatible Chat Completions API"})}),(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginBottom:t.spacing.md},""),children:(0,D.Y)(Y.A,{id:"hjAgZ8",defaultMessage:"Unified OpenAI compatible API for model invocations. Set the endpoint name as the model parameter."})}),"curl"===g&&C("cURL",v,"text"),"python"===g&&C("Python",A,"python")]})]}),"passthrough"===a&&(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:t.spacing.lg},""),children:[(0,D.FD)("div",{children:[(0,D.Y)(x.T.Text,{bold:!0,css:(0,y.AH)({display:"block",marginBottom:t.spacing.sm},""),children:(0,D.Y)(Y.A,{id:"+li9YN",defaultMessage:"Provider"})}),(0,D.FD)(w.SegmentedControlGroup,{name:"provider-selector",componentId:"mlflow.gateway.usage-modal.provider-selector",value:l,onChange:({target:{value:e}})=>s(e),children:[(0,D.Y)(w.SegmentedControlButton,{value:"openai",children:"OpenAI"}),(0,D.Y)(w.SegmentedControlButton,{value:"anthropic",children:"Anthropic"}),(0,D.Y)(w.SegmentedControlButton,{value:"gemini",children:"Google Gemini"})]})]}),(0,D.FD)("div",{children:["openai"===l&&(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginBottom:t.spacing.md},""),children:(0,D.Y)(Y.A,{id:"cniMRT",defaultMessage:"Direct access to OpenAI's Responses API for multi-turn conversations with vision and audio capabilities."})}),"anthropic"===l&&(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginBottom:t.spacing.md},""),children:(0,D.Y)(Y.A,{id:"Xn0LxG",defaultMessage:"Direct access to Anthropic's Messages API with Claude-specific features."})}),"gemini"===l&&(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginBottom:t.spacing.md},""),children:(0,D.Y)(Y.A,{id:"7MWbDM",defaultMessage:"Direct access to Google's Gemini API. Note: endpoint name is part of the URL path."})}),(0,D.FD)(w.SegmentedControlGroup,{name:"language-selector",componentId:"mlflow.gateway.usage-modal.language-selector",value:c,onChange:({target:{value:e}})=>m(e),css:(0,y.AH)({marginBottom:t.spacing.md},""),children:[(0,D.Y)(w.SegmentedControlButton,{value:"curl",children:"cURL"}),(0,D.Y)(w.SegmentedControlButton,{value:"python",children:"Python"})]}),"openai"===l&&"curl"===c&&C("cURL",M,"text"),"openai"===l&&"python"===c&&C("Python",S,"python"),"anthropic"===l&&"curl"===c&&C("cURL",I,"text"),"anthropic"===l&&"python"===c&&C("Python",k,"python"),"gemini"===l&&"curl"===c&&C("cURL",T,"text"),"gemini"===l&&"python"===c&&C("Python",_,"python")]})]})]})})};var ne=i(66916),ie=i(87032);const oe=({endpoint:e,existingEndpoints:n,onNameUpdate:i,isSubmitting:o=!1})=>{const{theme:t}=(0,x.u)(),a=(0,A.A)(),[d,l]=(0,r.useState)(!1),[s,c]=(0,r.useState)(""),[m,g]=(0,r.useState)(null),[p,u]=(0,r.useState)(!1),f=()=>{l(!1),c(""),g(null)};return(0,D.FD)(D.FK,{children:[(0,D.FD)("div",{css:(0,y.AH)({display:"flex",alignItems:"center",gap:t.spacing.xs},""),children:[(0,D.Y)(x.T.Title,{level:2,withoutMargins:!0,children:null===e||void 0===e?void 0:e.name}),(0,D.Y)(b.T,{componentId:"mlflow.gateway.edit-endpoint.name-edit-tooltip",content:a.formatMessage({id:"nBKx6U",defaultMessage:"Edit endpoint name"}),children:(0,D.Y)(x.B,{componentId:"mlflow.gateway.edit-endpoint.name-edit-button",size:"small",type:"tertiary",icon:(0,D.Y)(w.PencilIcon,{}),onClick:()=>{var n;c(null!==(n=null===e||void 0===e?void 0:e.name)&&void 0!==n?n:""),g(null),l(!0)},disabled:o,"aria-label":a.formatMessage({id:"5umyLP",defaultMessage:"Edit endpoint name"})})})]}),(0,D.Y)(b.d,{componentId:"mlflow.gateway.edit-endpoint-name-modal",title:a.formatMessage({id:"AawxF/",defaultMessage:"Edit Endpoint Name"}),visible:d,onCancel:f,onOk:async()=>{const o=(i=>{if(!i.trim())return a.formatMessage({id:"Y73UT6",defaultMessage:"Endpoint name is required"});if(!(0,ie.j8)(i))return a.formatMessage({id:"dzIz7c",defaultMessage:"Name can only contain letters, numbers, underscores, hyphens, and dots. Spaces and special characters are not allowed."});const o=null===n||void 0===n?void 0:n.filter(n=>n.endpoint_id!==(null===e||void 0===e?void 0:e.endpoint_id));return null!==o&&void 0!==o&&o.some(e=>e.name===i)?a.formatMessage({id:"gVz/1j",defaultMessage:"An endpoint with this name already exists"}):null})(s);if(o)g(o);else if(s!==(null===e||void 0===e?void 0:e.name)){u(!0);try{await i(s),f()}catch(t){g(t.message||"Failed to update endpoint name")}finally{u(!1)}}else f()},okText:a.formatMessage({id:"8DoNdT",defaultMessage:"Save"}),cancelText:a.formatMessage({id:"hHNj31",defaultMessage:"Cancel"}),confirmLoading:p,okButtonProps:{disabled:!s.trim()||s===(null===e||void 0===e?void 0:e.name)},size:"normal",children:(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:t.spacing.md},""),children:[m&&(0,D.Y)(w.Alert,{componentId:"mlflow.gateway.edit-endpoint-name-modal.error",type:"error",message:m,closable:!1}),(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:t.spacing.xs},""),children:[(0,D.Y)(x.T.Text,{bold:!0,children:(0,D.Y)(Y.A,{id:"FHJ1NN",defaultMessage:"Endpoint Name"})}),(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({fontSize:t.typography.fontSizeSm},""),children:(0,D.Y)(Y.A,{id:"iT2I8i",defaultMessage:"The name is used in the endpoint URL. Only letters, numbers, underscores, hyphens, and dots are allowed."})}),(0,D.Y)(ne.I,{componentId:"mlflow.gateway.edit-endpoint-name-modal.name-input",value:s,onChange:e=>{c(e.target.value),m&&g(null)},placeholder:a.formatMessage({id:"AanBxl",defaultMessage:"my-endpoint"}),validationState:m?"error":void 0,autoFocus:!0})]})]})})]})};var te=i(62593);var ae={name:"ti75j2",styles:"margin:0"};const de=({experimentId:e,tooltipLinkUrlBuilder:n})=>{const{theme:i}=(0,x.u)();return(0,D.FD)("div",{children:[(0,D.FD)("div",{css:(0,y.AH)({marginBottom:i.spacing.md},""),children:[(0,D.Y)(x.T.Title,{level:3,css:ae,children:(0,D.Y)(Y.A,{id:"pjCmlG",defaultMessage:"Usage"})}),(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginTop:i.spacing.xs},""),children:(0,D.Y)(Y.A,{id:"rdK1v3",defaultMessage:"Monitor endpoint usage and performance metrics"})}),(0,D.Y)(x.T.Link,{componentId:"mlflow.gateway.endpoint.usage.view-full-dashboard",href:`#/experiments/${e}/overview`,css:(0,y.AH)({display:"inline-block",marginTop:i.spacing.xs},""),children:(0,D.Y)(Y.A,{id:"hR27A2",defaultMessage:"View full dashboard"})})]}),(0,D.Y)(te.Y,{experimentIds:[e],showTokenStats:!0,tooltipLinkUrlBuilder:n,tooltipLinkText:n?(0,D.Y)(Y.A,{id:"V+4GZQ",defaultMessage:"View logs for this period"}):void 0})]})};var le=i(65641),re=i(79444),se=i(14429),ce=i(84411);const me=({experimentId:e})=>{const{theme:n}=(0,x.u)(),i=(0,se.Pz)();return(0,D.FD)(D.FK,{children:[(0,D.FD)("div",{css:(0,y.AH)({display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:n.spacing.sm},""),children:[(0,D.Y)(ce.$,{excludeOptions:["ALL"]}),(0,D.Y)(o.N_,{to:`/experiments/${e}/traces`,css:(0,y.AH)({color:n.colors.actionPrimaryBackgroundDefault,textDecoration:"none","&:hover":{textDecoration:"underline"}},""),children:(0,D.Y)(Y.A,{id:"SHoy6d",defaultMessage:"Open full trace viewer"})})]}),(0,D.Y)(le.v,{experimentId:e,disableActions:!0,timeRange:i})]})};var ge={name:"1jyk3dc",styles:"overflow:hidden;display:flex;flex-direction:column;flex:1"},pe={name:"1jyk3dc",styles:"overflow:hidden;display:flex;flex-direction:column;flex:1"},ue={name:"1jyk3dc",styles:"overflow:hidden;display:flex;flex-direction:column;flex:1"},fe={name:"1rb8d7z",styles:"flex:1;display:flex;flex-direction:column;min-height:0"},he={name:"82a6rk",styles:"flex:1"},ve={name:"kdbhus",styles:"height:100%;display:flex;flex-direction:column"},ye={name:"1e1crzz",styles:"width:280px;flex-shrink:0;position:sticky;top:0;align-self:flex-start"};const xe=({form:e,isLoadingEndpoint:n,isSubmitting:i,loadError:t,mutationError:a,errorMessage:l,endpoint:s,existingEndpoints:c,isFormComplete:m,hasChanges:g,onSubmit:p,onCancel:u,onNameUpdate:f})=>{const{theme:v}=(0,x.u)(),S=(0,A.A)(),[I,k]=(0,o.ok)(),[T,_]=(0,r.useState)(!1),C=I.get("tab")||"configuration",F=e.watch("trafficSplitModels"),H=e.watch("fallbackModels"),$=e.watch("experimentId"),P=!$&&"usage"!==C,L=!$&&"traces"!==C,N=(0,r.useMemo)(()=>{if(s)return(e,n,i)=>h.Ay.getEndpointDetailsRoute(s.endpoint_id,{tab:"traces",startTime:new Date(n).toISOString(),endTime:new Date(n+1e3*i).toISOString()})},[s]),R=F.reduce((e,n)=>e+n.weight,0),B=Math.abs(R-100)<.01;return n?(0,D.Y)("div",{css:ge,children:(0,D.FD)("div",{css:(0,y.AH)({display:"flex",alignItems:"center",gap:v.spacing.sm,padding:v.spacing.md},""),children:[(0,D.Y)(x.S,{size:"small"}),(0,D.Y)(Y.A,{id:"RyNXc+",defaultMessage:"Loading endpoint..."})]})}):t?(0,D.Y)("div",{css:pe,children:(0,D.Y)("div",{css:(0,y.AH)({padding:v.spacing.md},""),children:(0,D.Y)(w.Alert,{componentId:"mlflow.gateway.edit-endpoint.error",type:"error",message:null!==(U=t.message)&&void 0!==U?U:"Endpoint not found"})})}):(0,D.FD)("div",{css:ue,children:[(0,D.FD)("div",{css:(0,y.AH)({padding:v.spacing.md},""),children:[(0,D.FD)(w.Breadcrumb,{includeTrailingCaret:!0,children:[(0,D.Y)(w.Breadcrumb.Item,{children:(0,D.Y)(o.N_,{to:h.Ay.gatewayPageRoute,children:(0,D.Y)(Y.A,{id:"uABFy0",defaultMessage:"AI Gateway"})})}),(0,D.Y)(w.Breadcrumb.Item,{children:(0,D.Y)(o.N_,{to:h.Ay.gatewayPageRoute,children:(0,D.Y)(Y.A,{id:"eYZ/ZL",defaultMessage:"Endpoints"})})})]}),(0,D.FD)("div",{css:(0,y.AH)({marginTop:v.spacing.sm,display:"flex",justifyContent:"space-between",alignItems:"center"},""),children:[(0,D.Y)(oe,{endpoint:s,existingEndpoints:c,onNameUpdate:f,isSubmitting:i}),(0,D.Y)(x.B,{componentId:"mlflow.gateway.edit-endpoint.use-button",onClick:()=>_(!0),children:(0,D.Y)(Y.A,{id:"yLAJ6r",defaultMessage:"Use"})})]})]}),a&&(0,D.Y)("div",{css:(0,y.AH)({padding:`0 ${v.spacing.md}px`},""),children:(0,D.Y)(w.Alert,{componentId:"mlflow.gateway.edit-endpoint.mutation-error",closable:!1,message:l,type:"error",css:(0,y.AH)({marginBottom:v.spacing.md},"")})}),(0,D.FD)(w.Tabs.Root,{componentId:"mlflow.gateway.endpoint.tabs",value:C,onValueChange:e=>{k(n=>(n.set("tab",e),n),{replace:!0})},css:fe,children:[(0,D.Y)("div",{css:(0,y.AH)({paddingLeft:v.spacing.md,paddingRight:v.spacing.md},""),children:(0,D.FD)(w.Tabs.List,{children:[(0,D.Y)(w.Tabs.Trigger,{value:"configuration",children:(0,D.Y)(Y.A,{id:"qApcFv",defaultMessage:"Configuration"})}),P?(0,D.Y)(b.T,{componentId:"mlflow.gateway.endpoint.usage-tab-tooltip",content:S.formatMessage({id:"qa80t1",defaultMessage:"Enable Usage Tracking in the Configuration tab to view usage metrics"}),children:(0,D.Y)(w.Tabs.Trigger,{value:"usage",disabled:!0,children:(0,D.Y)(Y.A,{id:"0pY/4R",defaultMessage:"Usage"})})}):(0,D.Y)(w.Tabs.Trigger,{value:"usage",children:(0,D.Y)(Y.A,{id:"0pY/4R",defaultMessage:"Usage"})}),L?(0,D.Y)(b.T,{componentId:"mlflow.gateway.endpoint.traces-tab-tooltip",content:S.formatMessage({id:"xcmW/z",defaultMessage:"Enable Usage Tracking in the Configuration tab to view logs"}),children:(0,D.Y)(w.Tabs.Trigger,{value:"traces",disabled:!0,children:(0,D.Y)(Y.A,{id:"t/59XU",defaultMessage:"Logs"})})}):(0,D.Y)(w.Tabs.Trigger,{value:"traces",children:(0,D.Y)(Y.A,{id:"t/59XU",defaultMessage:"Logs"})})]})}),(0,D.FD)("div",{css:(0,y.AH)({flex:1,display:"flex",gap:v.spacing.md,padding:`${v.spacing.md}px`,overflow:"auto",backgroundColor:v.colors.backgroundPrimary},""),children:[(0,D.FD)("div",{css:he,children:[(0,D.Y)(w.Tabs.Content,{value:"configuration",children:(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:v.spacing.lg},""),children:[(0,D.FD)("div",{css:(0,y.AH)({padding:v.spacing.md,border:`1px solid ${v.colors.border}`,borderRadius:v.borders.borderRadiusMd,backgroundColor:v.colors.backgroundSecondary},""),children:[(0,D.Y)(x.T.Title,{level:3,children:(0,D.Y)(Y.A,{id:"t8zXLd",defaultMessage:"Priority 1 (Traffic Split)"})}),(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginTop:v.spacing.xs},""),children:(0,D.Y)(Y.A,{id:"Lh4Pv4",defaultMessage:"Models in this priority will be tested first, with traffic split load balancing"})}),(0,D.Y)("div",{css:(0,y.AH)({marginTop:v.spacing.lg},""),children:(0,D.Y)(d.xI,{control:e.control,name:"trafficSplitModels",render:({field:e})=>(0,D.Y)(E,{value:e.value,onChange:e.onChange,componentIdPrefix:"mlflow.gateway.edit-endpoint.traffic-split"})})})]}),(0,D.FD)("div",{css:(0,y.AH)({padding:v.spacing.md,border:`1px solid ${v.colors.border}`,borderRadius:v.borders.borderRadiusMd,backgroundColor:v.colors.backgroundSecondary},""),children:[(0,D.Y)(x.T.Title,{level:3,children:(0,D.Y)(Y.A,{id:"RMdf6R",defaultMessage:"Priority 2 (Fallback)"})}),(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({display:"block",marginTop:v.spacing.xs},""),children:(0,D.Y)(Y.A,{id:"nF/4Eh",defaultMessage:"Models in this priority will be tested second, after models in Priority 1 have failed. Models will be attempted in order from top to bottom."})}),(0,D.Y)("div",{css:(0,y.AH)({marginTop:v.spacing.lg},""),children:(0,D.Y)(d.xI,{control:e.control,name:"fallbackModels",render:({field:e})=>(0,D.Y)(X,{value:e.value,onChange:e.onChange,componentIdPrefix:"mlflow.gateway.edit-endpoint.fallback"})})})]}),(0,D.FD)("div",{css:(0,y.AH)({padding:v.spacing.md,border:`1px solid ${v.colors.border}`,borderRadius:v.borders.borderRadiusMd,backgroundColor:v.colors.backgroundSecondary},""),children:[(0,D.Y)(x.T.Title,{level:3,children:(0,D.Y)(Y.A,{id:"p8KS2c",defaultMessage:"Usage Tracking"})}),(0,D.Y)("div",{css:(0,y.AH)({marginTop:v.spacing.md},""),children:(0,D.Y)(d.xI,{control:e.control,name:"usageTracking",render:({field:e})=>(0,D.Y)(Q.O,{value:e.value,onChange:e.onChange,componentIdPrefix:"mlflow.gateway.edit-endpoint.usage-tracking"})})})]}),(0,D.FD)("div",{css:(0,y.AH)({padding:v.spacing.md,border:`2px dashed ${v.colors.actionDefaultBorderDefault}`,borderRadius:v.borders.borderRadiusMd,backgroundColor:v.colors.backgroundPrimary,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},""),children:[(0,D.Y)(x.T.Text,{bold:!0,children:(0,D.Y)(Y.A,{id:"oxHklW",defaultMessage:"Rate Limiting"})}),(0,D.Y)(x.T.Text,{color:"secondary",css:(0,y.AH)({fontSize:v.typography.fontSizeSm},""),children:(0,D.Y)(Y.A,{id:"jLHxac",defaultMessage:"Coming Soon"})})]})]})}),(0,D.Y)(w.Tabs.Content,{value:"usage",children:$&&(0,D.Y)(de,{experimentId:$,tooltipLinkUrlBuilder:N})}),(0,D.Y)(w.Tabs.Content,{value:"traces",css:ve,children:$&&(0,D.Y)(re.k,{children:(0,D.Y)(me,{experimentId:$})})})]}),"traces"!==C&&(0,D.Y)("div",{css:ye,children:(0,D.Y)(M.v,{title:S.formatMessage({id:"mi7FdJ",defaultMessage:"Summary"}),children:(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:v.spacing.md},""),children:[F.length>0&&(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:v.spacing.xs},""),children:[(0,D.Y)(x.T.Text,{bold:!0,color:"secondary",children:(0,D.Y)(Y.A,{id:"mz/gog",defaultMessage:"Traffic Split"})}),F.map((e,n)=>(0,D.Y)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:v.spacing.xs,fontSize:v.typography.fontSizeSm},""),children:(0,D.FD)(x.T.Text,{css:(0,y.AH)({fontSize:v.typography.fontSizeSm},""),children:[e.provider&&e.modelName?`${e.provider}/${e.modelName}`:`Model ${n+1}`," ","- ",e.weight,"%"]})},n))]}),H.length>0&&(0,D.FD)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:v.spacing.xs},""),children:[(0,D.Y)(x.T.Text,{bold:!0,color:"secondary",children:(0,D.Y)(Y.A,{id:"b6hjrM",defaultMessage:"Fallback Models"})}),H.map((e,n)=>(0,D.Y)("div",{css:(0,y.AH)({display:"flex",flexDirection:"column",gap:v.spacing.xs,fontSize:v.typography.fontSizeSm},""),children:(0,D.FD)(x.T.Text,{css:(0,y.AH)({fontSize:v.typography.fontSizeSm},""),children:[n+1,"."," ",e.provider&&e.modelName?`${e.provider}/${e.modelName}`:`Model ${n+1}`]})},n))]})]})})})]})]}),"configuration"===C&&(0,D.FD)("div",{css:(0,y.AH)({display:"flex",justifyContent:"flex-end",gap:v.spacing.sm,padding:v.spacing.md,borderTop:`1px solid ${v.colors.border}`,flexShrink:0},""),children:[(0,D.Y)(x.B,{componentId:"mlflow.gateway.edit-endpoint.cancel",onClick:u,children:(0,D.Y)(Y.A,{id:"qz9XeG",defaultMessage:"Cancel"})}),(0,D.Y)(b.T,{componentId:"mlflow.gateway.edit-endpoint.save-tooltip",content:!m&&F.length>0&&!B?S.formatMessage({id:"3YddwH",defaultMessage:"Traffic split percentages must total 100%"}):m?g?void 0:S.formatMessage({id:"eANdPU",defaultMessage:"No changes to save"}):S.formatMessage({id:"Lw+dTL",defaultMessage:"Please configure at least one model in traffic split"}),children:(0,D.Y)(x.B,{componentId:"mlflow.gateway.edit-endpoint.save",type:"primary",onClick:e.handleSubmit(p),loading:i,disabled:!m||!g,children:(0,D.Y)(Y.A,{id:"NVDxng",defaultMessage:"Save changes"})})})]}),(0,D.Y)(ee,{open:T,onClose:()=>_(!1),endpointName:(null===s||void 0===s?void 0:s.name)||""})]});var U};var we=(0,t.X)(a.A.mlflowServices.EXPERIMENTS,()=>{const{endpointId:e}=(0,o.g)(),{form:n,isLoadingEndpoint:i,isSubmitting:t,loadError:a,mutationError:l,endpoint:r,existingEndpoints:s,isFormComplete:c,hasChanges:m,handleSubmit:g,handleCancel:p,handleNameUpdate:u}=v(null!==e&&void 0!==e?e:"");return(0,D.Y)(d.Op,{...n,children:(0,D.Y)(xe,{form:n,isLoadingEndpoint:i,isSubmitting:t,loadError:a,mutationError:l,errorMessage:(0,f.m)(l),endpoint:r,existingEndpoints:s,isFormComplete:c,hasChanges:m,onSubmit:g,onCancel:p,onNameUpdate:u})})})},62593:function(e,n,i){i.d(n,{Y:function(){return M}});var o=i(68248),t=i(46709),a=i(27757),d=i(40724),l=i(79444),r=i(14429),s=i(84411),c=i(25889),m=i(34421),g=i(36120),p=i(48123),u=i(40263),f=i(26415),h=i(94473),v=i(82719),y=i(69983),x=i(4286),w=i(93281),b=i(83110),Y=i(73408);const A=({experimentIds:e,showTokenStats:n=!1,additionalControls:i,hideTooltipLinks:l=!1,tooltipLinkUrlBuilder:A,tooltipLinkText:M,filters:S})=>{const{theme:I}=(0,a.u)(),[k,T]=(0,t.useState)(null),[_]=(0,r.VA)(),C=_.startTime?new Date(_.startTime).getTime():void 0,D=_.endTime?new Date(_.endTime).getTime():void 0,F=(0,w.N3)(C,D),H=null!==k&&void 0!==k?k:F,$=w.ZG[H],P=(0,t.useMemo)(()=>(0,b.yB)(C,D,$),[C,D,$]);return(0,Y.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:I.spacing.md},""),children:[(0,Y.FD)("div",{css:(0,o.AH)({display:"flex",alignItems:"center",gap:I.spacing.sm,flexWrap:"wrap"},""),children:[i,(0,Y.Y)(x.l,{value:H,onChange:T,startTimeMs:C,endTimeMs:D,allowClear:null!==k&&k!==F,onClear:()=>T(null)}),(0,Y.Y)(s.$,{excludeOptions:["ALL"]})]}),(0,Y.Y)(y.F7,{experimentIds:e,startTimeMs:C,endTimeMs:D,timeIntervalSeconds:$,timeBuckets:P,hideTooltipLinks:l,tooltipLinkUrlBuilder:A,tooltipLinkText:M,filters:S,children:(0,Y.FD)("div",{css:(0,o.AH)({display:"flex",flexDirection:"column",gap:I.spacing.md},""),children:[(0,Y.Y)(c.a,{title:(0,Y.Y)(d.A,{id:"6ejdmD",defaultMessage:"Requests"})}),(0,Y.FD)(v.vK,{children:[(0,Y.Y)(m.K,{}),(0,Y.Y)(g.L,{})]}),n?(0,Y.FD)(v.vK,{children:[(0,Y.Y)(p.o,{}),(0,Y.Y)(u.A,{title:(0,Y.Y)(d.A,{id:"WHwU2F",defaultMessage:"Tokens per Request"}),subtitle:(0,Y.Y)(d.A,{id:"A+GxQM",defaultMessage:"avg per request"})})]}):(0,Y.Y)(p.o,{}),(0,Y.FD)(v.vK,{children:[(0,Y.Y)(f.q,{}),(0,Y.Y)(h.m,{})]})]})})]})},M=e=>(0,Y.Y)(l.k,{children:(0,Y.Y)(A,{...e})})},91113:function(e,n,i){i.d(n,{h:function(){return l}});var o=i(36476),t=i(77153),a=i(24523);class d{}d.mlflowServices={MODEL_REGISTRY:"Model Registry",EXPERIMENTS:"Experiments",CHAT_SESSIONS:"Chat Sessions",MODEL_SERVING:"Model Serving",RUN_TRACKING:"Run Tracking"};const l=(e,n)=>{if(!(e instanceof t.s))return;const{status:i}=e;let d;const l={status:i};e.getErrorCode()===a.tG.RESOURCE_DOES_NOT_EXIST&&(d=new o.m_(l)),e.getErrorCode()===a.tG.PERMISSION_DENIED&&(d=new o.i_(l)),e.getErrorCode()===a.tG.INTERNAL_ERROR&&(d=new o.PO(l)),e.getErrorCode()===a.tG.INVALID_PARAMETER_VALUE&&(d=new o.v7(l));const r=e.getMessageField();return d&&r&&(d.message=r),d};n.A=d}}]);