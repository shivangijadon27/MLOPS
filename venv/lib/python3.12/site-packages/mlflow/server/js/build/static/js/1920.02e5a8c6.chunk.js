"use strict";(self.webpackChunk_mlflow_mlflow=self.webpackChunk_mlflow_mlflow||[]).push([[1920],{27042:function(e,t,s){s.d(t,{Q:function(){return A}});var o=s(68248),a=s(76118),i=s(46709),n=s(27757),r=s(79081),l=s(82716),d=s(7655),c=s(40724),g=s(884),m=s(73408);var h={name:"4zleql",styles:"display:block"};function u(e){return t=>function(e,t){const s=(0,d.A)(),{theme:c}=(0,n.u)(),g=e.props.searchValue.toLowerCase();return(0,i.useMemo)(()=>{if(!g)return e;if((0,a.sortedIndexOf)(t,g)>=0)return e;const n=/^[^,.:/=\-\s]+$/.test(g);return i.cloneElement(e,{flattenOptions:[{data:{value:g,disabled:!n,style:{color:n?c.colors.actionTertiaryTextDefault:c.colors.actionDisabledText},children:(0,m.Y)(r.T,{content:n?void 0:s.formatMessage({id:"fWEvZL",defaultMessage:", . : / - = and blank spaces are not allowed"}),componentId:"mlflow.common.components.tag-select-dropdown.add-new-tag-tooltip",side:"right",children:(0,m.FD)("span",{css:h,children:[(0,m.Y)(l.PlusIcon,{css:(0,o.AH)({marginRight:c.spacing.sm},"")}),s.formatMessage({id:"IJbauF",defaultMessage:'Add tag "{tagKey}"'},{tagKey:g})]})})},key:g,groupOption:!1},...e.props.flattenOptions]})},[t,e,g,s,c])}(t,e)}var p={name:"1d3w5wq",styles:"width:100%"};function f({allAvailableTags:e,control:t,onKeyChangeCallback:s}){const o=(0,d.A)(),[a,n]=(0,i.useState)(!1),r=(0,i.useRef)(null),{field:c,fieldState:h}=(0,g.as)({control:t,name:"key",rules:{required:{message:o.formatMessage({id:"RlBbjb",defaultMessage:"A tag key is required"}),value:!0}}});return(0,m.Y)(l.LegacySelect,{allowClear:!0,ref:r,dangerouslySetAntdProps:{showSearch:!0,dropdownRender:u(e)},css:p,placeholder:o.formatMessage({id:"8ALhnh",defaultMessage:"Type a key"}),value:c.value,defaultValue:c.value,open:a,onDropdownVisibleChange:e=>{n(e)},filterOption:(e,t)=>null===t||void 0===t?void 0:t.value.toLowerCase().includes(e.toLowerCase()),onSelect:e=>{c.onChange(e),null===s||void 0===s||s(e)},onClear:()=>{c.onChange(void 0),null===s||void 0===s||s(void 0)},validationState:h.error?"error":void 0,children:e.map(e=>(0,m.Y)(l.LegacySelect.Option,{value:e,children:e},e))})}var v=s(59281),S=s(77153);function M(e){return new Map(e.map(e=>[e.key,e]))}var y={name:"82a6rk",styles:"flex:1"},_={name:"82a6rk",styles:"flex:1"};const A=({onSuccess:e,saveTagsHandler:t,allAvailableTags:s,valueRequired:h=!1,title:u})=>{const p=(0,i.useRef)(),[A,C]=(0,i.useState)(""),{theme:k}=(0,n.u)(),[T,b]=(0,i.useState)(new Map),[x,R]=(0,i.useState)(new Map),[I,P]=(0,i.useState)(!1),Y=(0,g.mN)({defaultValues:{key:void 0,value:""}}),E=()=>P(!1),D=(0,i.useCallback)(e=>{p.current=e,b(M(e.tags||[])),R(M(e.tags||[])),Y.reset(),P(!0)},[Y]),N=async()=>{p.current&&(C(""),L(!0),t(p.current,Array.from(T.values()),Array.from(x.values())).then(()=>{E(),null===e||void 0===e||e(),L(!1)}).catch(e=>{var t;L(!1),C(e instanceof S.s?null===(t=e.getUserVisibleError())||void 0===t?void 0:t.message:e.message)}))},F=(0,d.A)(),V=Y.watch(),[B,L]=(0,i.useState)(!1),K=(0,i.useMemo)(()=>!(0,a.isEqual)((0,a.sortBy)(Array.from(T.values()),"key"),(0,a.sortBy)(Array.from(x.values()),"key")),[T,x]),O=V.key||V.value,U=K&&O;return{EditTagsModal:(0,m.FD)(r.d,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_135",destroyOnClose:!0,visible:I,title:null!==u&&void 0!==u?u:(0,m.Y)(c.A,{id:"TBX+Gs",defaultMessage:"Add/Edit tags"}),onCancel:E,footer:(0,m.FD)(n.x,{children:[(0,m.Y)(n.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_147",dangerouslyUseFocusPseudoClass:!0,onClick:E,css:(0,o.AH)({marginRight:K?0:k.spacing.sm},""),children:F.formatMessage({id:"2a/rR8",defaultMessage:"Cancel"})}),U?(0,m.Y)(w,{formValues:V,isLoading:B,onSaveTask:N}):(0,m.Y)(r.T,{content:K?void 0:F.formatMessage({id:"16onEc",defaultMessage:"Please add or remove one or more tags before saving"}),componentId:"mlflow.common.hooks.useeditkeyvaluetagsmodal.tooltip",children:(0,m.Y)(n.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_174",dangerouslyUseFocusPseudoClass:!0,disabled:!K,loading:B,type:"primary",onClick:N,children:F.formatMessage({id:"801Xh4",defaultMessage:"Save tags"})})})]}),children:[(0,m.FD)("form",{onSubmit:Y.handleSubmit(()=>{if(h&&!V.value.trim())return;const e=new Map(x);e.set(V.key,V),R(e),Y.reset()}),css:(0,o.AH)({display:"flex",alignItems:"flex-end",gap:k.spacing.md},""),children:[(0,m.FD)("div",{css:(0,o.AH)({minWidth:0,display:"flex",gap:k.spacing.md,flex:1},""),children:[(0,m.FD)("div",{css:y,children:[(0,m.Y)(l.FormUI.Label,{htmlFor:"key",children:F.formatMessage({id:"crTWax",defaultMessage:"Key"})}),(0,m.Y)(f,{allAvailableTags:s||[],control:Y.control,onKeyChangeCallback:e=>{var t;const s=e?x.get(e):void 0;Y.setValue("value",null!==(t=null===s||void 0===s?void 0:s.value)&&void 0!==t?t:"")}})]}),(0,m.FD)("div",{css:_,children:[(0,m.Y)(l.FormUI.Label,{htmlFor:"value",children:h?F.formatMessage({id:"tHrp+A",defaultMessage:"Value"}):F.formatMessage({id:"4B8k46",defaultMessage:"Value (optional)"})}),(0,m.Y)(l.RHFControlledComponents.Input,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_223",name:"value",control:Y.control,"aria-label":h?F.formatMessage({id:"tHrp+A",defaultMessage:"Value"}):F.formatMessage({id:"4B8k46",defaultMessage:"Value (optional)"}),placeholder:F.formatMessage({id:"FFe+Ug",defaultMessage:"Type a value"})})]})]}),(0,m.Y)(r.T,{content:F.formatMessage({id:"tx3aAM",defaultMessage:"Add tag"}),componentId:"mlflow.common.hooks.useeditkeyvaluetagsmodal.add-tag-tooltip",children:(0,m.Y)(n.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_248",htmlType:"submit","aria-label":F.formatMessage({id:"tx3aAM",defaultMessage:"Add tag"}),children:(0,m.Y)(l.PlusIcon,{})})})]}),A&&(0,m.Y)(l.FormUI.Message,{type:"error",message:A}),(0,m.Y)("div",{css:(0,o.AH)({display:"flex",rowGap:k.spacing.xs,flexWrap:"wrap",marginTop:k.spacing.sm},""),children:Array.from(x.values()).map(e=>(0,m.Y)(v.t,{isClosable:!0,tag:e,onClose:()=>(({key:e})=>{R(t=>(t.delete(e),new Map(t)))})(e)},e.key))})]}),showEditTagsModal:D,isLoading:B}};var C={name:"1y0ex1",styles:"max-width:400px"};function w({isLoading:e,formValues:t,onSaveTask:s}){const i=(0,d.A)(),{theme:r}=(0,n.u)(),l=`${`${(0,a.truncate)(t.key,{length:20})||"_"}`}${t.value?`:${(0,a.truncate)(t.value,{length:20})}`:""}`,c=i.formatMessage({id:"wcSVYI",defaultMessage:'Are you sure you want to save and close without adding "{tag}"'},{tag:l});return(0,m.FD)(n.aw.Root,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_309",children:[(0,m.Y)(n.aw.Trigger,{asChild:!0,children:(0,m.Y)(n.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_306",dangerouslyUseFocusPseudoClass:!0,loading:e,type:"primary",children:i.formatMessage({id:"801Xh4",defaultMessage:"Save tags"})})}),(0,m.FD)(n.aw.Content,{align:"end","aria-label":c,children:[(0,m.Y)(n.T.Paragraph,{css:C,children:c}),(0,m.Y)(n.aw.Close,{asChild:!0,children:(0,m.Y)(n.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_316",onClick:s,children:i.formatMessage({id:"mv6CY3",defaultMessage:"Yes, save and close"})})}),(0,m.Y)(n.aw.Close,{asChild:!0,children:(0,m.Y)(n.B,{componentId:"codegen_mlflow_app_src_common_hooks_useeditkeyvaluetagsmodal.tsx_324",type:"primary",css:(0,o.AH)({marginLeft:r.spacing.sm},""),children:i.formatMessage({id:"geizp1",defaultMessage:"Cancel"})})}),(0,m.Y)(n.aw.Arrow,{})]})]})}},29519:function(e,t,s){s.r(t),s.d(t,{ModelPage:function(){return fe},ModelPageImpl:function(){return he},default:function(){return ve},getOrderByExpr:function(){return me}});var o=s(46709),a=s(56530),i=s(99213),n=s(76256),r=s(27757),l=s(79081),d=s(82716),c=s(90061),g=s(43617),m=s(40724),h=s(7655),u=s(24523),p=s(673),f=s(91105),v=s(27206),S=s(11522),M=s(68248),y=s(59281),_=s(73408);const A=({tags:e=[],onAddEdit:t})=>{const{theme:s}=(0,r.u)();return(0,_.Y)("div",{css:(0,M.AH)({display:"flex",flexWrap:"wrap","> *":{marginRight:"0 !important"},gap:s.spacing.xs},""),children:e.length<1?(0,_.Y)(r.B,{componentId:"codegen_mlflow_app_src_common_components_keyvaluetagseditorcell.tsx_29",size:"small",type:"link",onClick:t,children:(0,_.Y)(m.A,{id:"Li72QU",defaultMessage:"Add"})}):(0,_.FD)(_.FK,{children:[e.map(e=>(0,_.Y)(y.t,{tag:e},`${e.key}-${e.value}`)),(0,_.Y)(r.B,{componentId:"codegen_mlflow_app_src_common_components_keyvaluetagseditorcell.tsx_37",size:"small",icon:(0,_.Y)(d.PencilIcon,{}),onClick:t})]})})};var C=s(27042),w=s(3469),k=s(52471),T=s(63908),b=s(54871);var x=function(e){return e.STATUS="status",e.VERSION="version",e.CREATION_TIMESTAMP="creation_timestamp",e.USER_ID="user_id",e.TAGS="tags",e.STAGE="current_stage",e.DESCRIPTION="description",e.ALIASES="aliases",e}(x||{});const R=e=>(0,_.Y)(m.A,{id:"4Jyn2b",defaultMessage:"Add/Edit alias for model version {version}",values:{version:e}});var I={name:"10lkuaq",styles:".table-row-select-cell{align-items:flex-start;}"};const P=({modelName:e,modelVersions:t,activeStageOnly:s,orderByAsc:M,orderByKey:y,onSortChange:P,onChange:Y,getSortFieldName:E,modelEntity:D,onMetadataUpdated:N,usingNextModelsUI:F,aliases:V,pagination:B,isLoading:L})=>{var K;const O=(0,o.useMemo)(()=>{const e={};return null===V||void 0===V||V.forEach(({alias:t,version:s})=>{e[s]||(e[s]=[]),e[s].push(t)}),e},[V]),U=(0,o.useMemo)(()=>s?(t||[]).filter(({current_stage:e})=>p.jI.includes(e)):t,[s,t]),{theme:H}=(0,r.u)(),q=(0,h.A)(),j=(0,o.useMemo)(()=>{const e=(null===U||void 0===U?void 0:U.map(e=>(null===e||void 0===e?void 0:e.tags)||[]).flat())||[];return Array.from(new Set(e.map(({key:e})=>e))).sort()},[U]),W=(0,a.wA)(),{EditTagsModal:G,showEditTagsModal:$}=(0,C.Q)({allAvailableTags:j,saveTagsHandler:async(e,t,s)=>W((0,i.kM)(e,t,s)),onSuccess:N}),{EditAliasesModal:z,showEditAliasesModal:J}=(0,w.t)({aliases:null!==(K=null===D||void 0===D?void 0:D.aliases)&&void 0!==K?K:[],onSuccess:N,onSave:async(t,s,o)=>W((0,i.mq)(e,t,s,o)),getTitle:R,description:(0,_.Y)(m.A,{id:"2DNVN4",defaultMessage:"Aliases allow you to assign a mutable, named reference to a particular model version. <link>Learn more</link>",values:{link:e=>(0,_.Y)("a",{href:p.Tm,rel:"noreferrer",target:"_blank",children:e})}})}),[Z,X]=(0,o.useState)({});(0,b.Gt)("selectedModelVersions",Z),(0,o.useEffect)(()=>{const e=(U||[]).filter(({version:e})=>Z[e]),t=e.map(({version:e})=>e);Y(t,e)},[Z,Y,U]);const Q=(0,o.useMemo)(()=>{const t=[{id:x.STATUS,enableSorting:!1,header:"",meta:{styles:{flexBasis:H.general.heightSm,flexGrow:0}},cell:({row:{original:e}})=>{const{status:t,status_message:s}=e||{};return(0,_.Y)(l.T,{componentId:"mlflow.model-registry.model-view.model-versions.version-status.tooltip",content:s||p.zr[t],children:(0,_.Y)("span",{children:(0,_.Y)(r.T.Text,{children:p.UA[t]})})})}}];return t.push({id:x.VERSION,enableSorting:!1,header:q.formatMessage({id:"1f72BQ",defaultMessage:"Version"}),meta:{className:"model-version"},accessorKey:"version",cell:({getValue:t})=>(0,_.Y)(m.A,{id:"yjerKR",defaultMessage:"<link>Version {versionNumber}</link>",values:{link:s=>(0,_.Y)(f.N_,{to:v.fM.getModelVersionPageRoute(e,String(t())),children:s}),versionNumber:t()}})},{id:x.CREATION_TIMESTAMP,enableSorting:!0,meta:{styles:{minWidth:200}},header:q.formatMessage({id:"Nm/Pjx",defaultMessage:"Registered at"}),accessorKey:"creation_timestamp",cell:({getValue:e})=>S.A.formatTimestamp(e(),q)},{id:x.USER_ID,enableSorting:!1,meta:{styles:{minWidth:100}},header:q.formatMessage({id:"xRw7H2",defaultMessage:"Created by"}),accessorKey:"user_id",cell:({getValue:e})=>(0,_.Y)("span",{children:e()})}),F?t.push({id:x.TAGS,enableSorting:!1,header:q.formatMessage({id:"7NOp4F",defaultMessage:"Tags"}),meta:{styles:{flex:2}},accessorKey:"tags",cell:({getValue:e,row:{original:t}})=>(0,_.Y)(A,{tags:e(),onAddEdit:()=>{null===$||void 0===$||$(t)}})},{id:x.ALIASES,accessorKey:"aliases",enableSorting:!1,header:q.formatMessage({id:"wNHR0W",defaultMessage:"Aliases"}),meta:{styles:{flex:2},multiline:!0},cell:({getValue:t,row:{original:s}})=>{const o=O[s.version]||[];return(0,_.Y)(k.Y,{modelName:e,version:s.version,aliases:o,onAddEdit:()=>{null===J||void 0===J||J(s.version)}})}}):t.push({id:x.STAGE,enableSorting:!1,header:q.formatMessage({id:"7F/CBv",defaultMessage:"Stage"}),accessorKey:"current_stage",cell:({getValue:e})=>p.$0[e()]}),t.push({id:x.DESCRIPTION,enableSorting:!1,header:q.formatMessage({id:"Vm9CvZ",defaultMessage:"Description"}),meta:{styles:{flex:2}},accessorKey:"description",cell:({getValue:e})=>(0,T.Y7)(e(),32)}),t},[H,q,e,$,J,F,O]),ee=[{id:y,desc:!M}],te=(0,n.L)("mlflow/server/js/src/model-registry/components/ModelVersionTable.tsx",{data:U||[],columns:Q,state:{rowSelection:Z,sorting:ee},getCoreRowModel:(0,c.HT)(),getSortedRowModel:(0,c.h5)(),getRowId:({version:e})=>e,onRowSelectionChange:X,onSortingChange:e=>{const[t]="function"===typeof e?e(ee):e;t&&P({sorter:t})}}),se=(0,_.Y)(d.Empty,{description:(0,_.Y)(m.A,{id:"ynkoR7",defaultMessage:"No models versions are registered yet. <link>Learn more</link> about how to register a model version.",values:{link:e=>(0,_.Y)(r.T.Link,{componentId:"codegen_mlflow_app_src_model-registry_components_modelversiontable.tsx_425",target:"_blank",href:u.gw,children:e})}}),image:(0,_.Y)(d.PlusIcon,{})});return(0,_.FD)(_.FK,{children:[(0,_.FD)(d.Table,{"data-testid":"model-version-table",pagination:B,scrollable:!0,empty:0===te.getRowModel().rows.length?se:void 0,someRowsSelected:te.getIsSomeRowsSelected()||te.getIsAllRowsSelected(),children:[(0,_.FD)(d.TableRow,{isHeader:!0,children:[(0,_.Y)(d.TableRowSelectCell,{componentId:"codegen_mlflow_app_src_model-registry_components_modelversiontable.tsx_450",checked:te.getIsAllRowsSelected(),indeterminate:te.getIsSomeRowsSelected(),onChange:te.getToggleAllRowsSelectedHandler()}),te.getLeafHeaders().map(e=>{var t;return(0,_.Y)(d.TableHeader,{componentId:"codegen_mlflow_app_src_model-registry_components_modelversiontable.tsx_458",multiline:!1,sortable:e.column.getCanSort(),sortDirection:e.column.getIsSorted()||"none",onToggleSort:()=>{const[t]=ee,s=!!(e.column.id===t.id)&&!t.desc;e.column.toggleSorting(s)},css:null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.styles,children:(0,g.Kv)(e.column.columnDef.header,e.getContext())},e.id)})]}),L?(0,_.Y)(d.TableSkeletonRows,{table:te}):te.getRowModel().rows.map(e=>(0,_.FD)(d.TableRow,{css:I,children:[(0,_.Y)(d.TableRowSelectCell,{componentId:"codegen_mlflow_app_src_model-registry_components_modelversiontable.tsx_477",checked:e.getIsSelected(),onChange:e.getToggleSelectedHandler()}),e.getAllCells().map(e=>{var t,s,o;return(0,_.Y)(d.TableCell,{className:null===(t=e.column.columnDef.meta)||void 0===t?void 0:t.className,multiline:null===(s=e.column.columnDef.meta)||void 0===s?void 0:s.multiline,css:null===(o=e.column.columnDef.meta)||void 0===o?void 0:o.styles,children:(0,g.Kv)(e.column.columnDef.cell,e.getContext())},e.id)})]},e.id))]}),G,z]})};var Y=s(45966),E=s(52644),D=s(71647),N=s(61349),F=s(10536),V=s(84173),B=s(32898),L=s(74151),K=s(31655),O=s(58340),U=s(12769),H=s(77153),q=s(76118);const j="ALL",W="ACTIVE";var G={name:"lugakg",styles:"font-weight:normal"},$={name:"1ootkdu",styles:"margin-bottom:8px;display:flex;justify-content:flex-end"},z={name:"18e72da",styles:"width:100%;align-items:center;display:flex"},J={name:"70euf1",styles:"display:flex;justify-content:flex-end;margin-top:8px"};class Z extends o.Component{constructor(e){super(e),this.state={maxResultsSelection:p.Wb,stageFilter:j,showDescriptionEditor:!1,isDeleteModalVisible:!1,isDeleteModalConfirmLoading:!1,runsSelected:{},isTagsRequestPending:!1,updatingEmailPreferences:!1,isTagAssignmentModalVisible:!1,isSavingTags:!1,tagSavingError:void 0},this.formRef=o.createRef(),this.sharedTaggingUIEnabled=(0,K.V0)(),this.handleSetMaxResult=({key:e})=>{this.props.onSetMaxResult(e)},this.getSortFieldName=e=>"creation_timestamp"===e?p.$c:null,this.handleSortChange=e=>{const t=e.sorter;this.props.onClickSortableColumn(this.getSortFieldName(t.id),t.desc)},this.handleStageFilterChange=e=>{this.setState({stageFilter:e.target.value})},this.handleCancelEditDescription=()=>{this.setState({showDescriptionEditor:!1})},this.handleSubmitEditDescription=e=>this.props.handleEditDescription(e).then(()=>{this.setState({showDescriptionEditor:!1})}),this.startEditingDescription=e=>{e.stopPropagation(),this.setState({showDescriptionEditor:!0})},this.showDeleteModal=()=>{this.setState({isDeleteModalVisible:!0})},this.hideDeleteModal=()=>{this.setState({isDeleteModalVisible:!1})},this.showConfirmLoading=()=>{this.setState({isDeleteModalConfirmLoading:!0})},this.hideConfirmLoading=()=>{this.setState({isDeleteModalConfirmLoading:!1})},this.handleDeleteConfirm=()=>{const{navigate:e}=this.props;this.showConfirmLoading(),this.props.handleDelete().then(()=>{e(v.fM.modelListPageRoute)}).catch(e=>{this.hideConfirmLoading(),S.A.logErrorAndNotifyUser(e)})},this.getTags=()=>(0,q.sortBy)(S.A.getVisibleTagValues(this.props.tags).map(e=>({key:e[0],name:e[0],value:e[1]})),"name"),this.handleEditTags=()=>{this.setState({isTagAssignmentModalVisible:!0,tagSavingError:void 0})},this.handleCloseTagAssignmentModal=()=>{this.setState({isTagAssignmentModalVisible:!1,tagSavingError:void 0})},this.handleAddTag=e=>{const t=this.formRef.current,{model:s}=this.props,o=s.name;this.setState({isTagsRequestPending:!0}),this.props.setRegisteredModelTagApi(o,e.name,e.value).then(()=>{this.setState({isTagsRequestPending:!1}),t.resetFields()}).catch(e=>{this.setState({isTagsRequestPending:!1}),console.error(e);const t=e instanceof H.s?e.getMessageField():e.message;S.A.displayGlobalErrorNotification("Failed to add tag. Error: "+t)})},this.handleSaveEdit=({name:e,value:t})=>{const{model:s}=this.props,o=s.name;return this.props.setRegisteredModelTagApi(o,e,t).catch(e=>{console.error(e);const t=e instanceof H.s?e.getMessageField():e.message;S.A.displayGlobalErrorNotification("Failed to set tag. Error: "+t)})},this.handleDeleteTag=({name:e})=>{const{model:t}=this.props,s=t.name;return this.props.deleteRegisteredModelTagApi(s,e).catch(e=>{console.error(e);const t=e instanceof H.s?e.getMessageField():e.message;S.A.displayGlobalErrorNotification("Failed to delete tag. Error: "+t)})},this.handleSaveTags=(e,t)=>{this.setState({isSavingTags:!0});const{model:s}=this.props,o=s.name,a=e.map(({key:e,value:t})=>this.props.setRegisteredModelTagApi(o,e,t)),i=t.map(({key:e})=>this.props.deleteRegisteredModelTagApi(o,e));return Promise.all([...a,...i]).then(()=>{this.setState({isSavingTags:!1})}).catch(e=>{const t=e instanceof H.s?e.getMessageField():e.message;this.setState({isSavingTags:!1,tagSavingError:t})})},this.onChange=(e,t)=>{const s=Object.assign({},this.state);s.runsSelected={},t.forEach(e=>{s.runsSelected={...s.runsSelected,[e.version]:e.run_id}}),this.setState(s)},this.renderDetails=()=>{const{model:e,modelVersions:t,tags:s,currentPage:o,nextPageToken:a}=this.props,{stageFilter:i,showDescriptionEditor:n,isDeleteModalVisible:c,isDeleteModalConfirmLoading:g,isTagsRequestPending:h}=this.state,u=e.name,p=Object.keys(this.state.runsSelected).length<2;return(0,_.FD)("div",{css:Q.wrapper,children:[(0,_.FD)(B.K,{columns:3,"data-testid":"model-view-metadata",children:[(0,_.Y)(B.K.Item,{"data-testid":"model-view-metadata-item",label:this.props.intl.formatMessage({id:"At3XhS",defaultMessage:"Created Time"}),children:S.A.formatTimestamp(e.creation_timestamp,this.props.intl)}),(0,_.Y)(B.K.Item,{"data-testid":"model-view-metadata-item",label:this.props.intl.formatMessage({id:"j/pJM6",defaultMessage:"Last Modified"}),children:S.A.formatTimestamp(e.last_updated_timestamp,this.props.intl)}),e.user_id&&(0,_.Y)(B.K.Item,{"data-testid":"model-view-metadata-item",label:this.props.intl.formatMessage({id:"1jPG5D",defaultMessage:"Creator"}),children:(0,_.Y)("div",{children:e.user_id})})]}),this.sharedTaggingUIEnabled&&(0,_.Y)(B.K,{columns:1,"data-testid":"model-view-tags",children:(0,_.Y)(B.K.Item,{label:"Tags",children:(0,_.Y)(L.L,{tags:this.getTags(),onEdit:this.handleEditTags})})}),(0,_.Y)(Y.i,{css:Q.collapsiblePanel,title:(0,_.FD)("span",{children:[(0,_.Y)(m.A,{id:"oHW+ks",defaultMessage:"Description"})," ",n?null:this.renderDescriptionEditIcon()]}),forceOpen:n,defaultCollapsed:!e.description,"data-testid":"model-description-section",children:(0,_.Y)(E.VY,{defaultMarkdown:e.description,onSubmit:this.handleSubmitEditDescription,onCancel:this.handleCancelEditDescription,showEditor:n})}),!this.sharedTaggingUIEnabled&&(0,_.Y)("div",{"data-testid":"tags-section",children:(0,_.Y)(Y.i,{css:Q.collapsiblePanel,title:(0,_.Y)(m.A,{id:"HyBP+D",defaultMessage:"Tags"}),defaultCollapsed:0===S.A.getVisibleTagValues(s).length,"data-testid":"model-tags-section",children:(0,_.Y)(D.h,{innerRef:this.formRef,handleAddTag:this.handleAddTag,handleDeleteTag:this.handleDeleteTag,handleSaveEdit:this.handleSaveEdit,tags:s,isRequestPending:h})})}),(0,_.FD)(Y.i,{css:Q.collapsiblePanel,title:(0,_.Y)(_.FK,{children:(0,_.FD)("div",{css:Q.versionsTabButtons,children:[(0,_.Y)("span",{children:(0,_.Y)(m.A,{id:"Z5en2d",defaultMessage:"Versions"})}),!this.props.usingNextModelsUI&&(0,_.FD)(d.SegmentedControlGroup,{componentId:"codegen_mlflow_app_src_model-registry_components_modelview.tsx_600",name:"stage-filter",value:this.state.stageFilter,onChange:e=>this.handleStageFilterChange(e),css:G,children:[(0,_.Y)(d.SegmentedControlButton,{value:j,children:(0,_.Y)(m.A,{id:"vi2MM7",defaultMessage:"All"})}),(0,_.FD)(d.SegmentedControlButton,{value:W,children:[(0,_.Y)(m.A,{id:"xPkIEE",defaultMessage:"Active"})," ",this.getActiveVersionsCount()]})]}),(0,_.Y)(r.B,{componentId:"codegen_mlflow_app_src_model-registry_components_modelview.tsx_619","data-testid":"compareButton",disabled:p,onClick:this.onCompare,children:(0,_.Y)(m.A,{id:"FpjDSq",defaultMessage:"Compare"})})]})}),"data-testid":"model-versions-section",children:[(0,K.WX)()&&(0,_.Y)("div",{css:$,children:(0,_.Y)(O.C,{})}),(0,_.Y)(P,{isLoading:this.props.loading||!1,activeStageOnly:i===W&&!this.props.usingNextModelsUI,modelName:u,modelVersions:t,modelEntity:e,onChange:this.onChange,onMetadataUpdated:this.props.onMetadataUpdated,usingNextModelsUI:this.props.usingNextModelsUI,aliases:null===e||void 0===e?void 0:e.aliases,orderByKey:this.props.orderByKey,orderByAsc:this.props.orderByAsc,onSortChange:this.handleSortChange,getSortFieldName:this.getSortFieldName,pagination:(0,_.Y)("div",{"data-testid":"model-view-pagination-section",css:z,children:(0,_.Y)("div",{css:J,children:(0,_.Y)(d.CursorPagination,{componentId:"codegen_mlflow_app_src_model-registry_components_modelview.tsx_646",hasNextPage:Boolean(a),hasPreviousPage:o>1,onNextPage:this.props.onClickNext,onPreviousPage:this.props.onClickPrev,pageSizeSelect:{onChange:e=>this.handleSetMaxResult({key:e}),default:this.props.maxResultValue,options:[10,25,50,100]}})})})})]}),(0,_.Y)(l.f,{componentId:"codegen_mlflow_app_src_model-registry_components_modelview.tsx_662","data-testid":"mlflow-input-modal",title:this.props.intl.formatMessage({id:"Gg/vLZ",defaultMessage:"Delete Model"}),visible:c,confirmLoading:g,onOk:this.handleDeleteConfirm,okText:this.props.intl.formatMessage({id:"a8rS4O",defaultMessage:"Delete"}),cancelText:this.props.intl.formatMessage({id:"yK/6vg",defaultMessage:"Cancel"}),onCancel:this.hideDeleteModal,children:(0,_.Y)("span",{children:(0,_.Y)(m.A,{id:"HUf9qJ",defaultMessage:"Are you sure you want to delete {modelName}? This cannot be undone.",values:{modelName:u}})})})]})},this.onCompare=this.onCompare.bind(this)}componentDidMount(){const e=`${this.props.model.name} - MLflow Model`;S.A.updatePageTitle(e)}getActiveVersionsCount(){const{modelVersions:e}=this.props;return e?e.filter(e=>p.jI.includes(e.current_stage)).length:0}getOverflowMenuItems(){return[{id:"delete",itemName:(0,_.Y)(m.A,{id:"9fVZg8",defaultMessage:"Delete"}),onClick:this.showDeleteModal,disabled:this.getActiveVersionsCount()>0}]}onCompare(){this.props.model&&this.props.navigate(v.fM.getCompareModelVersionsPageRoute(this.props.model.name,this.state.runsSelected))}renderDescriptionEditIcon(){return(0,_.Y)(r.B,{componentId:"codegen_mlflow_app_src_model-registry_components_modelview.tsx_467","data-testid":"descriptionEditButton",type:"link",css:Q.editButton,onClick:this.startEditingDescription,children:(0,_.Y)(m.A,{id:"36g3aR",defaultMessage:"Edit"})})}renderMainPanel(){return this.renderDetails()}render(){const{model:e}=this.props,t=e.name,s=[(0,_.Y)(f.N_,{to:v.fM.modelListPageRoute,children:(0,_.Y)(m.A,{id:"raa3Ij",defaultMessage:"Registered Models"})},"registered-models")];return(0,_.FD)("div",{children:[(0,_.Y)(F.z,{title:t,breadcrumbs:s,children:(0,_.Y)(F.o,{menu:this.getOverflowMenuItems()})}),this.renderMainPanel()]})}}const X={setRegisteredModelTagApi:i._e,deleteRegisteredModelTagApi:i.bE},Q={emailNotificationPreferenceDropdown:e=>({width:300,marginBottom:e.spacing.md}),emailNotificationPreferenceTip:e=>({paddingLeft:e.spacing.sm,paddingRight:e.spacing.sm}),collapsiblePanel:e=>({marginBottom:e.spacing.md}),wrapper:e=>({'div[role="button"][aria-expanded]':{height:e.general.buttonHeight}}),editButton:e=>({marginLeft:e.spacing.md}),versionsTabButtons:e=>({display:"flex",gap:e.spacing.md,alignItems:"center"})},ee=(0,a.Ng)((e,t)=>{const s=t.model.name;return{tags:(0,N.ZG)(s,e)}},X)((0,U.p)((0,V.Ay)(Z)));var te=s(58355),se=s(54401),oe=s(74264),ae=s(86904),ie=s(42110),ne=s(43233),re=s(2560),le=s(55570),de=s(91113);function ce(e){return te.A.getSessionScopedStoreForComponent("ModelPage",e)}const ge=({modelName:e})=>((0,b.qd)("modelName",e),null);function me(e,t){return e?`${e} ${t?"ASC":"DESC"}`:""}class he extends o.Component{constructor(e){super(e),this.modelPageStoreKey="ModelPageStore",this.defaultPersistedPageTokens={1:null},this.initSearchModelVersionsApiRequestId=(0,ne.yk)(),this.initgetRegisteredModelApiRequestId=(0,ne.yk)(),this.updateRegisteredModelApiId=(0,ne.yk)(),this.deleteRegisteredModelApiId=(0,ne.yk)(),this.criticalInitialRequestIds=[this.initSearchModelVersionsApiRequestId,this.initgetRegisteredModelApiRequestId],this.isEmptyPageResponse=e=>!e||!e.model_versions||!e.next_page_token,this.handleEditDescription=e=>{const{model:t}=this.props;return this.props.updateRegisteredModelApi(t.name,e,this.updateRegisteredModelApiId).then(()=>this.loadPage(1,!1,!0))},this.handleDelete=()=>{const{model:e}=this.props;return this.props.deleteRegisteredModelApi(e.name,this.deleteRegisteredModelApiId).then(()=>{this.props.navigate(v.fM.modelListPageRoute)})},this.loadPage=(e,t,s=!1)=>{const{modelName:o}=this.props,{pageTokens:a}=this.state;this.setState({loading:!0,error:void 0});const i={name:o},n=[this.props.searchModelVersionsApi(i,t?this.initSearchModelVersionsApiRequestId:null,this.state.maxResultsSelection,me(this.orderByKey,this.orderByAsc),a[e]).then(t=>{this.updatePageState(e,t)})];return s&&n.push(this.props.getRegisteredModelApi(o,!0===t?this.initgetRegisteredModelApiRequestId:null)),Promise.all(n).then(()=>{this.setState({loading:!1})}).catch(e=>{this.setState({loading:!1,error:e}),this.resetHistoryState()})},this.updatePageState=(e,t={})=>{const s=this.getNextPageTokenFromResponse(t);this.setState(t=>({pageTokens:{...t.pageTokens,[e+1]:s}}),()=>{this.setPersistedPageTokens(this.state.pageTokens)})},this.handleMaxResultsChange=e=>{this.setState({maxResultsSelection:parseInt(e,10)},()=>{this.resetHistoryState();const{maxResultsSelection:e}=this.state;this.setMaxResultsInStore(e),this.loadPage(1,!1)})},this.handleClickNext=()=>{const e=this.currentPage+1;this.updateUrlWithState(this.orderByKey,this.orderByAsc,e).then(()=>{this.loadPage(e,!1)})},this.handleClickPrev=()=>{const e=this.currentPage-1;this.updateUrlWithState(this.orderByKey,this.orderByAsc,e).then(()=>{this.loadPage(e,!1)})},this.handleClickSortableColumn=(e,t)=>{const s=!t;this.resetHistoryState(),this.updateUrlWithState(e,s,1).then(()=>{this.loadPage(1,!1)})},this.getMaxResultsSelection=()=>this.state.maxResultsSelection;const t=this.getPersistedPageTokens(),s=this.getPersistedMaxResults();this.state={maxResultsSelection:s,pageTokens:t,loading:!0,error:void 0}}componentDidMount(){this.loadModelVersions(!0)}updateUrlWithState(e,t,s){return new Promise(o=>{const a=new URLSearchParams(this.props.searchParams);e&&a.set("orderByKey",e),void 0!==t&&a.set("orderByAsc",String(t)),s&&a.set("page",String(s)),this.props.setSearchParams(a),o()})}resetHistoryState(){this.setState(e=>({pageTokens:this.defaultPersistedPageTokens})),this.setPersistedPageTokens(this.defaultPersistedPageTokens)}loadModelVersions(e=!0){this.loadPage(this.currentPage,e,!0)}get currentPage(){const e=parseInt(this.props.searchParams.get("page")||"1",10);return isNaN(e)?1:e}get orderByKey(){var e;return null!==(e=this.props.searchParams.get("orderByKey"))&&void 0!==e?e:p.$c}get orderByAsc(){return"true"===this.props.searchParams.get("orderByAsc")}getPersistedPageTokens(){const e=ce(this.modelPageStoreKey);return e&&e.getItem("page_tokens")?JSON.parse(e.getItem("page_tokens")):this.defaultPersistedPageTokens}setPersistedPageTokens(e){const t=ce(this.modelPageStoreKey);t&&t.setItem("page_tokens",JSON.stringify(e))}getPersistedMaxResults(){const e=ce(this.modelPageStoreKey);return e&&e.getItem("max_results")?parseInt(e.getItem("max_results"),10):p.Wb}setMaxResultsInStore(e){ce(this.modelPageStoreKey).setItem("max_results",e.toString())}getNextPageTokenFromResponse(e){const{value:t}=e;return this.isEmptyPageResponse(t)?null:t.next_page_token}render(){const{model:e,modelVersions:t,navigate:s,modelName:o}=this.props,{pageTokens:a}=this.state;return(0,_.FD)(se.L,{children:[(0,_.Y)(ge,{modelName:o}),(0,_.Y)(oe.Ay,{requestIds:this.criticalInitialRequestIds,children:(i,n,r)=>{if(n){if(S.A.shouldRender404(r,[this.initgetRegisteredModelApiRequestId]))return(0,_.Y)(ie.E,{statusCode:404,subMessage:this.props.intl.formatMessage({id:"tD0/e2",defaultMessage:"Model {modelName} does not exist"},{modelName:o}),fallbackHomePageReactRoute:v.fM.modelListPageRoute});const e=r.filter(e=>{var t;return this.criticalInitialRequestIds.includes(e.id)&&(null===(t=e.error)||void 0===t?void 0:t.getErrorCode())===u.tG.PERMISSION_DENIED});var l;if(e&&e[0])return(0,_.Y)(ie.E,{statusCode:403,subMessage:this.props.intl.formatMessage({id:"rJitqj",defaultMessage:'Permission denied for {modelName}. Error: "{errorMsg}"'},{modelName:o,errorMsg:null===(l=e[0].error)||void 0===l?void 0:l.getMessageField()}),fallbackHomePageReactRoute:v.fM.modelListPageRoute});(0,oe.dD)(r)}else{if(i)return(0,_.Y)(ae.y,{});if(e)return(0,_.Y)(ee,{model:e,modelVersions:t,handleEditDescription:this.handleEditDescription,handleDelete:this.handleDelete,navigate:s,onMetadataUpdated:this.loadModelVersions,orderByKey:this.orderByKey,orderByAsc:this.orderByAsc,currentPage:this.currentPage,nextPageToken:a[this.currentPage+1],onClickNext:this.handleClickNext,onClickPrev:this.handleClickPrev,onClickSortableColumn:this.handleClickSortableColumn,onSetMaxResult:this.handleMaxResultsChange,maxResultValue:this.getMaxResultsSelection(),loading:this.state.loading})}return null}})]})}}const ue={searchModelVersionsApi:i.hY,getRegisteredModelApi:i.SY,updateRegisteredModelApi:i.tL,deleteRegisteredModelApi:i.r9},pe=(0,re.h)((0,a.Ng)((e,t)=>{const s=decodeURIComponent(t.params.modelName);return{modelName:s,model:e.entities.modelByName[s],modelVersions:(0,N.Tr)(e,s)}},ue)((0,V.Ay)(he))),fe=(0,le.X)(de.A.mlflowServices.MODEL_REGISTRY,pe);var ve=fe},52471:function(e,t,s){s.d(t,{Y:function(){return d}});var o=s(68248),a=s(82716),i=s(27757),n=s(93083),r=s(40724),l=s(73408);const d=({aliases:e=[],onAddEdit:t,className:s})=>{const{theme:d}=(0,i.u)();return(0,l.Y)("div",{css:(0,o.AH)({maxWidth:300,display:"flex",flexWrap:"wrap",alignItems:"flex-start","> *":{marginRight:"0 !important"},rowGap:d.spacing.xs/2,columnGap:d.spacing.xs},""),className:s,children:e.length<1?(0,l.Y)(i.B,{componentId:"codegen_mlflow_app_src_model-registry_components_aliases_modelversiontablealiasescell.tsx_30",size:"small",type:"link",onClick:t,children:(0,l.Y)(r.A,{id:"pU6cxH",defaultMessage:"Add"})}):(0,l.FD)(l.FK,{children:[e.map(e=>(0,l.Y)(n.Z,{value:e,css:(0,o.AH)({marginTop:d.spacing.xs/2},"")},e)),(0,l.Y)(i.B,{componentId:"codegen_mlflow_app_src_model-registry_components_aliases_modelversiontablealiasescell.tsx_41",size:"small",icon:(0,l.Y)(a.PencilIcon,{}),onClick:t})]})})}},58355:function(e,t,s){s.d(t,{A:function(){return o}});class o{static getStoreForComponent(e,t){return new a([e,t].join("-"),"localStorage")}static getSessionScopedStoreForComponent(e,t){return new a([e,t].join("-"),"sessionStorage")}}o.version="1.1";class a{constructor(e,t){this.scope=void 0,this.storageObj=void 0,this.scope=e,this.storageObj="localStorage"===t?window.localStorage:window.sessionStorage}loadComponentState(){const e=this.getItem(a.reactComponentStateKey);return e?JSON.parse(e):{}}saveComponentState(e){const t="function"===typeof e.toJSON?e.toJSON():e;this.setItem(a.reactComponentStateKey,JSON.stringify(t))}withScopePrefix(e){return["MLflowLocalStorage",o.version,this.scope,e].join("-")}setItem(e,t){this.storageObj.setItem(this.withScopePrefix(e),t)}getItem(e){return this.storageObj.getItem(this.withScopePrefix(e))}}a.reactComponentStateKey="ReactComponentState"},63908:function(e,t,s){s.d(t,{Qr:function(){return l},U1:function(){return p},Xb:function(){return m},Y7:function(){return i},bO:function(){return v},fx:function(){return n},ib:function(){return f},yv:function(){return d},z7:function(){return u}});var o=s(76118);const a=()=>s.e(9547).then(s.t.bind(s,29547,23)),i=(e,t)=>{const s=(0,o.truncate)(e,{length:t});return(0,o.takeWhile)(s,e=>"\n"!==e).join("")},n=(e,t)=>{if(e.length>t){const s=Math.floor((t-3)/2),o=t-3-s;return e.substring(0,s)+"..."+e.substring(e.length-o,e.length)}return e},r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=e=>{let t="",s=0;const o=c(e);for(;s<o.length;){const e=o.charCodeAt(s++),a=o.charCodeAt(s++),i=o.charCodeAt(s++),n=e>>2,l=(3&e)<<4|a>>4;let d=(15&a)<<2|i>>6,c=63&i;isNaN(a)?(c=64,d=c):isNaN(i)&&(c=64),t=t+r.charAt(n)+r.charAt(l)+r.charAt(d)+r.charAt(c)}return t},d=e=>{let t="",s=0;const o=(null===e||void 0===e?void 0:e.replace(/[^A-Za-z0-9+/=]/g,""))||"";for(;s<o.length;){const e=r.indexOf(o.charAt(s++)),a=r.indexOf(o.charAt(s++)),i=r.indexOf(o.charAt(s++)),n=r.indexOf(o.charAt(s++)),l=e<<2|a>>4,d=(15&a)<<4|i>>2,c=(3&i)<<6|n;t+=String.fromCharCode(l),64!==i&&(t+=String.fromCharCode(d)),64!==n&&(t+=String.fromCharCode(c))}return g(t)},c=(e="")=>{const t=e.replace(/\r\n/g,"\n");let s="";for(let o=0;o<t.length;o++){const e=t.charCodeAt(o);s+=e<128?String.fromCharCode(e):e>127&&e<2048?String.fromCharCode(e>>6|192)+String.fromCharCode(63&e|128):String.fromCharCode(e>>12|224)+String.fromCharCode(e>>6&63|128)+String.fromCharCode(63&e|128)}return s},g=(e="")=>{let t="",s=0;for(;s<e.length;){const o=e.charCodeAt(s);if(o<128)t+=String.fromCharCode(o),s++;else if(o>191&&o<224){const a=e.charCodeAt(s+1);t+=String.fromCharCode((31&o)<<6|63&a),s+=2}else{const a=e.charCodeAt(s+1),i=e.charCodeAt(s+2);t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&i),s+=3}}return t},m=e=>crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e)).then(e=>Array.prototype.map.call(new Uint8Array(e),e=>("00"+e.toString(16)).slice(-2)).join("")),h="deflate;",u=async e=>{const t=(await a()).deflate(e);if("undefined"!==typeof Buffer){const e=Buffer.from(t).toString("base64");return`${h}${e}`}const s=Array.from(t,e=>String.fromCodePoint(e)).join("");return`${h}${btoa(s)}`},p=async e=>{const t=await a();if(!e.startsWith(h))throw new Error("Invalid compressed text, payload header invalid");const s=e.slice(8);if("undefined"!==typeof Buffer){const e=Buffer.from(s,"base64");return t.inflate(e,{to:"string"})}const o=atob(s);return t.inflate(Uint8Array.from(o,e=>{var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:0}),{to:"string"})},f=e=>e.startsWith(h),v=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},76256:function(e,t,s){s.d(t,{L:function(){return a},S:function(){return i}});var o=s(43617);function a(e,t){return(0,o.N4)(t)}const i=o.N4}}]);